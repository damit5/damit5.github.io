"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[7884],{8379:(n,e,i)=>{i.d(e,{A:()=>a});const a=i.p+"assets/images/image-20230316133930166-aef48ca088030472d85828970bd82675.png"},12397:(n,e,i)=>{i.d(e,{A:()=>a});const a=i.p+"assets/images/image-20230316111654152-0946822c5dc9dca5feae9f29f36b4058.png"},28453:(n,e,i)=>{i.d(e,{R:()=>c,x:()=>l});var a=i(96540);const o={},t=a.createContext(o);function c(n){const e=a.useContext(t);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:c(n.components),a.createElement(t.Provider,{value:e},n.children)}},60512:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>c,metadata:()=>a,toc:()=>r});const a=JSON.parse('{"id":"\u79fb\u52a8\u5b89\u5168/frida-hook/objection/README","title":"objection","description":"\u4ecb\u7ecd","source":"@site/docs/04.\u79fb\u52a8\u5b89\u5168/03.frida-hook/03.objection/README.md","sourceDirName":"04.\u79fb\u52a8\u5b89\u5168/03.frida-hook/03.objection","slug":"/\u79fb\u52a8\u5b89\u5168/frida-hook/objection/","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/objection/","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"d4m1ts","lastUpdatedAt":1748742749000,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"hook\u51fd\u6570\u3010\u8fdb\u9636\u3011","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/hook\u51fd\u6570/hook\u51fd\u6570\u3010\u8fdb\u9636\u3011"},"next":{"title":"Brida","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/brida/"}}');var o=i(74848),t=i(28453);const c={},l="objection",s={},r=[{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:2},{value:"\u5b89\u88c5\u8bf4\u660e",id:"\u5b89\u88c5\u8bf4\u660e",level:2},{value:"\u542f\u52a8objection",id:"\u542f\u52a8objection",level:2},{value:"\u542f\u52a8activity/service",id:"\u542f\u52a8activityservice",level:2},{value:"\u5185\u5b58\u64cd\u4f5c",id:"\u5185\u5b58\u64cd\u4f5c",level:2},{value:"\u5185\u5b58\u641c\u7d22",id:"\u5185\u5b58\u641c\u7d22",level:3},{value:"\u5185\u5b58\u67e5\u770b",id:"\u5185\u5b58\u67e5\u770b",level:3},{value:"\u641c\u7d22\u7c7b",id:"\u641c\u7d22\u7c7b",level:3},{value:"\u641c\u7d22\u65b9\u6cd5",id:"\u641c\u7d22\u65b9\u6cd5",level:3},{value:"\u4e3b\u52a8\u6267\u884c\u65b9\u6cd5",id:"\u4e3b\u52a8\u6267\u884c\u65b9\u6cd5",level:3},{value:"\u751f\u6210hook\u4ee3\u7801",id:"\u751f\u6210hook\u4ee3\u7801",level:3},{value:"\u76d1\u542c\u7c7b\u548c\u65b9\u6cd5",id:"\u76d1\u542c\u7c7b\u548c\u65b9\u6cd5",level:3},{value:"\u5176\u4ed6\u6280\u5de7",id:"\u5176\u4ed6\u6280\u5de7",level:2},{value:"\u5176\u4ed6\u547d\u4ee4",id:"\u5176\u4ed6\u547d\u4ee4",level:3},{value:"\u7ed3\u5408frida",id:"\u7ed3\u5408frida",level:3}];function d(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"objection",children:"objection"})}),"\n",(0,o.jsx)(e.h2,{id:"\u4ecb\u7ecd",children:"\u4ecb\u7ecd"}),"\n",(0,o.jsx)(e.p,{children:"Frida\u662f\u4e00\u6b3e\u529f\u80fd\u5f3a\u5927\u7684\u52a8\u6001\u5206\u6790\u5de5\u5177\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b83\u7684API\u6765\u7f16\u5199\u5404\u79cd\u81ea\u5b9a\u4e49\u7684\u811a\u672c\u548c\u63d2\u4ef6\u3002\u800cObjection\u662f\u57fa\u4e8eFrida API\u5f00\u53d1\u7684\u4e00\u4e2a\u5de5\u5177\uff0c\u5b83\u5c06\u5e38\u89c1\u7684Frida\u811a\u672c\u548c\u63d2\u4ef6\u6574\u5408\u5230\u4e00\u8d77\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e00\u4e2a\u547d\u4ee4\u884c\u63a5\u53e3\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u65b9\u4fbf\u5730\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u800c\u65e0\u9700\u7f16\u5199\u590d\u6742\u7684\u811a\u672c\u3002"}),"\n",(0,o.jsx)(e.p,{children:"Objection\u7684\u76ee\u6807\u662f\u4f7f\u79fb\u52a8\u5e94\u7528\u7a0b\u5e8f\u7684\u5b89\u5168\u8bc4\u4f30\u66f4\u52a0\u7b80\u5355\u548c\u9ad8\u6548\u3002\u5b83\u63d0\u4f9b\u4e86\u8bb8\u591a\u5e38\u89c1\u7684\u529f\u80fd\uff0c\u5982\u53cd\u8c03\u8bd5\u3001\u7981\u7528\u8bc1\u4e66\u7ed1\u5b9a\u3001\u7ed5\u8fc7\u5b89\u5168\u68c0\u67e5\u3001\u4fee\u6539\u5e94\u7528\u7a0b\u5e8f\u7684\u884c\u4e3a\u7b49\u7b49\u3002\u8fd9\u4e9b\u529f\u80fd\u90fd\u662f\u901a\u8fc7\u8c03\u7528Frida\u7684API\u6765\u5b9e\u73b0\u7684\uff0c\u4f46\u662fObjection\u5c06\u5b83\u4eec\u5c01\u88c5\u6210\u6613\u4e8e\u4f7f\u7528\u7684\u547d\u4ee4\u884c\u63a5\u53e3\uff0c\u4ece\u800c\u964d\u4f4e\u4e86\u4f7f\u7528\u95e8\u69db\uff0c\u5e76\u63d0\u9ad8\u4e86\u6548\u7387\u3002"}),"\n",(0,o.jsxs)(e.p,{children:["GitHub: ",(0,o.jsx)(e.a,{href:"https://github.com/sensepost/objection",children:"https://github.com/sensepost/objection"})]}),"\n",(0,o.jsx)(e.h2,{id:"\u5b89\u88c5\u8bf4\u660e",children:"\u5b89\u88c5\u8bf4\u660e"}),"\n",(0,o.jsx)(e.p,{children:"\u5b89\u88c5"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"pip3 install objection\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u53c2\u6570\u8bf4\u660e"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:" \ue77d \ue0b0 objection\nUsage: objection [OPTIONS] COMMAND [ARGS]...\n\n\u9009\u9879\uff1a\n  -N\uff0c--network \u4f7f\u7528\u7f51\u7edc\u8fde\u63a5\u800c\u4e0d\u662fUSB\u8fdb\u884c\u8fde\u63a5\u3002[\u9ed8\u8ba4\u503c\uff1aFalse]\n  -h\uff0c--host TEXT \u4f7f\u7528\u7684\u4e3b\u673a\u5730\u5740\u3002[\u9ed8\u8ba4\u503c\uff1a127.0.0.1]\n  -p\uff0c--port INTEGER \u8fde\u63a5\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\u3002[\u9ed8\u8ba4\u503c\uff1a27042]\n  -ah\uff0c--api-host TEXT API\u670d\u52a1\u5668\u7ed1\u5b9a\u7684\u4e3b\u673a\u5730\u5740\u3002[\u9ed8\u8ba4\u503c\uff1a127.0.0.1]\n  -ap\uff0c--api-port INTEGER API\u670d\u52a1\u5668\u7ed1\u5b9a\u7684\u7aef\u53e3\u53f7\u3002[\u9ed8\u8ba4\u503c\uff1a8888]\n  -g\uff0c--gadget TEXT \u8981\u8fde\u63a5\u7684Frida Gadget/\u8fdb\u7a0b\u7684\u540d\u79f0\u3002[\u9ed8\u8ba4\u503c\uff1aGadget]\n  -S\uff0c--serial TEXT \u8981\u8fde\u63a5\u7684\u8bbe\u5907\u5e8f\u5217\u53f7\u3002\n  -d\uff0c--debug \u542f\u7528\u8c03\u8bd5\u6a21\u5f0f\u5e76\u8f93\u51fa\u8be6\u7ec6\u4fe1\u606f\u3002(\u5305\u62ec\u5806\u6808\u8ddf\u8e2a\u4e2d\u7684\u4ee3\u7406\u6e90\u6620\u5c04)\n  --help \u663e\u793a\u6b64\u5e2e\u52a9\u6d88\u606f\u5e76\u9000\u51fa\u3002\n\n\u547d\u4ee4\uff1a\n  api \u5728\u65e0\u5934\u6a21\u5f0f\u4e0b\u542f\u52a8Objection API\u670d\u52a1\u5668\u3002\n  device-type \u83b7\u53d6\u9644\u52a0\u8bbe\u5907\u7684\u4fe1\u606f\u3002\n  explore \u542f\u52a8Objection exploration REPL\u3002\n  patchapk \u4f7f\u7528frida-gadget.so\u4fee\u8865APK\u3002\n  patchipa \u4f7f\u7528FridaGadget dylib\u4fee\u8865IPA\u3002\n  run \u8fd0\u884c\u5355\u4e2aObjection\u547d\u4ee4\u3002\n  signapk \u4f7f\u7528Objection\u5bc6\u94a5\u5bf9APK\u8fdb\u884czipalign\u548c\u7b7e\u540d\u3002\n  version \u6253\u5370\u5f53\u524d\u7248\u672c\u5e76\u9000\u51fa\u3002\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u542f\u52a8objection",children:"\u542f\u52a8objection"}),"\n",(0,o.jsxs)(e.p,{children:["\u4ee5",(0,o.jsx)(e.code,{children:"sieve"}),"\u4e3a\u76ee\u6807\uff0c\u6ce8\u5165\u76ee\u6807\u4e2d"]}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\u9ed8\u8ba4\u662f\u8fde\u63a5USB\uff0c\u5982\u679c\u6709\u591a\u4e2aUSB\uff0c\u5c31\u9700\u8981\u7528-S\u6307\u5b9a"}),"\n",(0,o.jsx)(e.p,{children:"Objection \u5728\u542f\u52a8\u65f6\u4f1a\u81ea\u52a8\u6ce8\u5165Frida Agent\u5230\u76ee\u6807\u5e94\u7528\u7a0b\u5e8f\u4e2d"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"objection -S emulator-5554 -g com.mwr.example.sieve explore\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u542f\u52a8\u540e\uff0c\u4e0d\u77e5\u9053\u8f93\u5165\u4ec0\u4e48\u547d\u4ee4\uff0c\u53ef\u4ee5\u6309",(0,o.jsx)(e.strong,{children:"tab"}),"\uff0c\u4ed6\u4f1a\u5e2e\u4f60\u63d0\u793a\uff0c\u652f\u6301tab\u952e\u81ea\u52a8\u8865\u9f50\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7",(0,o.jsx)(e.code,{children:"help \u547d\u4ee4"}),"\u6765\u67e5\u770b\u5bf9\u5e94\u547d\u4ee4\u7684\u8bf4\u660e\uff0c\u5982",(0,o.jsx)(e.code,{children:"help android"}),"\u3002"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"image-20230316111654152",src:i(12397).A+"",width:"2094",height:"970"})}),"\n",(0,o.jsx)(e.h2,{id:"\u542f\u52a8activityservice",children:"\u542f\u52a8activity/service"}),"\n",(0,o.jsx)(e.p,{children:"\u83b7\u53d6activity\u5217\u8868"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android hooking list activities\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u542f\u52a8activity"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android intent launch_activity com.mwr.example.sieve.PWList\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u83b7\u53d6service\u5217\u8868"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android hooking list services\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u542f\u52a8service"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android intent launch_service com.mwr.example.sieve.CryptoService\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u5185\u5b58\u64cd\u4f5c",children:"\u5185\u5b58\u64cd\u4f5c"}),"\n",(0,o.jsx)(e.h3,{id:"\u5185\u5b58\u641c\u7d22",children:"\u5185\u5b58\u641c\u7d22"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:'memory search "abcde" --string\n'})}),"\n",(0,o.jsx)(e.h3,{id:"\u5185\u5b58\u67e5\u770b",children:"\u5185\u5b58\u67e5\u770b"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"# memory dump <base address> <size to dump> <local destination>\nmemory dump from_base 0xf7778765 200 main\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u641c\u7d22\u7c7b",children:"\u641c\u7d22\u7c7b"}),"\n",(0,o.jsx)(e.p,{children:"\u5217\u51fa\u6240\u6709\u52a0\u8f7d\u7684\u7c7b"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android hooking list classes\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u641c\u7d22\u7c7b"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"# android hooking search classes \u5173\u952e\u8bcd\nandroid hooking search classes sieve\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u641c\u7d22\u65b9\u6cd5",children:"\u641c\u7d22\u65b9\u6cd5"}),"\n",(0,o.jsx)(e.p,{children:"\u5217\u51fa\u6307\u5b9a\u7c7b\u7684\u65b9\u6cd5"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"# android hooking list class_methods \u7c7b\u540d\nandroid hooking list class_methods com.mwr.example.sieve.MainLoginActivity\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u641c\u7d22\u65b9\u6cd5"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"# android hooking search methods \u5173\u952e\u8bcd\nandroid hooking search methods com.mwr.example.sieve.MainLoginActivity\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u4e3b\u52a8\u6267\u884c\u65b9\u6cd5",children:"\u4e3b\u52a8\u6267\u884c\u65b9\u6cd5"}),"\n",(0,o.jsxs)(e.p,{children:["\u5148\u5c1d\u8bd5\u627e\u5230\u8be5\u7c7b\u7684\u5b9e\u4f8b\uff08\u548c",(0,o.jsx)(e.code,{children:"Java.choose"}),"\u7c7b\u4f3c\uff09"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android heap search instances com.mwr.example.sieve.MainLoginActivity\n\n# res\nClass instance enumeration complete for com.mwr.example.sieve.MainLoginActivity\n Hashcode  Class                                    toString()\n---------  ---------------------------------------  -----------------------------------------------\n135299310  com.mwr.example.sieve.MainLoginActivity  com.mwr.example.sieve.MainLoginActivity@81080ee\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u5c1d\u8bd5\u8c03\u7528\u8fd9\u4e2a\u5b9e\u4f8b\u7684",(0,o.jsx)(e.code,{children:"com.mwr.example.sieve.MainLoginActivity.loginSuccessful()"}),"\u65b9\u6cd5"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android heap execute 135299310 loginSuccessful\n\n# res\nHandle 135299310 is to class\n        com.mwr.example.sieve.MainLoginActivity\nExecuting method: loginSuccessful()\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u4e5f\u53ef\u4ee5\u76f4\u63a5hook\u8fd9\u4e2a\u5b9e\u4f8b\uff0c\u53bb\u7f16\u5199js\u811a\u672c\uff1b\u9ed8\u8ba4\u5b9e\u4f8b\u662f",(0,o.jsx)(e.code,{children:"clazz"})]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android heap evaluate 135299310\n\n# res\n(The hashcode at `135299310` will be available as the `clazz` variable.)\nconsole.log(clazz);\nconsole.log(clazz.loginSuccessful());\nJavaScript capture complete. Evaluating...\nHandle 135299310 is to class\n        com.mwr.example.sieve.MainLoginActivity\ncom.mwr.example.sieve.MainLoginActivity@81080ee\nundefined\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u751f\u6210hook\u4ee3\u7801",children:"\u751f\u6210hook\u4ee3\u7801"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"# android hooking generate simple \u7c7b\u540d\nandroid hooking generate simple com.mwr.example.sieve.MainLoginActivity\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u751f\u6210\u7684\u6846\u67b6\u4ee3\u7801\u5982\u4e0b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6839\u636e\u8981hook\u7684\u903b\u8f91\u8fdb\u884c\u4fee\u6539\u5373\u53ef\uff0c\u5176\u4e2d",(0,o.jsx)(e.code,{children:"arguments"}),"\u5c31\u662f\u4f20\u5165\u7684\u53c2\u6570\u3002"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"Java.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.sendFailed.implementation = function() {\n\n        //\n\n        return clazz.sendFailed.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.loginSuccessful.implementation = function() {\n\n        //\n\n        return clazz.loginSuccessful.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.onCreateOptionsMenu.implementation = function() {\n\n        //\n\n        return clazz.onCreateOptionsMenu.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.loginFailed.implementation = function() {\n\n        //\n\n        return clazz.loginFailed.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.onOptionsItemSelected.implementation = function() {\n\n        //\n\n        return clazz.onOptionsItemSelected.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.checkKeyResult.implementation = function() {\n\n        //\n\n        return clazz.checkKeyResult.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.login.implementation = function() {\n\n        //\n\n        return clazz.login.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.connected.implementation = function() {\n\n        //\n\n        return clazz.connected.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.firstLaunchResult.implementation = function() {\n\n        //\n\n        return clazz.firstLaunchResult.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.welcomeUser.implementation = function() {\n\n        //\n\n        return clazz.welcomeUser.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.setPinResult.implementation = function() {\n\n        //\n\n        return clazz.setPinResult.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.unbind.implementation = function() {\n\n        //\n\n        return clazz.unbind.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.openSettings.implementation = function() {\n\n        //\n\n        return clazz.openSettings.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.initaliseActivity.implementation = function() {\n\n        //\n\n        return clazz.initaliseActivity.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.setPin.implementation = function() {\n\n        //\n\n        return clazz.setPin.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.onResume.implementation = function() {\n\n        //\n\n        return clazz.onResume.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.onBackPressed.implementation = function() {\n\n        //\n\n        return clazz.onBackPressed.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.onStart.implementation = function() {\n\n        //\n\n        return clazz.onStart.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.onActivityResult.implementation = function() {\n\n        //\n\n        return clazz.onActivityResult.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.onCreate.implementation = function() {\n\n        //\n\n        return clazz.onCreate.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.onPause.implementation = function() {\n\n        //\n\n        return clazz.onPause.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.setKeyResult.implementation = function() {\n\n        //\n\n        return clazz.setKeyResult.apply(this, arguments);\n    }\n});\n\n\nJava.perform(function() {\n    var clazz = Java.use('com.mwr.example.sieve.MainLoginActivity');\n    clazz.checkPinResult.implementation = function() {\n\n        //\n\n        return clazz.checkPinResult.apply(this, arguments);\n    }\n});\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u76d1\u542c\u7c7b\u548c\u65b9\u6cd5",children:"\u76d1\u542c\u7c7b\u548c\u65b9\u6cd5"}),"\n",(0,o.jsx)(e.p,{children:"hook\u7c7b\u4e2d\u6240\u6709\u7684\u65b9\u6cd5"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"# android hooking watch class \u7c7b\u540d\nandroid hooking watch class com.mwr.example.sieve.MainLoginActivity\n\n# res\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.checkKeyResult(boolean)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.checkPinResult(boolean)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.connected()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.firstLaunchResult(int)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.login(android.view.View)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.onActivityResult(int, int, android.content.Intent)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.onBackPressed()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.onCreate(android.os.Bundle)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.onCreateOptionsMenu(android.view.Menu)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.onOptionsItemSelected(android.view.MenuItem)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.onPause()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.onResume()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.onStart()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.sendFailed()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.setKeyResult(boolean)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.setPinResult(boolean)\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.initaliseActivity()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.loginFailed()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.loginSuccessful()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.openSettings()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.setPin()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.unbind()\n(agent) Hooking com.mwr.example.sieve.MainLoginActivity.welcomeUser()\n(agent) Registering job 963225. Type: watch-class for: com.mwr.example.sieve.MainLoginActivity\n"})}),"\n",(0,o.jsxs)(e.p,{children:["hook\u540e\uff0c\u8f93\u5165",(0,o.jsx)(e.code,{children:"jobs list"}),"\u53ef\u4ee5\u67e5\u770b\u8be5\u7c7b\u4e0b\u7684\u65b9\u6cd5\u90fd\u88abhook"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"job list\n\n# res\n\nJob ID  Hooks  Type\n------  -----  --------------------------------------------------------\n963225     23  watch-class for: com.mwr.example.sieve.MainLoginActivity\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u6b63\u5e38\u64cd\u4f5capp\uff0c\u5f53hook\u7684\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u8fd9\u4e9b\u65b9\u6cd5\u8f93\u51fa\u3002"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"image-20230316133930166",src:i(8379).A+"",width:"2876",height:"296"})}),"\n",(0,o.jsx)(e.p,{children:"hook\u5bf9\u5e94\u65b9\u6cd5\u7684\u53c2\u6570\u3001\u8fd4\u56de\u503c\u548c\u8c03\u7528\u6808"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"# android hooking watch class_method <\u65b9\u6cd5\u540d> --dump-args --dump-return  --dump-backtrace\nandroid hooking watch class_method com.mwr.example.sieve.MainLoginActivity.login --dump-args --dump-return  --dump-backtrace\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u5f53\u8fd9\u4e2a\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c\u4f1a\u8f93\u51fa\u76f8\u5173\u7684\u4fe1\u606f"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"com.mwr.example.sieve on (Xiaomi: 6.0.1) [usb] # (agent) [880894] Called com.mwr.example.sieve.MainLoginActivity.login(android.view.View)\n(agent) [880894] Backtrace:\n\tcom.mwr.example.sieve.MainLoginActivity.login(Native Method)\n        java.lang.reflect.Method.invoke(Native Method)\n\tandroid.view.View$DeclaredOnClickListener.onClick(View.java:4453)\n\tandroid.view.View.performClick(View.java:5204)\n\tandroid.view.View$PerformClick.run(View.java:21153)\n\tandroid.os.Handler.handleCallback(Handler.java:739)\n\tandroid.os.Handler.dispatchMessage(Handler.java:95)\n\tandroid.os.Looper.loop(Looper.java:148)\n\tandroid.app.ActivityThread.main(ActivityThread.java:5647)\n\tjava.lang.reflect.Method.invoke(Native Method)\n\tcom.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:745)\n\tcom.android.internal.os.ZygoteInit.main(ZygoteInit.java:635)\n\n(agent) [880894] Arguments com.mwr.example.sieve.MainLoginActivity.login(android.widget.Button{8efa50c VFED..C.. ...P.... 0,879-1872,1004 #7f080010 app:id/mainlogin_button_login})\n(agent) [880894] Return Value: (none)\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u5176\u4ed6\u6280\u5de7",children:"\u5176\u4ed6\u6280\u5de7"}),"\n",(0,o.jsx)(e.h3,{id:"\u5176\u4ed6\u547d\u4ee4",children:"\u5176\u4ed6\u547d\u4ee4"}),"\n",(0,o.jsx)(e.p,{children:"\u67e5\u770b\u547d\u4ee4\u7684\u5e2e\u52a9"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"objection explore --hel\n\n# \u5982\u540c\u6b65\u6267\u884c\u547d\u4ee4\nobjection -g com.xxx.xxx -S emulator-5554 explore --startup-command 'android hooking search classes sieve'\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u663e\u793a\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u73af\u5883\u7684\u76ee\u5f55\u4fe1\u606f\u3002"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"env\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u5bfc\u5165js\u811a\u672c\uff08\u9700\u8981**",(0,o.jsx)(e.a,{href:"#%E7%BB%93%E5%90%88frida",children:"\u7ed3\u5408frida"}),"\u4f7f\u7528**\uff0c\u4e0d\u7136\u4f1a\u6709\u627e\u4e0d\u5230pid\u7684\u95ee\u9898\uff0c\u53c2\u8003",(0,o.jsx)(e.a,{href:"https://github.com/sensepost/objection/issues/335",children:"issue"}),"\uff09"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"import <js\u811a\u672c\u8def\u5f84>\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u5173\u95edroot\u68c0\u6d4b"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"android root disable\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u7ed5\u8fc7ssl pinning\u68c0\u6d4b"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android sslpinning disable\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u8bbe\u7f6eproxy\u4ee3\u7406\uff08\u4e0d\u662f\u5f88\u597d\u7528\uff09"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android proxy set 172.20.10.2 8080\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u83b7\u53d6\u5f53\u524d\u7684activity"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android hooking get current_activity\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u622a\u56fe\u5e76\u4fdd\u5b58\u5230\u672c\u5730"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"android ui screenshot ./1.png\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u7ed3\u5408frida",children:"\u7ed3\u5408frida"}),"\n",(0,o.jsxs)(e.p,{children:["\u90e8\u5206\u60c5\u51b5\uff0c\u6bd4\u5982\u5b58\u5728root\u68c0\u6d4b\u8fd9\u79cd\uff0c\u9700\u8981\u5728app\u542f\u52a8\u65f6\u8fdb\u884chook\uff0c\u4f46\u662f\u76f4\u63a5\u7528",(0,o.jsx)(e.code,{children:"objection"}),"\u63d0\u4f9b\u7684",(0,o.jsx)(e.code,{children:"-s"}),"\u6216\u8005",(0,o.jsx)(e.code,{children:"-S"}),"\u53c2\u6570\u53c8\u4e0d\u80fd\u751f\u6548\uff0c\u6216\u8005\u6709\u5404\u79cd\u95ee\u9898\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u7ed3\u5408frida\u6765\u8fdb\u884c\uff0c\u4e5f\u5f88\u65b9\u4fbf\u597d\u7528\u3002"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"# \u7ed5\u8fc7root\u68c0\u6d4b\nfrida -D emulator-5554 -l root_detection_bypass.js -f owasp.mstg.uncrackable1\n\n# \u83b7\u53d6pid\nfrida-ps -D emulator-5554 -a\n\n# objection attach\nobjection -g 4093 -S emulator-5554 explore\n"})})]})}function m(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}}}]);