"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[1611],{7312:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321134653616-44f21b61d5a71e76df88d859ed8c9edc.png"},27765:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321141349741-9f1ab3a0824d74597d64ce5577efde7e.png"},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>r});var d=s(96540);const c={},a=d.createContext(c);function i(e){const n=d.useContext(a);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),d.createElement(a.Provider,{value:n},e.children)}},32494:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321135146322-d6da10d5099846b747e5ce5cfcf76fd5.png"},37150:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321140910017-e5dc59fd793c15377954832b9621ffa2.png"},40417:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321181026097-947e62aa8cd0aff83a18479b2bd7cf09.png"},62804:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321181214950-9004077c278d6c6952becea91b5517ac.png"},73427:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321181621917-e8e42a2f7e404ab6643f1ddd0727f74b.png"},90839:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>l,frontMatter:()=>i,metadata:()=>d,toc:()=>t});const d=JSON.parse('{"id":"\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/\u3010\u5b9e\u4f8b\u4e00\u3011\u52a0\u5bc6+\u7b7e\u540d\u5206\u6790","title":"\u3010\u5b9e\u4f8b\u4e00\u3011\u52a0\u5bc6+\u7b7e\u540d\u5206\u6790","description":"\u524d\u8a00","source":"@site/docs/04.\u79fb\u52a8\u5b89\u5168/03.frida-hook/05.hook \u5b9e\u6218/01.\u3010\u5b9e\u4f8b\u4e00\u3011\u52a0\u5bc6+\u7b7e\u540d\u5206\u6790.md","sourceDirName":"04.\u79fb\u52a8\u5b89\u5168/03.frida-hook/05.hook \u5b9e\u6218","slug":"/\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/\u3010\u5b9e\u4f8b\u4e00\u3011\u52a0\u5bc6+\u7b7e\u540d\u5206\u6790","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/\u3010\u5b9e\u4f8b\u4e00\u3011\u52a0\u5bc6+\u7b7e\u540d\u5206\u6790","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"d4m1ts","lastUpdatedAt":1748742749000,"sidebarPosition":1,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"hook\u5b9e\u6218","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/"},"next":{"title":"\u3010\u5b9e\u4f8b\u4e8c\u3011\u8bc1\u4e66\u53cc\u5411\u9a8c\u8bc1\u6293\u5305","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/\u3010\u5b9e\u4f8b\u4e8c\u3011\u8bc1\u4e66\u53cc\u5411\u9a8c\u8bc1\u6293\u5305"}}');var c=s(74848),a=s(28453);const i={},r=void 0,o={},t=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"\u52a0\u5bc6\u5206\u6790",id:"\u52a0\u5bc6\u5206\u6790",level:2},{value:"\u7b7e\u540d\u5206\u6790",id:"\u7b7e\u540d\u5206\u6790",level:2}];function h(e){const n={code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h2,{id:"\u524d\u8a00",children:"\u524d\u8a00"}),"\n",(0,c.jsx)(n.p,{children:"\u67d0APP\uff0c\u5206\u6790\u540e\u53d1\u73b0\u540c\u65f6\u5b58\u5728\u52a0\u5bc6\u548c\u7b7e\u540d\uff0c\u521a\u597d\u6765\u603b\u7ed3\u4e00\u4e0b\u3002"}),"\n",(0,c.jsx)(n.p,{children:"burp\u6293\u5305\uff0c\u5b58\u5728\u52a0\u5bc6\uff0c\u52a0\u5bc6\u540e\u7684\u5185\u5bb9\u662f\u4e00\u4e32\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"\u52a0\u5bc6",src:s(99352).A+"",width:"2710",height:"882"})}),"\n",(0,c.jsx)(n.h2,{id:"\u52a0\u5bc6\u5206\u6790",children:"\u52a0\u5bc6\u5206\u6790"}),"\n",(0,c.jsxs)(n.p,{children:["\u770b\u683c\u5f0f\u731c\u4e0d\u51fa\u6765\u662f\u5565\uff0c\u53ef\u80fd\u662f\u5bf9\u79f0\u52a0\u5bc6\u540ehex\u5904\u7406\u4e86\u4e00\u4e0b\uff0c\u5148\u5c1d\u8bd5hook\u4e00\u4e0b",(0,c.jsx)(n.code,{children:"javax.crypto.Cipher"}),"\u78b0\u78b0\u8fd0\u6c14"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"android hooking watch class_method javax.crypto.Cipher.getInstance --dump-args\nandroid hooking watch class_method javax.crypto.Cipher.doFinal --dump-args --dump-backtrace --dump-return\nandroid hooking watch class_method javax.crypto.Cipher.update --dump-args --dump-return\n"})}),"\n",(0,c.jsx)(n.p,{children:"hook\u540e\u4f1a\u76f4\u63a5\u51fa\u73b0\u5927\u91cf\u8c03\u7528\u65b9\u6cd5\u7684\u6570\u636e\u5305\uff0c\u4e00\u822c\u662f\u5176\u4ed6\u5305\u53d1\u8d77\u7684\uff0c\u6bd4\u5982\u9ad8\u5fb7API\u5565\u7684\uff0c\u6240\u4ee5\u9700\u8981\u8fdb\u4e00\u6b65\u786e\u8ba4\u76ee\u6807\u5305\u662f\u4e0d\u662f\u4e5f\u91c7\u7528\u7684\u8fd9\u4e9b\u52a0\u5bc6\u7b97\u6cd5\u3002"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"\u9ad8\u5fb7\u5730\u56fe\u52a0\u5bc6",src:s(7312).A+"",width:"3530",height:"1112"})}),"\n",(0,c.jsx)(n.p,{children:"\u627e\u4e00\u4e2a\u5b58\u5728\u52a0\u5bc6\u7684\u529f\u80fd\u70b9\uff0c\u6bd4\u5982\u767b\u5f55\u754c\u9762\uff0c\u7136\u540e\u8fdb\u884c\u767b\u5f55\uff0c\u67e5\u770b\u6709\u6ca1\u6709hook\u5230"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"\u52a0\u5bc6\u7b97\u6cd5",src:s(32494).A+"",width:"3584",height:"1146"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0a\u56fe\u5c31\u662fhook\u5230\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u770b\u5230",(0,c.jsx)(n.strong,{children:"\u5806\u6808"}),"\u660e\u663e\u548c\u4e4b\u524d\u7684\u4e0d\u4e00\u6837\uff0c\u8f93\u5165\u53c2\u6570\u8fdb\u884c\u8f6cstring\u540e\u7ed3\u679c\u5982\u4e0b\uff0c\u53ef\u89c1\u4e3a\u6211\u4eec\u8f93\u5165\u7684\u624b\u673a\u53f7\uff0c\u4e5f\u5c31\u8bc1\u660e\u786e\u5b9e\u91c7\u7528\u4e86\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{"sign":"547e2eff92ff0ba527a4538e552a9467","func":"user/checkMsgCode","data":{"phone":"13333333333","checkcode":"1234","userid":""}}\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u6b64\u65f6\u6211\u4eec\u5df2\u7ecf\u786e\u8ba4\u5e95\u5c42\u52a0\u5bc6\u4f7f\u7528\u4e86",(0,c.jsx)(n.code,{children:"javax.crypto.Cipher.doFinal"}),"\u51fd\u6570\uff0c\u4f46\u662f\u8be5\u51fd\u6570\u8f93\u5165\u8f93\u51fa\u90fd\u662fbyte\u6570\u7ec4\uff0c\u800c\u6570\u636e\u5305\u4e2d\u7684\u5bc6\u6587\u662f\u4e00\u4e32\u5341\u516d\u8fdb\u5236\u7684\u6570\u636e\uff0c",(0,c.jsx)(n.strong,{children:"\u56e0\u6b64\u4e00\u5b9a\u6709\u53e6\u4e00\u4e2a\u5305\u88c5\u7c7b\u51fd\u6570\u6765\u76f4\u63a5\u5c06\u6570\u636e\u5305\u4e2d\u7684\u5341\u516d\u8fdb\u5236\u76f4\u63a5\u8f6c\u6362\u6210\u660e\u6587\uff0c\u6216\u8005\u5c06\u660e\u6587\u76f4\u63a5\u52a0\u5bc6\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32"}),"\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5206\u6790\u521a\u624d\u7684\u5806\u6808\u4fe1\u606f\uff0c\u53ef\u4ee5\u660e\u663e\u770b\u51fa\u6709\u4e00\u4e2a\u65b9\u6cd5 ",(0,c.jsx)(n.code,{children:"com.xxx.lib.util.encrypt.AES128Helper.encrypt"}),"\u53bb\u8c03\u7528\u4e86",(0,c.jsx)(n.code,{children:"javax.crypto.Cipher.doFinal"}),"\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7c7b\u80af\u5b9a\u5c31\u662f\u5305\u88c5\u7c7b\u4e86\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"\u770b\u770b\u8fd9\u4e2a\u7c7b\u7684\u6240\u6709\u65b9\u6cd5\uff08\u4e3b\u8981\u5173\u5fc3\u52a0\u89e3\u5bc6\u65b9\u6cd5\uff09"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"android hooking list class_methods com.xxx.lib.util.encrypt.AES128Helper\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"image-20230321140910017",src:s(37150).A+"",width:"2604",height:"348"})}),"\n",(0,c.jsx)(n.p,{children:"hook\u5bf9\u5e94\u7684\u51fd\u6570\uff0c\u770b\u770b\u52a0\u5bc6\u548c\u89e3\u5bc6\u662f\u5426\u548c\u6570\u636e\u5305\u4e00\u81f4"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"android hooking watch class_method com.xxx.lib.util.encrypt.AES128Helper.encrypt --dump-args --dump-return\nandroid hooking watch class_method com.xxx.lib.util.encrypt.AES128Helper.decrypt --dump-args --dump-return\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u518d\u6b21\u767b\u5f55\u89e6\u53d1\u52a0\u5bc6\uff0c\u53ef\u89c1\u5df2\u7ecf\u627e\u5230\u4e86\u548c\u6570\u636e\u5305\u52a0\u5bc6\u6570\u636e\u4e00\u81f4\u7684\u52a0\u89e3\u5bc6\u7b97\u6cd5\uff0c\u53ef\u76f4\u63a5\u5c06\u660e\u6587\u52a0\u5bc6\u4e3a\u5341\u516d\u8fdb\u5236\u6570\u636e\u4e32\uff0c\u4e5f\u53ef\u4ee5\u5c06\u52a0\u5bc6\u540e\u7684\u5341\u516d\u8fdb\u5236\u6570\u636e\u4e32\u76f4\u63a5\u8f6c\u6362\u4e3a\u660e\u6587\u3002"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"image-20230321141349741",src:s(27765).A+"",width:"3584",height:"444"})}),"\n",(0,c.jsx)(n.p,{children:"\u7136\u540e\u5c31\u662f\u7f16\u5199brida\u811a\u672c\u4e86\uff0c\u4e0d\u518d\u8d58\u8ff0\u4e86\u3002"}),"\n",(0,c.jsx)(n.h2,{id:"\u7b7e\u540d\u5206\u6790",children:"\u7b7e\u540d\u5206\u6790"}),"\n",(0,c.jsx)(n.p,{children:"\u4e0a\u9762\u6211\u4eec\u5df2\u7ecf\u6210\u529f\u83b7\u53d6\u5230\u4e86\u6570\u636e\u7684\u52a0\u89e3\u5bc6\u65b9\u5f0f\uff0c\u4f46\u89e3\u5bc6\u540e\u7684\u6570\u636e\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{"sign":"547e2eff92ff0ba527a4538e552a9467","func":"user/checkMsgCode","data":{"phone":"13333333333","checkcode":"1234","userid":""}}\n'})}),"\n",(0,c.jsx)(n.p,{children:"\u5176\u4e2d\u5b58\u5728sign\u503c\uff0c\u8be5\u503c\u4e00\u822c\u662f\u5b57\u7b26\u4e32\u5185\u5bb9\u7684hash\uff0c\u7528\u4e8e\u9a8c\u8bc1\u8bf7\u6c42\u7684\u5408\u6cd5\u6027\uff0c\u5982\u679c\u6211\u4eec\u4e0d\u77e5\u9053\u8fd9\u4e2asign\u503c\u5982\u4f55\u751f\u6210\u7684\uff0c\u4ecd\u7136\u65e0\u6cd5\u7be1\u6539\u6570\u636e\u5305\u3002"}),"\n",(0,c.jsxs)(n.p,{children:["\u8be5\u503c\u4e3a32\u4f4d\uff0c\u5e38\u89c1\u7684hash\u7b97\u6cd5\u6709",(0,c.jsx)(n.code,{children:"md5"})," \u3001",(0,c.jsx)(n.code,{children:"HMAC"}),"\uff0c\u5148\u5c1d\u8bd5hook\u4e00\u4e0bmd5\u76f8\u5173\u7684\u65b9\u6cd5"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"android hooking watch class_method java.security.MessageDigest.getInstance --dump-args\nandroid hooking watch class_method java.security.MessageDigest.update --dump-args --dump-return --dump-backtrace\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7136\u540e\u8fd8\u662f\u53bb\u767b\u5f55\uff0c\u5206\u6790\u65b0\u4ea7\u751f\u7684\u7684\u65e5\u5fd7\u548c\u5806\u6808\u4fe1\u606f\uff0c\u770b\u6709\u6ca1\u6709\u88ab\u8c03\u7528\u5230"}),"\n",(0,c.jsx)(n.p,{children:"\u53d1\u73b0\u8fd9\u4e2a\u5806\u6808\u548c\u5176\u4ed6\u7684\u90fd\u4e0d\u4e00\u6837\uff0c\u800c\u4e14\u7c7b\u540d\u548c\u76ee\u6807\u6709\u5173\uff0c\u5f88\u53ef\u7591"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"\u5806\u6808",src:s(99328).A+"",width:"1698",height:"394"})}),"\n",(0,c.jsx)(n.p,{children:"\u5206\u6790\u4e00\u4e0b\u4f20\u5165\u7684\u7b7e\u540d\u6570\u636e"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"image-20230321181026097",src:s(40417).A+"",width:"2006",height:"88"})}),"\n",(0,c.jsxs)(n.p,{children:["\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u4e3a",(0,c.jsx)(n.code,{children:"user/login"}),"\uff0c\u8ba1\u7b97md5\u7684\u503c\u4e3a",(0,c.jsx)(n.code,{children:"739a748bd3c748b88deac114d318d445"}),"\uff0c\u786e\u5b9e\u548c\u89e3\u5bc6\u540e\u7684\u5185\u5bb9\u4e00\u81f4\u3002"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"image-20230321181214950",src:s(62804).A+"",width:"3584",height:"440"})}),"\n",(0,c.jsx)(n.p,{children:"\u56e0\u6b64\u53ef\u4ee5\u786e\u8ba4\u6b64\u5904\u7684sign\u5c31\u662f\u8ba1\u7b97\u7684func\u53c2\u6570\u7684md5\u503c\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u8c03\u7528\u4ed6\u7684\u65b9\u6cd5\u53bb\u751f\u6210md5\u503c\u7684hook\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"Java.perform(function() {\n  var clazz = Java.use('com.xxx.lib.util.encrypt.SecurityUtil');\n  var result = clazz.EncoderByMd5(\"user/login\");\n  console.log(result);\n});\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"image-20230321181621917",src:s(73427).A+"",width:"1470",height:"266"})})]})}function l(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(h,{...e})}):h(e)}},99328:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321180941444-ad0feea30bc95ea38f02985a4d910bad.png"},99352:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20230321082248584-80ab62c9249f5e9af22aa6331c687f11.png"}}]);