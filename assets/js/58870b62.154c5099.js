"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[7881],{28453:(e,l,n)=>{n.d(l,{R:()=>i,x:()=>c});var t=n(96540);const r={},s=t.createContext(r);function i(e){const l=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(l):{...l,...e}}),[l,e])}function c(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(s.Provider,{value:l},e.children)}},59178:(e,l,n)=>{n.r(l),n.d(l,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"\u6e17\u900f\u6d4b\u8bd5/\u5185\u7f51\u6e17\u900f/\u65e5\u5fd7\u6e05\u7406/\u65e5\u5fd7\u6e05\u7406","title":"\u65e5\u5fd7\u6e05\u7406","description":"Windows","source":"@site/docs/01.\u6e17\u900f\u6d4b\u8bd5/12.\u5185\u7f51\u6e17\u900f/06.\u65e5\u5fd7\u6e05\u7406/01.\u65e5\u5fd7\u6e05\u7406.md","sourceDirName":"01.\u6e17\u900f\u6d4b\u8bd5/12.\u5185\u7f51\u6e17\u900f/06.\u65e5\u5fd7\u6e05\u7406","slug":"/\u6e17\u900f\u6d4b\u8bd5/\u5185\u7f51\u6e17\u900f/\u65e5\u5fd7\u6e05\u7406/\u65e5\u5fd7\u6e05\u7406","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/\u5185\u7f51\u6e17\u900f/\u65e5\u5fd7\u6e05\u7406/\u65e5\u5fd7\u6e05\u7406","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"d4m1ts","lastUpdatedAt":1748784450000,"sidebarPosition":1,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"\u65e5\u5fd7\u6e05\u7406","permalink":"/docs/category/\u65e5\u5fd7\u6e05\u7406"},"next":{"title":"\u5de5\u5177\u5c0f\u7ed3","permalink":"/docs/category/\u5de5\u5177\u5c0f\u7ed3"}}');var r=n(74848),s=n(28453);const i={},c=void 0,d={},o=[{value:"Windows",id:"windows",level:2},{value:"\u624b\u52a8",id:"\u624b\u52a8",level:3},{value:"wevtutil",id:"wevtutil",level:3},{value:"meterpreter",id:"meterpreter",level:3},{value:"powershell",id:"powershell",level:3},{value:"\u6e05\u9664recent",id:"\u6e05\u9664recent",level:3},{value:"\u8fdc\u7a0b\u684c\u9762\u8bb0\u5f55\u6e05\u9664",id:"\u8fdc\u7a0b\u684c\u9762\u8bb0\u5f55\u6e05\u9664",level:3},{value:"\u65e5\u5fd7\u7ed5\u8fc7",id:"\u65e5\u5fd7\u7ed5\u8fc7",level:3},{value:"\u9632\u6062\u590d",id:"\u9632\u6062\u590d",level:3},{value:"Linux",id:"linux",level:2},{value:"\u6e05\u9664\u5386\u53f2\u547d\u4ee4\u8bb0\u5f55",id:"\u6e05\u9664\u5386\u53f2\u547d\u4ee4\u8bb0\u5f55",level:3},{value:"\u9690\u85cf\u64cd\u4f5c",id:"\u9690\u85cf\u64cd\u4f5c",level:3},{value:"\u5220\u9664\u6307\u5b9a\u5185\u5bb9",id:"\u5220\u9664\u6307\u5b9a\u5185\u5bb9",level:3},{value:"\u7be1\u6539\u65e5\u5fd7",id:"\u7be1\u6539\u65e5\u5fd7",level:3},{value:"\u5220\u9664\u6587\u4ef6",id:"\u5220\u9664\u6587\u4ef6",level:3},{value:"\u6279\u91cf\u6e05\u7406",id:"\u6279\u91cf\u6e05\u7406",level:3}];function a(e){const l={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.h2,{id:"windows",children:"Windows"}),"\n",(0,r.jsx)(l.h3,{id:"\u624b\u52a8",children:"\u624b\u52a8"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{children:"\u63a7\u5236\u9762\u677f-\u7ba1\u7406\u5de5\u5177-\u4e8b\u4ef6\u67e5\u770b\u5668-\u6e05\u9664\u65e5\u5fd7\n"})}),"\n",(0,r.jsx)(l.h3,{id:"wevtutil",children:"wevtutil"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:'wevtutil.exe el # \u5217\u51fa\u7cfb\u7edf\u4e2d\u6240\u6709\u65e5\u5fd7\u540d\u79f0\nwevtutil.exe cl system # \u6e05\u7406\u7cfb\u7edf\u65e5\u5fd7\nwevtutil.exe cl application # \u6e05\u7406\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\nwevtutil.exe cl security # \u6e05\u7406\u5b89\u5168\u65e5\u5fd7\n\nwevtutil.exe gli Application # \u83b7\u53d6\u5355\u4e2a\u65e5\u5fd7\u7c7b\u522b\u7684\u4fe1\u606f,\u5305\u62ec\u65f6\u95f4\u3001\u6570\u76ee\nwevtutil.exe qe Application /f:text # \u67e5\u770b\u6307\u5b9a\u7c7b\u522b\u7684\u65e5\u5fd7\u5185\u5bb9\nwevtutil.exe cl Application # \u5220\u9664\u8be5\u7c7b\u65e5\u5fd7\u6240\u6709\u5185\u5bb9\nwevtutil.exe qe Security /f:text /rd:true /c:10 # \u83b7\u53d6security\u7684\u6700\u8fd1\u5341\u6761\u65e5\u5fd7\nwevtutil.exe epl Security 1.evtx # \u5bfc\u51fa\u6307\u5b9a\u65e5\u5fd7\u4fdd\u5b58\nwevtutil.exe epl Security 1.evtx "/q:*[System [(EventRecordID!=666)]]" # \u5220\u9664Security\u4e0b\u7684\u5355\u6761\u65e5\u5fd7(EventRecordID=666)\uff0c\u5e76\u4fdd\u5b58\u4e3a1.evtx\nwevtutil.exe epl Security 1.evtx "/q:*[System [(EventRecordID>555) or (EventRecordID<666)]]" # \u5220\u9664Security\u4e0b\u7684\u591a\u6761\u65e5\u5fd7(EventRecordID\u4e3a\u5c0f\u4e8e666\u6216\u5927\u4e8e555)\uff0c\u5e76\u4fdd\u5b58\u4e3a1.evtx\nwevtutil.exe epl Security 1.evtx "/q:*[System [TimeCreated[@SystemTime >\'2021-08-20T10:41:08\' or @SystemTime <\'2021-08-20T9:41:07\']]]" # \u5220\u9664\u6307\u5b9a\u65f6\u95f4\u6bb5\u7684\u65e5\u5fd7\n'})}),"\n",(0,r.jsx)(l.h3,{id:"meterpreter",children:"meterpreter"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:"run clearlogs \nclearev        # \u6e05\u9664windows\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u3001\u5b89\u5168\u65e5\u5fd7\n"})}),"\n",(0,r.jsx)(l.h3,{id:"powershell",children:"powershell"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:'powershell -command "& {Clear-Eventlog -Log Application,System,Security}"\nGet-WinEvent -ListLog Application,Setup,Security -Force | % {Wevtutil.exe cl $_.Logname}\n'})}),"\n",(0,r.jsx)(l.h3,{id:"\u6e05\u9664recent",children:"\u6e05\u9664recent"}),"\n",(0,r.jsxs)(l.ol,{children:["\n",(0,r.jsx)(l.li,{children:"\u6587\u4ef6\u8d44\u6e90\u7ba1\u7406\u5668\u4e2d \u67e5\u770b->\u9009\u9879->\u5728\u5e38\u89c4->\u9690\u79c1\u4e2d\u9009\u62e9\u6e05\u9664"}),"\n",(0,r.jsxs)(l.li,{children:["\u6216\u76f4\u63a5\u6253\u5f00 ",(0,r.jsx)(l.code,{children:"C:\\Users\\Administrator\\Recent"})," \u5e76\u5220\u9664\u6240\u6709\u5185\u5bb9"]}),"\n",(0,r.jsxs)(l.li,{children:["\u6216\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165",(0,r.jsx)(l.code,{children:"del /f /s /q \u201c%userprofile%\\Recent*.*"})]}),"\n"]}),"\n",(0,r.jsx)(l.h3,{id:"\u8fdc\u7a0b\u684c\u9762\u8bb0\u5f55\u6e05\u9664",children:"\u8fdc\u7a0b\u684c\u9762\u8bb0\u5f55\u6e05\u9664"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:'@echo off\n@reg delete "HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default" /va /f\n@del "%USERPROFILE%\\My Documents\\Default.rdp" /a\n@exit\n'})}),"\n",(0,r.jsx)(l.h3,{id:"\u65e5\u5fd7\u7ed5\u8fc7",children:"\u65e5\u5fd7\u7ed5\u8fc7"}),"\n",(0,r.jsxs)(l.p,{children:["Windows\u65e5\u5fd7\u5bf9\u5e94\u4e8e",(0,r.jsx)(l.code,{children:"eventlog"}),"\u670d\u52a1\uff0c\u627e\u5230\u8be5\u670d\u52a1\u5bf9\u5e94\u7684\u8fdb\u7a0b",(0,r.jsx)(l.code,{children:"svchost.exe"}),"\uff0c\u8fdb\u800c\u7b5b\u9009\u51fa",(0,r.jsx)(l.code,{children:"svchost.exe"}),"\u8fdb\u7a0b\u4e2d\u5177\u4f53\u5b9e\u73b0\u65e5\u5fd7\u529f\u80fd\u7684\u7ebf\u7a0b\uff0c\u8c03\u7528TerminateThread\u7ed3\u675f\u7ebf\u7a0b\uff0c\u7834\u574f\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd"]}),"\n",(0,r.jsxs)(l.p,{children:["Windows Event Log \u670d\u52a1\u9700\u8981\u8c03\u7528",(0,r.jsx)(l.code,{children:"wevtsvc.dll"}),"\uff0c\u5b8c\u6574\u8def\u5f84\u4e3a",(0,r.jsx)(l.code,{children:"%WinDir%\\System32\\wevtsvc.dll"}),"\uff0c\u5982\u679c\u7ebf\u7a0b\u8c03\u7528\u4e86",(0,r.jsx)(l.code,{children:"wevtsvc.dll"}),"\uff0c\u53ef\u4ee5\u5927\u81f4\u5224\u5b9a\u8be5\u7ebf\u7a0b\u5b9e\u73b0\u4e86\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd"]}),"\n",(0,r.jsxs)(l.p,{children:["\u5de5\u5177\uff1a",(0,r.jsx)(l.a,{href:"https://github.com/hlldz/Invoke-Phant0m",children:"https://github.com/hlldz/Invoke-Phant0m"})]}),"\n",(0,r.jsxs)(l.p,{children:["\u6062\u590d\u65b9\u6cd5\uff1a\u91cd\u542fWindows Event Log \u670d\u52a1\uff1a",(0,r.jsx)(l.code,{children:"net start eventlog"})]}),"\n",(0,r.jsx)(l.h3,{id:"\u9632\u6062\u590d",children:"\u9632\u6062\u590d"}),"\n",(0,r.jsx)(l.p,{children:"\u591a\u6b21\u64e6\u9664\u8986\u76d6\uff0c\u4ee51.txt\u4e3a\u4f8b\uff0c\u5220\u9664\u540e\uff0c\u65b0\u5efa1.txt\uff0c\u5199\u5165\u968f\u673a\u5185\u5bb9\uff0c\u518d\u5220\u9664->\u65b0\u5efa\u540c\u540d\u6587\u4ef6->\u5199\u5165->\u5220\u9664\uff0c\u5faa\u73af\u64cd\u4f5c"}),"\n",(0,r.jsx)(l.h2,{id:"linux",children:"Linux"}),"\n",(0,r.jsx)(l.h3,{id:"\u6e05\u9664\u5386\u53f2\u547d\u4ee4\u8bb0\u5f55",children:"\u6e05\u9664\u5386\u53f2\u547d\u4ee4\u8bb0\u5f55"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:"histroy -r        # \u5220\u9664\u5f53\u524d\u4f1a\u8bdd\u5386\u53f2\u8bb0\u5f55\nhistory -c        # \u5220\u9664\u5185\u5b58\u4e2d\u7684\u6240\u6709\u547d\u4ee4\u5386\u53f2\nrm -rf ~/.bash_history        # \u5220\u9664\u5386\u53f2\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\n"})}),"\n",(0,r.jsx)(l.h3,{id:"\u9690\u85cf\u64cd\u4f5c",children:"\u9690\u85cf\u64cd\u4f5c"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:"[\u7a7a\u683c]set +o history\n"})}),"\n",(0,r.jsx)(l.h3,{id:"\u5220\u9664\u6307\u5b9a\u5185\u5bb9",children:"\u5220\u9664\u6307\u5b9a\u5185\u5bb9"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:"sed -i '/xxx/'d  filename        # \u5220\u9664\u5e26\u6709xxx\u7684\u65e5\u5fd7\n"})}),"\n",(0,r.jsx)(l.h3,{id:"\u7be1\u6539\u65e5\u5fd7",children:"\u7be1\u6539\u65e5\u5fd7"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:"sed -i 's/123.123.123.123/127.0.0.1/g' filename        # \u5c06\u6240\u6709123.123.123.123ip\u66ff\u6362\u4e3a127.0.0.1\n"})}),"\n",(0,r.jsx)(l.h3,{id:"\u5220\u9664\u6587\u4ef6",children:"\u5220\u9664\u6587\u4ef6"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:"shred -f -u -z -v -n 4 filename        # \u5b9e\u73b0\u5b89\u5168\u7684\u4ece\u786c\u76d8\u4e0a\u64e6\u9664\u6570\u636e\uff0c\u9ed8\u8ba4\u8986\u76d63\u6b21\uff0c\u901a\u8fc7 -n\u6307\u5b9a\u6570\u636e\u8986\u76d6\u6b21\u6570\n"})}),"\n",(0,r.jsx)(l.h3,{id:"\u6279\u91cf\u6e05\u7406",children:"\u6279\u91cf\u6e05\u7406"}),"\n",(0,r.jsx)(l.pre,{children:(0,r.jsx)(l.code,{className:"language-shell",children:"echo > /var/log/syslog\necho > /var/log/messages\necho > /var/log/httpd/access_log\necho > /var/log/httpd/error_log\necho > /var/log/xferlog\necho > /var/log/secure\necho > /var/log/auth.log\necho > /var/log/user.log\necho > /var/log/wtmp\necho > /var/log/lastlog\necho > /var/log/btmp\necho > /var/run/utmp\n"})})]})}function h(e={}){const{wrapper:l}={...(0,s.R)(),...e.components};return l?(0,r.jsx)(l,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);