"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[9179],{28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var r=s(96540);const i={},c=r.createContext(i);function l(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(c.Provider,{value:n},e.children)}},39572:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"\u6e17\u900f\u6d4b\u8bd5/C2/CS/\u7834\u89e3CS","title":"\u7834\u89e3CS","description":"\u7834\u89e3CS","source":"@site/docs/01.\u6e17\u900f\u6d4b\u8bd5/10.C2/01.CS/1.\u7834\u89e3CS.md","sourceDirName":"01.\u6e17\u900f\u6d4b\u8bd5/10.C2/01.CS","slug":"/\u6e17\u900f\u6d4b\u8bd5/C2/CS/\u7834\u89e3CS","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/C2/CS/\u7834\u89e3CS","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"d4m1ts","lastUpdatedAt":1748784450000,"sidebarPosition":1,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"CS","permalink":"/docs/category/cs"},"next":{"title":"Malleable-C2-Profiles","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/C2/CS/Malleable-C2-Profiles"}}');var i=s(74848),c=s(28453);const l={},t=void 0,a={},o=[{value:"\u7834\u89e3CS",id:"\u7834\u89e3cs",level:2},{value:"\u6587\u4ef6\u4f4d\u7f6e",id:"\u6587\u4ef6\u4f4d\u7f6e",level:3},{value:"License.class",id:"licenseclass",level:3},{value:"\u53bb\u9664listener\u4e2a\u6570\u9650\u5236",id:"\u53bb\u9664listener\u4e2a\u6570\u9650\u5236",level:3},{value:"\u540e\u95e8\u7279\u5f81\u6307\u7eb9",id:"\u540e\u95e8\u7279\u5f81\u6307\u7eb9",level:3},{value:"\u7f16\u8bd1\u6210class",id:"\u7f16\u8bd1\u6210class",level:3},{value:"\u6253\u5305",id:"\u6253\u5305",level:3},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"\u7834\u89e3cs",children:"\u7834\u89e3CS"}),"\n",(0,i.jsxs)(n.p,{children:["\u539f\u7248\uff1a",(0,i.jsx)(n.a,{href:"https://github.com/microidz/Cobaltstrike-Trial",children:"https://github.com/microidz/Cobaltstrike-Trial"})]}),"\n",(0,i.jsxs)(n.p,{children:["\u6821\u9a8c\uff1a",(0,i.jsx)(n.a,{href:"https://verify.cobaltstrike.com/",children:"https://verify.cobaltstrike.com/"})]}),"\n",(0,i.jsxs)(n.p,{children:["xor.bin\uff1a",(0,i.jsx)(n.a,{href:"https://github.com/verctor/CS_xor64",children:"https://github.com/verctor/CS_xor64"})]}),"\n",(0,i.jsx)(n.h3,{id:"\u6587\u4ef6\u4f4d\u7f6e",children:"\u6587\u4ef6\u4f4d\u7f6e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"common/License.class  # \u4fee\u6539\u65f6\u95f4\u53ca\u63d0\u793a\u6846\ncommon/ArtifactUtils.class  # \u53bb\u9664\u540e\u95e8\u7279\u5f81\u6307\u7eb9\nserver/ProfileEdits.class # \u53bb\u9664\u540e\u95e8\u7279\u5f81\u6307\u7eb9\naggressor/dialogs/ListenerDialog.class  # \u53bb\u9664listener\u4e2a\u6570\u9650\u5236\naggressor/AggressorClient.class  # \u6807\u9898\u680f\u4fee\u6539\uff0c\u6539\u53d8\u6539\u5427\nresources/template.x64.ps1\u3001template.x86.ps1 # \u53bb\u9664\u540e\u95e8\u7279\u5f81\u6307\u7eb9\nresources/xor.bin  # \u653e\u5165xor.bin\u6587\u4ef6\nresources/xor64.bin  # \u653e\u5165xor.bin\u6587\u4ef6\n"})}),"\n",(0,i.jsx)(n.h3,{id:"licenseclass",children:"License.class"}),"\n",(0,i.jsxs)(n.p,{children:["\u9996\u5148\u5c06cobaltstrike.jar\u4ee5\u538b\u7f29\u5305\u683c\u5f0f\u6253\u5f00\uff0c\u590d\u5236License.class\u51fa\u6765\uff0c\u7136\u540e\u8fd0\u884c",(0,i.jsx)(n.code,{children:"jad.exe License.class"}),"\uff0cjad\u76ee\u5f55\u4e0b\u5c31\u4f1a\u751f\u6210",(0,i.jsx)(n.code,{children:"License.jad"}),"\uff0c\u4fee\u6539\u540e\u7f00\u4e3a",(0,i.jsx)(n.code,{children:"Java"}),"\uff0c\u5373\u662f\u6e90\u7801\u6587\u4ef6\u4e86\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["\u522b\u7528",(0,i.jsx)(n.code,{children:"jad"}),"\u53bb\u53cd\u7f16\u8bd1",(0,i.jsx)(n.code,{children:"class"}),"\uff0c\u592a\u5751\u4e86\uff0c\u5c31\u662f\u56e0\u4e3a\u8fd9\u73a9\u610f\u513f\uff0c\u6211\u641e\u4e86\u4e00\u4e0b\u5348\uff0c\u8fd9\u73a9\u610f\u513f\u53cd\u7f16\u8bd1\u51fa\u6765\u7684",(0,i.jsx)(n.code,{children:"java"}),"\uff0c\u5f53\u4f60\u8981\u7ed9\u4ed6\u7f16\u8bd1\u6210",(0,i.jsx)(n.code,{children:"class"}),"\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u62a5\u9519\uff01\uff01\uff01\u5efa\u8bae\u7528",(0,i.jsx)(n.code,{children:"jd-gui"})]})}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u91cc\u5c06\u63d0\u4f9b\u4e24\u79cd\u7834\u89e3\u601d\u8def\u3002"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(1) \u76f4\u63a5\u4fee\u6539\u8bd5\u7528\u65f6\u95f4"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"    private static long life = 21L;\n    \u5c0621\u5929\u7684\u8bd5\u7528\u671f\u4fee\u6539\u6210\n    private static long life = 99999L;\n\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(2) \u4fee\u6539isTrail\u7684\u5224\u65ad\u903b\u8f91"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"     public static boolean isTrial()\n     {\n     return true;\n     }\n    \u4fee\u6539\u6210\n     public static boolean isTrial()\n     {\n     return false;\n     }\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5f80\u4e0b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"public static void checkLicenseGUI(Authorization auth)\n{\n ....\n}\n\u4fee\u6539\u6210\npublic static void checkLicenseGUI(Authorization authorization)\n{\n}\n\u540c\u7406\npublic static void checkLicenseConsole(Authorization authorization)\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u53bb\u9664listener\u4e2a\u6570\u9650\u5236",children:"\u53bb\u9664listener\u4e2a\u6570\u9650\u5236"}),"\n",(0,i.jsxs)(n.p,{children:["\u6587\u4ef6\u5728",(0,i.jsx)(n.code,{children:"aggressor/dialogs/ListenerDialog.class"})]}),"\n",(0,i.jsx)(n.p,{children:"\u53bb\u9664"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'if(Listener.isEgressBeacon(payload) && DataUtils.isBeaconDefined(datal) && !name.equals(DataUtils.getEgressBeaconListener(datal)))\n {\n DialogUtils.showError("You may only define one egress Beacon per team server.\\nThere are a few things I need to sort before you can\\nput multiple Beacon HTTP/DNS listeners on one server.\\nSpin up a new team server and add your listener there.");\n } else\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u540e\u95e8\u7279\u5f81\u6307\u7eb9",children:"\u540e\u95e8\u7279\u5f81\u6307\u7eb9"}),"\n",(0,i.jsx)(n.p,{children:"\u8bd5\u7528\u7248\u672c\u7684Cobalt Strike\u6709\u56fa\u5b9a\u7684\u6307\u7eb9\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5b58\u5728\u540e\u95e8\u7279\u5f81\u6307\u7eb9\u7684\u5176\u4e2d\u51e0\u4e2a\u5730\u65b9"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"common/ArtifactUtils.class"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'packer.addString("X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*");\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"resources/template.x64.ps1\u3001template.x86.ps1"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$eicar = 'X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*'\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"server/ProfileEdits.class"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'c2profile.addCommand(".http-get.server", "!header", "X-Malware: X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*");\nc2profile.addCommand(".http-post.server", "!header", "X-Malware: X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*");\nc2profile.addCommand(".http-stager.server", "!header", "X-Malware: X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*");\nc2profile.addCommand(".stage.transform-x86", "append", "X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*");\nc2profile.addCommand(".stage.transform-x64", "append", "X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*");\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u7f16\u8bd1\u6210class",children:"\u7f16\u8bd1\u6210class"}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u540e\u4f7f\u7528"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"javac -classpath cobaltstrike.jar xxxx.java\n\n\u6216\u8005\n\njavac -cp cobaltstrike.jar xxx.java\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8fdb\u884c\u7f16\u8bd1\u6210class"}),"\n",(0,i.jsx)(n.h3,{id:"\u6253\u5305",children:"\u6253\u5305"}),"\n",(0,i.jsxs)(n.p,{children:["\u5c06\u8fd9\u4e9b",(0,i.jsx)(n.code,{children:"class"}),"\u5168\u90e8\u6253\u5305\u6210",(0,i.jsx)(n.code,{children:"jar"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"jar cvfm xxx.jar ./META-INF/MANIFEST.MF ./\n\n\u6216\u8005\n\n\u4f7f\u7528\u89e3\u538b\u5de5\u5177\u6253\u5f00jar\u5305\uff0c\u7136\u540e\u5c06class\u653e\u5165\u5bf9\u5e94\u4f4d\u7f6e\u66ff\u6362\u539fclass\u5373\u53ef\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://xz.aliyun.com/t/2170",children:"https://xz.aliyun.com/t/2170"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.cnblogs.com/ssooking/p/9825917.html",children:"https://www.cnblogs.com/ssooking/p/9825917.html"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.bilibili.com/video/av34171888/",children:"https://www.bilibili.com/video/av34171888/"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/Lz1y/cobalt_strike_3.12_patch",children:"https://github.com/Lz1y/cobalt_strike_3.12_patch"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.jianshu.com/p/e8c28c1deec3",children:"\u4fee\u6539jar\u5305\u5185\u7684class"})})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);