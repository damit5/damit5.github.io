"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[5236],{8969:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/640-6b57a62c655c827087387bc7c934dd20.bin"},10481:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/image-20210325111204142-762f8304ac463dfb812e12b5c8c9b21f.png"},14951:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/image-20210325105221883-7792de9782973d9fbe4d5a6a5ea94f2d.png"},18308:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"\u6e17\u900f\u6d4b\u8bd5/C2/CS/\u8fdb\u9636\uff1a\u9690\u85cfC2\uff08\u901a\u8fc7\u7279\u5f81\uff09","title":"\u8fdb\u9636\uff1a\u9690\u85cfC2\uff08\u901a\u8fc7\u7279\u5f81\uff09","description":"\u8fdb\u9636\uff1a\u9690\u85cfC2 - \u901a\u8fc7\u7279\u5f81","source":"@site/docs/01.\u6e17\u900f\u6d4b\u8bd5/10.C2/01.CS/6.\u8fdb\u9636\uff1a\u9690\u85cfC2\uff08\u901a\u8fc7\u7279\u5f81\uff09.md","sourceDirName":"01.\u6e17\u900f\u6d4b\u8bd5/10.C2/01.CS","slug":"/\u6e17\u900f\u6d4b\u8bd5/C2/CS/\u8fdb\u9636\uff1a\u9690\u85cfC2\uff08\u901a\u8fc7\u7279\u5f81\uff09","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/C2/CS/\u8fdb\u9636\uff1a\u9690\u85cfC2\uff08\u901a\u8fc7\u7279\u5f81\uff09","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"d4m1ts","lastUpdatedAt":1748784450000,"sidebarPosition":6,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"Beacon","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/C2/CS/Beacon"},"next":{"title":"\u8fdb\u9636\uff1a\u9690\u85cfC2\uff08\u901a\u8fc7CDN\uff09","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/C2/CS/\u8fdb\u9636\uff1a\u9690\u85cfC2\uff08\u901a\u8fc7CDN\uff09"}}');var r=t(74848),l=t(28453);const i={},o=void 0,a={},c=[{value:"\u8fdb\u9636\uff1a\u9690\u85cfC2 - \u901a\u8fc7\u7279\u5f81",id:"\u8fdb\u9636\u9690\u85cfc2---\u901a\u8fc7\u7279\u5f81",level:2},{value:"\u7aef\u53e3\u7279\u5f81",id:"\u7aef\u53e3\u7279\u5f81",level:3},{value:"\u8bc1\u4e66\u7279\u5f81",id:"\u8bc1\u4e66\u7279\u5f81",level:3},{value:"keytool\u548c\u8bc1\u4e66\u7b80\u4ecb",id:"keytool\u548c\u8bc1\u4e66\u7b80\u4ecb",level:4},{value:"<strong>\u67e5\u770bCobaltStrike\u7684\u9ed8\u8ba4store\u6587\u4ef6</strong>",id:"\u67e5\u770bcobaltstrike\u7684\u9ed8\u8ba4store\u6587\u4ef6",level:4},{value:"\u751f\u6210\u65b0\u7684\u8bc1\u4e66",id:"\u751f\u6210\u65b0\u7684\u8bc1\u4e66",level:4},{value:"<strong>\u4fee\u6539https\u4e0a\u7ebf\u7684\u8bc1\u4e66</strong>",id:"\u4fee\u6539https\u4e0a\u7ebf\u7684\u8bc1\u4e66",level:4},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:3}];function d(e){const s={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"\u8fdb\u9636\u9690\u85cfc2---\u901a\u8fc7\u7279\u5f81",children:"\u8fdb\u9636\uff1a\u9690\u85cfC2 - \u901a\u8fc7\u7279\u5f81"}),"\n",(0,r.jsx)(s.h3,{id:"\u7aef\u53e3\u7279\u5f81",children:"\u7aef\u53e3\u7279\u5f81"}),"\n",(0,r.jsx)(s.p,{children:"CobaltStrike\u7684\u8fde\u63a5\u7aef\u53e3\u9ed8\u8ba4\u4e3a50050\uff0c\u8fd9\u662f\u4e2a\u5f88\u660e\u663e\u7684\u7279\u5f81\u3002\u8981\u60f3\u4fee\u6539\u8fd9\u4e2a\u9ed8\u8ba4\u7aef\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539teamserver\u6587\u4ef6\uff0c\u5c0650050\u7aef\u53e3\u6539\u6210\u4efb\u610f\u5176\u4ed6\u7aef\u53e3\u5747\u53ef\u3002"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"\u56fe\u7247",src:t(8969).A+"",width:"1080",height:"91"})}),"\n",(0,r.jsx)(s.h3,{id:"\u8bc1\u4e66\u7279\u5f81",children:"\u8bc1\u4e66\u7279\u5f81"}),"\n",(0,r.jsx)(s.h4,{id:"keytool\u548c\u8bc1\u4e66\u7b80\u4ecb",children:"keytool\u548c\u8bc1\u4e66\u7b80\u4ecb"}),"\n",(0,r.jsx)(s.p,{children:"Keytool\u662f\u4e00\u4e2ajava\u6570\u636e\u8bc1\u4e66\u7684\u7ba1\u7406\u5de5\u5177\uff0cKeytool\u5c06\u5bc6\u94a5 \u548c \u8bc1\u4e66 \u5b58\u653e\u5728\u4e00\u4e2a\u79f0\u4e3a keystore \u7684\u6587\u4ef6\u4e2d,\u5373.store\u540e\u7f00\u7684\u6587\u4ef6\u4e2d\u3002"}),"\n",(0,r.jsx)(s.p,{children:"Keystore\u662f\u4ec0\u4e48\uff1fkeystore\u662fjava\u7684\u5bc6\u94a5\u5e93\uff0c\u7528\u6765\u8fdb\u884c\u901a\u4fe1\u52a0\u5bc6\uff0c\u5982\u6570\u5b57\u7b7e\u540d\u3002keystore\u5c31\u662f\u7528\u6765\u4fdd\u5b58\u5bc6\u94a5\u5bf9\u7684\u516c\u94a5\u548c\u79c1\u94a5\u3002Keystore\u53ef\u7406\u89e3\u4e3a\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u5b58\u653e\u5f88\u591a\u4e2a\u7ec4\u6570\u636e\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u6bcf\u7ec4\u6570\u636e\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u4e24\u79cd\u6570\u636e:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u5bc6\u94a5\u5b9e\u4f53 \u2014- \u5bc6\u94a5(secret key)\u53c8\u6216\u8005\u79c1\u94a5\u548c\u914d\u5bf9\u516c\u94a5(\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6)"}),"\n",(0,r.jsx)(s.li,{children:"\u53ef\u4fe1\u4efb\u7684\u8bc1\u4e66\u5b9e\u4f53 \u2014- \u53ea\u5305\u542b\u516c\u94a5"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"image-20210325104930379",src:t(28341).A+"",width:"1242",height:"1030"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"\u67e5\u770b\u8bc1\u4e66\u6587\u4ef6\uff1akeytool -list -v -keystore xx.store\n\u4fee\u6539\u8bc1\u4e66\u5bc6\u7801\uff1akeytool -storepasswd -keystore xx.store\n\u4fee\u6539keystore\u7684alias\u522b\u540d\uff1akeytool -changealias -keystore xx.store -alias source_name -destalias new_name\n\u4fee\u6539alias\uff08\u522b\u540d\uff09\u7684\u5bc6\u7801\uff1akeytool -keypasswd -keystore xx.store -alias source_name\n"})}),"\n",(0,r.jsx)(s.h4,{id:"\u67e5\u770bcobaltstrike\u7684\u9ed8\u8ba4store\u6587\u4ef6",children:(0,r.jsx)(s.strong,{children:"\u67e5\u770bCobaltStrike\u7684\u9ed8\u8ba4store\u6587\u4ef6"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"keytool -list -v -keystore cobaltstrike.store\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"image-20210325105221883",src:t(14951).A+"",width:"2256",height:"1678"})}),"\n",(0,r.jsx)(s.p,{children:"\u53ef\u4ee5\u770b\u51faCobaltStrike\u9ed8\u8ba4\u7684store\u6587\u4ef6\u4e2d\u7684Alias name \u3001Onwer \u548c Issuer \u7684\u4fe1\u606f\uff0c\u7279\u5f81\u90fd\u6bd4\u8f83\u660e\u663e\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u901a\u8fc7\u76f4\u63a5\u8bbf\u95eeCobaltStrike\u670d\u52a1\u5668\u7684\u7aef\u53e3\uff0c\u4e5f\u53ef\u4ee5\u770b\u5230\u8bc1\u4e66\u4fe1\u606f\u3002"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"curl https://149.28.139.174:3389 -v -k\n"})}),"\n",(0,r.jsx)(s.h4,{id:"\u751f\u6210\u65b0\u7684\u8bc1\u4e66",children:"\u751f\u6210\u65b0\u7684\u8bc1\u4e66"}),"\n",(0,r.jsx)(s.p,{children:"\u670d\u52a1\u5668\u7aef\u4f7f\u7528\u7684\u8bc1\u4e66CobaltStrike.store\uff0c\u4e3a\u4e86\u63a9\u76d6\u9ed8\u8ba4SSL\u8bc1\u4e66\u5b58\u5728\u7684\u7279\u5f81\uff0c\u9700\u8981\u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e0d\u4e00\u6837\u7684\u8bc1\u4e66 \u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u8bc1\u4e66\uff1a"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'keytool -keystore cobaltstrike.store -storepass \u5bc6\u7801 -keypass \u5bc6\u7801 -genkey -keyalg RSA -alias google.com -dname "CN=(\u540d\u5b57\u4e0e\u59d3\u6c0f), OU=(\u7ec4\u7ec7\u5355\u4f4d\u540d\u79f0), O=(\u7ec4\u7ec7\u540d\u79f0), L=(\u57ce\u5e02\u6216\u533a\u57df\u540d\u79f0), ST=(\u5dde\u6216\u7701\u4efd\u540d\u79f0), C=(\u5355\u4f4d\u7684\u4e24\u5b57\u6bcd\u56fd\u5bb6\u4ee3\u7801)"\n'})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"-alias \u6307\u5b9a\u522b\u540d"}),"\n",(0,r.jsx)(s.li,{children:"-storepass pass \u548c -keypass pass \u6307\u5b9a\u5bc6\u94a5"}),"\n",(0,r.jsx)(s.li,{children:"-keyalg \u6307\u5b9a\u7b97\u6cd5"}),"\n",(0,r.jsx)(s.li,{children:"-dname \u6307\u5b9a\u6240\u6709\u8005\u4fe1\u606f"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:' # \u751f\u6210\u8bc1\u4e66\uff0c\u6700\u597d\u5185\u5bb9\u4e0d\u8981\u548cCS\u6709\u5173\uff0c\u8bbe\u7f6e\u7684\u5bc6\u7801\u8981\u548cteamserver\u91cc\u9762\u7684\u540c\u6b65\nkeytool -keystore cobaltstrike.store -storepass 123456 -keypass 123456 -genkey -keyalg RSA -alias google.com -dname "CN=US, OU=google.com, O=Sofatest, L=GoogleInc, ST=Cyberspace, C=US"\n\n# \u8f6c\u6362\u6210\u6807\u51c6\u683c\u5f0f\nkeytool -importkeystore -srckeystore ./cobaltstrike.store -destkeystore ./cobaltstrike.store -deststoretype pkcs12\n'})}),"\n",(0,r.jsx)(s.h4,{id:"\u4fee\u6539https\u4e0a\u7ebf\u7684\u8bc1\u4e66",children:(0,r.jsx)(s.strong,{children:"\u4fee\u6539https\u4e0a\u7ebf\u7684\u8bc1\u4e66"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["cobaltStrike.store \u4ec5\u4ec5\u662f\u670d\u52a1\u5668\u7aef\u8fde\u63a5\u7684\u8bc1\u4e66\u3002",(0,r.jsx)(s.strong,{children:"\u901a\u8fc7https\u4e0a\u7ebf\u4f7f\u7528\u7684\u8bc1\u4e66\uff0c\u4e0d\u662f cobaltstrike.store"}),"\uff0c\u5e76\u4e14\uff0c\u8be5\u8bc1\u4e66\u4e5f\u662f\u9ed8\u8ba4\u7684\uff01"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["\u5982\u679c\u60f3\u8981\u4fee\u6539\u8fd9\u4e2a\u8bc1\u4e66\uff0c\u9700\u8981\u4fee\u6539Malleable C2 profile\u3002\u8be6\u60c5\u770b\u5b98\u65b9\u6587\u6863\uff1a",(0,r.jsx)(s.a,{href:"https://www.cobaltstrike.com/help-malleable-c2Self-signed",children:"https://www.cobaltstrike.com/help-malleable-c2Self-signed"})," Certificates with SSL Beacon \u548c Valid SSL Certificates with SSL Beacon \u8fd9\u4e24\u4e2a\u90fd\u662f\u7528\u6765\u4fee\u6539https\u4e0a\u7ebf\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u3002"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Self-signed Certificates with SSL Beacon \u8fd9\u91cc\u662f\u81ea\u5df1\u8bbe\u5b9a\u7684\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002"}),"\n",(0,r.jsx)(s.li,{children:"Valid SSL Certificates with SSL Beacon \u8fd9\u91cc\u662f\u53eb\u6211\u4eec\u4f7f\u7528\u6709\u6548\u7684\u8bc1\u4e66\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e4b\u524d\u4fee\u6539\u8fc7\u7684cobaltstrike.store\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4ece\u5176\u4ed6\u5730\u65b9\u5f04\u8fc7\u6765\u7684\u8bc1\u4e66"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"\u56fe\u7247",src:t(60950).A+"",width:"1080",height:"745"})}),"\n",(0,r.jsx)(s.p,{children:"\u6211\u4eec\u53ef\u4ee5\u5728\u542f\u52a8CobaltStrike\u7684\u65f6\u5019\uff0c\u6307\u5b9a\u4e00\u4e2aprofile\u6587\u4ef6\uff0c\u7136\u540e\u5728\u6587\u4ef6\u4e2d\u914d\u7f6e\u4e0a\u7ebf\u65f6\u4f7f\u7528\u7684\u8bc1\u4e66\u6587\u4ef6\u5373\u53ef\u4fee\u6539\u4e0a\u7ebf\u65f6\u9ed8\u8ba4\u7684\u8bc1\u4e66\u3002"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"image-20210325111204142",src:t(10481).A+"",width:"1722",height:"1574"})}),"\n",(0,r.jsx)(s.h3,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"https://mp.weixin.qq.com/s/iKwHD1gnEYAQOeC-Wdnk4g",children:"\u5982\u4f55\u9690\u853d\u4f60\u7684C2"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28341:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/image-20210325104930379-89449ba7907e64ad2a79373f4ea92bd7.png"},28453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>o});var n=t(96540);const r={},l=n.createContext(r);function i(e){const s=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(l.Provider,{value:s},e.children)}},60950:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/640-6ff5620209db6e99fcb4d21a68d8a3cf.png"}}]);