"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[386],{14578:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image-20240919\u4e0a\u534883120682-f128850af59d69997959bbbef79c96f8.png"},16498:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image-20240919\u4e0a\u534883349960-18224bf97d456ae5bba651507de3a1f8.png"},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var t=s(96540);const r={},a=t.createContext(r);function i(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(a.Provider,{value:n},e.children)}},50138:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image-20240919\u4e0a\u534882915588-58b8fc4ead9e9428382f93dba3c2a973.png"},51120:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>c,frontMatter:()=>i,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"\u7f16\u7a0b\u5f00\u53d1/Java/Burpsuite\u63d2\u4ef6\u5f00\u53d1/\u6570\u636e\u5305\u7684\u589e\u5220\u6539\u67e5","title":"\u6570\u636e\u5305\u7684\u589e\u5220\u6539\u67e5","description":"\u5b9e\u73b0\u6548\u679c","source":"@site/docs/03.\u7f16\u7a0b\u5f00\u53d1/Java/03.Burpsuite\u63d2\u4ef6\u5f00\u53d1/02.\u6570\u636e\u5305\u7684\u589e\u5220\u6539\u67e5.md","sourceDirName":"03.\u7f16\u7a0b\u5f00\u53d1/Java/03.Burpsuite\u63d2\u4ef6\u5f00\u53d1","slug":"/\u7f16\u7a0b\u5f00\u53d1/Java/Burpsuite\u63d2\u4ef6\u5f00\u53d1/\u6570\u636e\u5305\u7684\u589e\u5220\u6539\u67e5","permalink":"/docs/\u7f16\u7a0b\u5f00\u53d1/Java/Burpsuite\u63d2\u4ef6\u5f00\u53d1/\u6570\u636e\u5305\u7684\u589e\u5220\u6539\u67e5","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"d4m1ts","lastUpdatedAt":1749874405000,"sidebarPosition":2,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"Burpsuite\u63d2\u4ef6\u5f00\u53d1\u57fa\u7840","permalink":"/docs/\u7f16\u7a0b\u5f00\u53d1/Java/Burpsuite\u63d2\u4ef6\u5f00\u53d1/Burpsuite\u63d2\u4ef6\u5f00\u53d1\u57fa\u7840"},"next":{"title":"\u53f3\u952e\u83dc\u5355\u5b9e\u73b0\u7279\u5b9a\u529f\u80fd","permalink":"/docs/\u7f16\u7a0b\u5f00\u53d1/Java/Burpsuite\u63d2\u4ef6\u5f00\u53d1/\u53f3\u952e\u83dc\u5355\u5b9e\u73b0\u7279\u5b9a\u529f\u80fd"}}');var r=s(74848),a=s(28453);const i={},l=void 0,d={},p=[{value:"\u5b9e\u73b0\u6548\u679c",id:"\u5b9e\u73b0\u6548\u679c",level:2},{value:"\u5b9e\u73b0\u4ee3\u7801",id:"\u5b9e\u73b0\u4ee3\u7801",level:2},{value:"\u5b9e\u73b0\u6d4b\u8bd5",id:"\u5b9e\u73b0\u6d4b\u8bd5",level:2},{value:"\u6269\u5c55\u603b\u7ed3",id:"\u6269\u5c55\u603b\u7ed3",level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u5b9e\u73b0\u6548\u679c",children:"\u5b9e\u73b0\u6548\u679c"}),"\n",(0,r.jsx)(n.p,{children:"\u81ea\u52a8\u4fee\u6539\u8bf7\u6c42\u6570\u636e\u5305\u4e2d\u7684header\u3001body\u548cparam\uff0c\u5e76\u4fee\u6539\u54cd\u5e94\u5305\u7ed3\u679c\uff0c\u4ee5\u53ca\u5355\u72ec\u53d1\u9001\u65b0\u7684\u8bf7\u6c42\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u6d89\u53ca\u63a5\u53e3\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"IHttpListener"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u5b9e\u73b0\u4ee3\u7801",children:"\u5b9e\u73b0\u4ee3\u7801"}),"\n",(0,r.jsx)(n.p,{children:"\u521b\u5efa\u9879\u76ee\u8fc7\u7a0b\u7701\u7565\uff0c\u76f4\u63a5\u4ece\u4ee3\u7801\u5165\u624b\uff0c\u4f7f\u7528\u65e7\u7248API\u5f00\u53d1\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'package burp;\n\nimport java.util.Arrays;\nimport java.util.List;\n\npublic class BurpExtender implements IBurpExtender, IHttpListener {\n    // \u56de\u8c03\u5bf9\u8c61\n    private IBurpExtenderCallbacks callbacks;\n    // \u8f85\u52a9\u7c7b\uff0c\u4e00\u822c\u7528\u4e8e\u8f85\u52a9\u5206\u6790\u6570\u636e\u5305\u7ed3\u6784\n    private IExtensionHelpers helpers;\n\n    // \u5b9e\u73b0 IBurpExtender \u63a5\u53e3\u51fd\u6570\n    @Override\n    public void registerExtenderCallbacks(IBurpExtenderCallbacks callbacks) {\n        // \u8bbe\u7f6e\u63d2\u4ef6\u540d\u5b57\n        callbacks.setExtensionName("Demo");\n\n        // callbacks\u5230\u5904\u90fd\u8981\u7528\uff0c\u641e\u6210\u7c7b\u53d8\u91cf\n        this.callbacks = callbacks;\n\n        // \u8f85\u52a9\u7c7b\uff0c\u4e00\u822c\u7528\u4e8e\u8f85\u52a9\u5206\u6790\u6570\u636e\u5305\u7ed3\u6784\uff0c\u7c7b\u53d8\u91cf\u65b9\u4fbf\u5176\u4ed6\u51fd\u6570\u8c03\u7528\n        helpers = callbacks.getHelpers();\n\n        // \u6ce8\u518c HttpListener \uff0c\u5fc5\u987b\u8981\u6ce8\u518c\u4e86burp\u6709\u65b0\u6d88\u606f\u624d\u4f1a\u901a\u77e5\u4f60\n        callbacks.registerHttpListener(this);\n\n    }\n\n    // \u5b9e\u73b0 IHttpListener \u63a5\u53e3\u51fd\u6570\n    @Override\n    public void processHttpMessage(int toolFlag, boolean messageIsRequest, IHttpRequestResponse messageInfo) {\n        // \u5224\u65ad\u662f\u54ea\u4e2a\u5730\u65b9\u76d1\u542c\u5230\u7684\u8bf7\u6c42\uff0c\u6b64\u5904\u4e3a Proxy \u76d1\u542c\u5230\u7684\u8bf7\u6c42\n        if (toolFlag == IBurpExtenderCallbacks.TOOL_PROXY) {\n            // \u5224\u65ad\u662f\u8bf7\u6c42\u8fd8\u662f\u54cd\u5e94\uff0cTrue \u5c31\u662f\u8bf7\u6c42\u6570\u636e\u5305\uff0c False\u5c31\u662f\u54cd\u5e94\u6570\u636e\u5305\n            if (messageIsRequest) {\n                // \u4f7f\u7528helper\u8f85\u52a9\u5206\u6790\u8bf7\u6c42\n                IRequestInfo requestInfo = helpers.analyzeRequest(messageInfo.getRequest());\n                // \u83b7\u53d6header\n                List<String> headers = requestInfo.getHeaders();\n                // \u83b7\u53d6param\uff08\u5305\u542b\u4e86body\u4e2d\u7684\uff09\n                List<IParameter> parameters = requestInfo.getParameters();\n                // \u83b7\u53d6post raw body\n                byte[] raw_body = Arrays.copyOfRange(messageInfo.getRequest(), requestInfo.getBodyOffset(), messageInfo.getRequest().length);\n\n                // \u66f4\u65b0header\u4e2d\u7684UA\n                for (String header: headers) {\n                    if (header.contains("User-Agent")){\n                        int index = headers.indexOf(header);\n                        headers.set(index, "User-Agent: TEST UA");\n                    }\n                }\n                // \u589e\u52a0\u4e00\u6761header\n                headers.add("Add-Header: TEST ADD HEADER");\n                // \u66f4\u65b0\u6574\u4f53header\u5185\u5bb9\u5230\u8bf7\u6c42\u4f53\u4e2d\n                byte[] newReq = helpers.buildHttpMessage(headers, raw_body);\n\n                // \u66f4\u65b0param: a=xxx\n                IParameter parameter1 = helpers.buildParameter("a", "testUrlParam", IParameter.PARAM_URL);\n                // \u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u7531\u4e8e\u4e0a\u65b9\u66f4\u65b0\u4e86\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6240\u4ee5\u8fd9\u91cc\u7528\u4e86\u66f4\u65b0\u540e\u7684newReq\uff0c\u5177\u4f53\u53ef\u4ee5\u4e0b\u65ad\u70b9\u5206\u6790\n                // \u5982\u679c\u6ca1\u6709\u66f4\u65b0\u8bf7\u6c42\u9898\uff0c\u5c31\u7528\u539f\u59cb\u7684 messageInfo.getRequest() \u5373\u53ef\n                // helpers.updateParameter(messageInfo.getRequest(), parameter1); // \u4ece\u539f\u59cb\u6570\u636e\u5305\u66f4\u65b0\n                newReq = helpers.updateParameter(newReq, parameter1);\n                // \u589e\u52a0\u4e00\u4e2a\u53c2\u6570\u5230body\n                IParameter parameter2 = helpers.buildParameter("testParam", "testValue", IParameter.PARAM_BODY);\n                newReq = helpers.addParameter(newReq, parameter2);\n\n                // \u5728\u5f53\u524d\u8bf7\u6c42\u57fa\u7840\u4e0a\u8fdb\u884c\u66f4\u65b0\n                messageInfo.setRequest(newReq);\n                // \u5355\u72ec\u53d1\u9001\u4e00\u6b21\u7be1\u6539\u540e\u7684\u8bf7\u6c42\uff0c\u589e\u52a0Cookie\u7279\u5f81\n                newReq = helpers.addParameter(newReq, helpers.buildParameter("make", "request", IParameter.PARAM_COOKIE));\n                IHttpRequestResponse response = callbacks.makeHttpRequest(messageInfo.getHttpService(), newReq);\n                // callbacks.makeHttpRequest(messageInfo.getHttpService(), messageInfo.getRequest()); // \u53d1\u9001\u4e00\u4e2a\u539f\u59cb\u8bf7\u6c42\n                callbacks.printOutput(new String(response.getResponse()));\n            } else {\n                // \u54cd\u5e94\u6570\u636e\u5305\n                // \u4f7f\u7528helper\u8f85\u52a9\u5206\u6790\u8bf7\u6c42\n                IResponseInfo requestInfo = helpers.analyzeResponse(messageInfo.getResponse());\n                byte[] response = helpers.buildHttpMessage(requestInfo.getHeaders(), "modify response".getBytes());\n                // \u7be1\u6539\n                messageInfo.setResponse(response);\n            }\n        }\n\n    }\n}\n\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20240919\u4e0a\u534882915588",src:s(50138).A+"",width:"3584",height:"2168"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5b9e\u73b0\u6d4b\u8bd5",children:"\u5b9e\u73b0\u6d4b\u8bd5"}),"\n",(0,r.jsx)(n.p,{children:"\u5b9e\u9645\u53d1\u9001\u8bf7\u6c42"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"curl -x http://127.0.0.1:8080 'http://127.0.0.1/?a=bbbb' -v\n\n*   Trying 127.0.0.1:8080...\n* Connected to 127.0.0.1 (127.0.0.1) port 8080\n> GET http://127.0.0.1/?a=bbbb HTTP/1.1\n> Host: 127.0.0.1\n> User-Agent: curl/8.4.0\n> Accept: */*\n> Proxy-Connection: Keep-Alive\n>\n"})}),"\n",(0,r.jsx)(n.p,{children:"nc\u63a5\u6536\u5230\u7684\u8bf7\u6c42\uff0c\u53ef\u89c1\u5df2\u7ecf\u88ab\u66ff\u6362"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /?a=testUrlParam HTTP/1.1\nHost: 127.0.0.1\nUser-Agent: TEST UA\nAccept: */*\nConnection: close\nAdd-Header: TEST ADD HEADER\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 19\n\ntestParam=testValue\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f97\u5230\u7684\u88ab\u66ff\u6362\u54cd\u5e94\u5185\u5bb9"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"HTTP/1.0 200 OK\nServer: SimpleHTTP/0.6 Python/3.7.9\nDate: Wed, 18 Sep 2024 11:03:04 GMT\nContent-type: text/html\nContent-Length: 15\nLast-Modified: Wed, 18 Sep 2024 10:44:55 GMT\n\nmodify response\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u4fee\u6539\u7684\u8bf7\u6c42\u54cd\u5e94\uff0c\u5e76\u4e0d\u4f1a\u5728burp\u4e2d\u663e\u793a\u6570\u636e\u5305\u88ab\u66ff\u6362\u8fc7\uff0c\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20240919\u4e0a\u534883120682",src:s(14578).A+"",width:"2568",height:"630"})}),"\n",(0,r.jsx)(n.p,{children:"\u4e0d\u5b58\u5728\u5982\u4e0b\u7684\u663e\u793a"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20240919\u4e0a\u534883349960",src:s(16498).A+"",width:"2626",height:"660"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["\u521a\u624d\u9664\u4e86\u76f4\u63a5\u7be1\u6539\u539f\u59cb\u8bf7\u6c42\uff0c\u8fd8\u6709\u901a\u8fc7",(0,r.jsx)(n.code,{children:"makeHttpRequest"}),"\u53d1\u8d77\u65b0\u7684\u8bf7\u6c42\uff0c\u53ef\u5728",(0,r.jsx)(n.code,{children:"logger++"}),"\u4e2d\u67e5\u770b\u5230\u8be5\u8bf7\u6c42\u3002"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20240919\u4e0a\u534884102053",src:s(88301).A+"",width:"3584",height:"840"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6269\u5c55\u603b\u7ed3",children:"\u6269\u5c55\u603b\u7ed3"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u83b7\u53d6\u7684header\u5305\u62ec\u4e86\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u7b2c\u4e00\u884c"}),"\n",(0,r.jsx)(n.li,{children:"\u53ef\u901a\u8fc7callbacks\u63d0\u4f9b\u7684helper\u6765\u8f85\u52a9\u5904\u7406\u6570\u636e\u5305\uff0c\u51cf\u5c11\u5de5\u4f5c\u91cf"}),"\n",(0,r.jsx)(n.li,{children:"messageInfo\u9664\u4e86\u83b7\u53d6\u3001\u8bbe\u7f6e\u8bf7\u6c42\u54cd\u5e94\u5916\uff0c\u8fd8\u53ef\u4ee5\u63a7\u5236Comment\u548c\u9ad8\u4eae\u663e\u793a\u7b49\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/bit4woo/burp-api-drops/blob/master/src/burp/Lession5.java",children:"https://github.com/bit4woo/burp-api-drops/blob/master/src/burp/Lession5.java"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/PortSwigger/example-event-listeners/blob/master/java/BurpExtender.java",children:"https://github.com/PortSwigger/example-event-listeners/blob/master/java/BurpExtender.java"})}),"\n"]})]})}function c(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},88301:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image-20240919\u4e0a\u534884102053-d59a21e4f1e063d706ca4bddfbb384c7.png"}}]);