<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透测试/内网渗透/信息收集/信息收集" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">信息收集 | d4m1ts 知识库</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://blog.gm7.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://blog.gm7.org/docs/渗透测试/内网渗透/信息收集/信息收集"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="信息收集 | d4m1ts 知识库"><meta data-rh="true" name="description" content="信息收集"><meta data-rh="true" property="og:description" content="信息收集"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.gm7.org/docs/渗透测试/内网渗透/信息收集/信息收集"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/渗透测试/内网渗透/信息收集/信息收集" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://blog.gm7.org/docs/渗透测试/内网渗透/信息收集/信息收集" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0LMFVYF6KV-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"渗透测试","item":"https://blog.gm7.org/docs/渗透测试/"},{"@type":"ListItem","position":2,"name":"信息收集","item":"https://blog.gm7.org/docs/category/信息收集"},{"@type":"ListItem","position":3,"name":"信息收集","item":"https://blog.gm7.org/docs/渗透测试/内网渗透/信息收集/信息收集"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="d4m1ts 知识库 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="d4m1ts 知识库 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="d4m1ts 知识库" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.933499b4.css">
<script src="/assets/js/runtime~main.4c121756.js" defer="defer"></script>
<script src="/assets/js/main.5f81c564.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">知识库</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/渗透测试/">渗透测试</a><button aria-label="折叠侧边栏分类 &#x27;渗透测试&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/渗透测试/信息收集/资产收集/主域名收集/">信息收集</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/WEB漏洞/">WEB漏洞</a><button aria-label="展开侧边栏分类 &#x27;WEB漏洞&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/思路技巧">思路技巧</a><button aria-label="展开侧边栏分类 &#x27;思路技巧&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/权限维持/">权限维持</a><button aria-label="展开侧边栏分类 &#x27;权限维持&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/小程序测试">小程序测试</a><button aria-label="展开侧边栏分类 &#x27;小程序测试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/保护自己">保护自己</a><button aria-label="展开侧边栏分类 &#x27;保护自己&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/waf绕过">WAF绕过</a><button aria-label="展开侧边栏分类 &#x27;WAF绕过&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/攻防演练/">攻防演练</a><button aria-label="展开侧边栏分类 &#x27;攻防演练&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/渗透测试/社工钓鱼/">社工钓鱼</a><button aria-label="展开侧边栏分类 &#x27;社工钓鱼&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/cs">C2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/category/powershell">免杀</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/category/内网基础知识">内网渗透</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/内网基础知识">内网基础知识</a><button aria-label="展开侧边栏分类 &#x27;内网基础知识&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/信息收集">信息收集</a><button aria-label="折叠侧边栏分类 &#x27;信息收集&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/渗透测试/内网渗透/信息收集/信息收集">信息收集</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/内网穿透">内网穿透</a><button aria-label="展开侧边栏分类 &#x27;内网穿透&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/横向移动">横向移动</a><button aria-label="展开侧边栏分类 &#x27;横向移动&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/权限维持">权限维持</a><button aria-label="展开侧边栏分类 &#x27;权限维持&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/日志清理">日志清理</a><button aria-label="展开侧边栏分类 &#x27;日志清理&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/工具小结">工具小结</a><button aria-label="展开侧边栏分类 &#x27;工具小结&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/渗透技巧">渗透技巧</a><button aria-label="展开侧边栏分类 &#x27;渗透技巧&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/基础知识扫盲">基础知识扫盲</a><button aria-label="展开侧边栏分类 &#x27;基础知识扫盲&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/代码审计/">代码审计</a><button aria-label="展开侧边栏分类 &#x27;代码审计&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/编程开发/GO/GO基础/">编程开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/前置基础知识">移动安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/应急响应/简介/">应急响应</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/category/日常使用">AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/暂未分类/自建网盘/h5ai/">暂未分类</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/致谢">致谢</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/更新日志">更新日志</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/渗透测试/"><span>渗透测试</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">内网渗透</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/信息收集"><span>信息收集</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">信息收集</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>信息收集</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="信息收集">信息收集<a href="#信息收集" class="hash-link" aria-label="信息收集的直接链接" title="信息收集的直接链接">​</a></h2>
<p>当我们拿到一台或多台可控的主机时，需要对当前主机进行信息收集，核心就是<strong>发现更多的目标</strong>和<strong>收集各种密码</strong>。</p>
<blockquote>
<p><strong>总结：</strong> 拿到一台机器后，尝试上线到C2，这里判断一下是否出网，然后看一下是否有域，再查一下网段信息，尽量扩大后续目标范围，最后再去机器上翻文件、找密码（本机密码、浏览器密码、各种服务密码）、找敏感进程等。</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="主机信息">主机信息<a href="#主机信息" class="hash-link" aria-label="主机信息的直接链接" title="主机信息的直接链接">​</a></h3>
<p>当前shell主机的信息。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="是否出网">是否出网<a href="#是否出网" class="hash-link" aria-label="是否出网的直接链接" title="是否出网的直接链接">​</a></h4>
<p>在出网的情况下，方便上线到C2，也方便做内网穿透，更容易进行后续操作。</p>
<ul>
<li><strong>TCP/HTTP出网：</strong> <code>powershell curl http://baidu.com</code></li>
<li><strong>DNS出网：</strong> <code>nslookup baidu.com</code></li>
<li><strong>ICMP出网：</strong> <code>ping baidu.com</code>、<code>tracert baidu.com</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="是否有域">是否有域<a href="#是否有域" class="hash-link" aria-label="是否有域的直接链接" title="是否有域的直接链接">​</a></h4>
<p><code>ipconfig</code>可以查看当前机器是否处于内网、是否有域、当前内网网段、DNS地址等等；如果主DNS后缀有内容，就说明在域内。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ipconfig /all </span><span class="token comment" style="color:#999988;font-style:italic"># 看主DNS后缀</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">nslookup</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">主DNS后缀</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 获取DNS服务器的IP地址，一般是DC</span><br></span></code></pre></div></div>
<p><code>systeminfo</code>查看系统详细信息的时候，可通过“域”字段来判断是否在域内，如果是WORKGROUP则说明是工作组。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systeminfo </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;域:&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systeminfo </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;Domain:&quot;</span><br></span></code></pre></div></div>
<p>查询工作站时，如果”工作站域“显示WORKGROUP则说明是工作组。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net config workstation</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="网段信息">网段信息<a href="#网段信息" class="hash-link" aria-label="网段信息的直接链接" title="网段信息的直接链接">​</a></h4>
<p>为了寻找更多的目标，比如当前是10.0.0.0的网段，不知道其他的网段，如果直接去全局扫的话，影响太大。</p>
<p>此外通过网段信息也可以找到跨网段的机器，这样可以扩大攻击范围，如从DMZ进入核心内网等。</p>
<p><strong>Windows:</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ipconfig /all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">netstat</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-ano</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">arp /a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tracert </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">route print</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">type</span><span class="token plain"> C: </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">drivers</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">etc</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wevtutil qe Security /q:</span><span class="token string" style="color:#e3116c">&quot;*[System[(EventID=4624)]]&quot;</span><span class="token plain"> /rd:true /f:text </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr /C:</span><span class="token string" style="color:#e3116c">&quot;源网络地址:&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr /V /C:</span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><span class="token plain"> /C:</span><span class="token string" style="color:#e3116c">&quot;-&quot;</span><span class="token plain"> /C:</span><span class="token string" style="color:#e3116c">&quot;::1&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># windows日志查看登陆记录</span><br></span></code></pre></div></div>
<p><strong>Linux：</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ifconfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">netstat</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-antlp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">arp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">traceroute</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">last</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">route</span><br></span></code></pre></div></div>
<p><strong>其他：</strong></p>
<p>比较笨的办法，全局ping网关</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># linux</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:#36acaa">i</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">..</span><span class="token number" style="color:#36acaa">254</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">.1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$i</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&gt;</span><span class="token plain">/dev/null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"> </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$i</span><span class="token plain"> is alived</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fi</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># windows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> /L %I </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1,1</span><span class="token plain">,254</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> DO @ping </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.%I.1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;TTL=&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="各种密码">各种密码<a href="#各种密码" class="hash-link" aria-label="各种密码的直接链接" title="各种密码的直接链接">​</a></h4>
<ul>
<li>本机hash（<a href="https://github.com/gentilkiwi/mimikatz" target="_blank" rel="noopener noreferrer">mimikatz</a>）</li>
<li>浏览器密码（<a href="https://github.com/AlessandroZ/LaZagne" target="_blank" rel="noopener noreferrer">LaZagne</a>）</li>
<li>配置文件中的各种密码，如mysql、sqlserver、redis、VPN等服务的密码</li>
<li>应用中的各种密码，如xshell、navicat等</li>
<li>Wi-Fi密码（<code>for /f  &quot;skip=9 tokens=1,2 delims=:&quot; %i in (&#x27;netsh wlan show profiles&#x27;)  do  @echo %j | findstr -i -v echo |  netsh wlan show profiles %j key=clear</code>）</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="敏感文件">敏感文件<a href="#敏感文件" class="hash-link" aria-label="敏感文件的直接链接" title="敏感文件的直接链接">​</a></h4>
<p>多翻一翻机器上的文件，除了密码外，万一有其他重要的敏感信息，如拓扑图、通讯录、集群等等。</p>
<ul>
<li>
<p>Windows</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">dir</span><span class="token plain"> /a /s /b D:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">&quot;*conf*</span><span class="token string" style="color:#e3116c">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">dir /s /b &quot;</span><span class="token plain">*密码*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*登录*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*资产*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*VPN*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*Svn*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*Git*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*交接*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*离职*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*网络*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*后台*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*拓扑*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*邮箱*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*工资*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*管理员*</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain">*巡检*</span><span class="token string" style="color:#e3116c">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">findstr /I /c:&quot;</span><span class="token plain">user</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; /c:&quot;</span><span class="token plain">pass</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; /c:&quot;</span><span class="token plain">login</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; /c:&quot;</span><span class="token plain">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; /c:&quot;</span><span class="token plain">pwd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">&quot;  /si *.conf *.asp *.php *.jsp *.aspx *.cgi *.xml *.ini *.inf *.txt *.cgi</span><br></span></code></pre></div></div>
</li>
<li>
<p>Linux</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">find</span><span class="token plain"> / </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*.properties&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">xargs</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">egrep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user|pass|pwd|uname|login|db_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-rli</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user|pass|pwd|uname|login|db_&quot;</span><span class="token plain"> ./</span><br></span></code></pre></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="进程列表">进程列表<a href="#进程列表" class="hash-link" aria-label="进程列表的直接链接" title="进程列表的直接链接">​</a></h4>
<p>通过进程列表，可以看到运行的软件和服务，如邮件客户端、VPN客户端等，从而获取到敏感信息，甚至利用第三方应用进行提权。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tasklist /svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic process list brief</span><br></span></code></pre></div></div>
<p>当然也可以看看杀软，可通过在线网站【<a href="https://www.ddosi.org/av/1.php" target="_blank" rel="noopener noreferrer">Windows杀软在线查询</a>】进行对比匹配。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="其他">其他<a href="#其他" class="hash-link" aria-label="其他的直接链接" title="其他的直接链接">​</a></h4>
<blockquote>
<p>这一块感觉都不是特别重要了，也不是刚需，可以根据需求查对应的信息。</p>
</blockquote>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="当前sid">当前SID<a href="#当前sid" class="hash-link" aria-label="当前SID的直接链接" title="当前SID的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">whoami</span><span class="token plain"> /user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">whoami</span><span class="token plain"> /all</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="当前用户组和权限">当前用户/组和权限<a href="#当前用户组和权限" class="hash-link" aria-label="当前用户/组和权限的直接链接" title="当前用户/组和权限的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net user xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net user xxx /domain </span><span class="token comment" style="color:#999988;font-style:italic"># 域内</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net localgroup administrators</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="安装软件列表">安装软件列表<a href="#安装软件列表" class="hash-link" aria-label="安装软件列表的直接链接" title="安装软件列表的直接链接">​</a></h5>
<p>查看目标主机上安装的第三方应用有哪些，是否可以用来留后门等。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wmic product get name,version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">powershell &quot;Get-WmiObject </span><span class="token parameter variable" style="color:#36acaa">-class</span><span class="token plain"> Win32_Product </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">Select-Object </span><span class="token parameter variable" style="color:#36acaa">-Property</span><span class="token plain"> name</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="开机启动项">开机启动项<a href="#开机启动项" class="hash-link" aria-label="开机启动项的直接链接" title="开机启动项的直接链接">​</a></h5>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wmic startup get command,caption</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="计划任务">计划任务<a href="#计划任务" class="hash-link" aria-label="计划任务的直接链接" title="计划任务的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">schtasks  /query  /fo  LIST /v</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="服务列表">服务列表<a href="#服务列表" class="hash-link" aria-label="服务列表的直接链接" title="服务列表的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wmic </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> list brief</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">post/windows/gather/enum_applications    </span><span class="token comment" style="color:#999988;font-style:italic"># msf</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="rdp">RDP<a href="#rdp" class="hash-link" aria-label="RDP的直接链接" title="RDP的直接链接">​</a></h5>
<p>查看RDP的端口（ <code>0xd3d</code> 表示3389</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">REG QUERY </span><span class="token string" style="color:#e3116c">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot;</span><span class="token plain"> /V PortNumber</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="环境变量">环境变量<a href="#环境变量" class="hash-link" aria-label="环境变量的直接链接" title="环境变量的直接链接">​</a></h5>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">set</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="在线用户">在线用户<a href="#在线用户" class="hash-link" aria-label="在线用户的直接链接" title="在线用户的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">query user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qwinsta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quser</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="操作系统版本">操作系统版本<a href="#操作系统版本" class="hash-link" aria-label="操作系统版本的直接链接" title="操作系统版本的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systeminfo </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr /B /C:</span><span class="token string" style="color:#e3116c">&quot;OS 名称&quot;</span><span class="token plain"> /C:</span><span class="token string" style="color:#e3116c">&quot;OS 版本&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systeminfo </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr /B /C:</span><span class="token string" style="color:#e3116c">&quot;OS Name&quot;</span><span class="token plain"> /C:</span><span class="token string" style="color:#e3116c">&quot;OS Version&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> %PROCESSOR_ARCHITECTURE% </span><span class="token comment" style="color:#999988;font-style:italic"># 架构</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="是否为虚拟机">是否为虚拟机<a href="#是否为虚拟机" class="hash-link" aria-label="是否为虚拟机的直接链接" title="是否为虚拟机的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># msf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">post/windows/gather/checkvm</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="补丁信息">补丁信息<a href="#补丁信息" class="hash-link" aria-label="补丁信息的直接链接" title="补丁信息的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systeminfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></span></code></pre></div></div>
<p>可以去<a href="https://i.hacking8.com/tiquan/" target="_blank" rel="noopener noreferrer">Windows提权辅助工具1</a>或者<a href="https://tools.zjun.info/getmskb/" target="_blank" rel="noopener noreferrer">Windows提权辅助工具2</a>来查询可用的提权补丁。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="共享信息">共享信息<a href="#共享信息" class="hash-link" aria-label="共享信息的直接链接" title="共享信息的直接链接">​</a></h5>
<p>查看本机共享列表和可访问的域共享列表</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic share get name,path,status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic share get /format:list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># List shares on a remote PC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic /node: COMPUTER_NAME share get</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="dns缓存记录">DNS缓存记录<a href="#dns缓存记录" class="hash-link" aria-label="DNS缓存记录的直接链接" title="DNS缓存记录的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ipconfig /displaydns</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="防火墙配置">防火墙配置<a href="#防火墙配置" class="hash-link" aria-label="防火墙配置的直接链接" title="防火墙配置的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">netsh firewall show config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netsh firewall show state    </span><span class="token comment" style="color:#999988;font-style:italic"># 防火墙状态</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="代理信息">代理信息<a href="#代理信息" class="hash-link" aria-label="代理信息的直接链接" title="代理信息的直接链接">​</a></h5>
<p>如果有代理可以看到 <code>ProxyServer</code> 字段</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reg query </span><span class="token string" style="color:#e3116c">&quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="域内信息">域内信息<a href="#域内信息" class="hash-link" aria-label="域内信息的直接链接" title="域内信息的直接链接">​</a></h3>
<p>域内的所有查询都是通过LDAP协议去AD进行查询的，而这个查询需要经过权限认证，所以只有域用户才拥有这个权限，当域用户运行查询命令时，会自动使用Kerberos协议进行认证，无须额外输入账号和密码。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="域内组">域内组<a href="#域内组" class="hash-link" aria-label="域内组的直接链接" title="域内组的直接链接">​</a></h4>
<p>通过域内组可以查到很多的信息，如域内主机、域内用户、域控等。</p>
<p>查看域内组</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net group /domain</span><br></span></code></pre></div></div>
<p>其中系统自带的常见组如下:</p>
<ul>
<li><code>Domain Admins</code>：域管理员组。</li>
<li><code>Domain Computers</code>：域内机器。</li>
<li><code>Domain Controllers</code>：域控制器。</li>
<li><code>Domain Guest</code>：域访客组，权限较低。</li>
<li><code>Domain Users</code>：域用户。</li>
<li><code>Enterprise Admins</code>：企业系统管理员用户。</li>
</ul>
<p>在默认情况下，<code>Domain Admins</code>和<code>Enterprise Admins</code>对域内所有域控制器有完全 控制权限</p>
<p>查询组内的对象</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net group </span><span class="token string" style="color:#e3116c">&quot;Domain Admins&quot;</span><span class="token plain"> /domain		</span><span class="token comment" style="color:#999988;font-style:italic"># 域管列表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net group </span><span class="token string" style="color:#e3116c">&quot;Domain Controllers&quot;</span><span class="token plain"> /domain	</span><span class="token comment" style="color:#999988;font-style:italic"># 域控列表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net group </span><span class="token string" style="color:#e3116c">&quot;Domain Users&quot;</span><span class="token plain"> /domain 		</span><span class="token comment" style="color:#999988;font-style:italic"># 域内用户列表, net user /domain 平替</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net group </span><span class="token string" style="color:#e3116c">&quot;Domain Computers&quot;</span><span class="token plain"> /domain 	</span><span class="token comment" style="color:#999988;font-style:italic"># 域内主机列表</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="定位域控">定位域控<a href="#定位域控" class="hash-link" aria-label="定位域控的直接链接" title="定位域控的直接链接">​</a></h4>
<p>在真实环境中，一般存在两台或两台以上的域控制器，1台作为主域控，1台作为备份域控；备份域控主要是在主域控瘫痪时，为整个域继续提供正常的服务。</p>
<ol>
<li><code>nltest</code> 命令用于在 Windows 系统上执行各种与域相关的测试和操作，包括获取当前计算机的域控制器信息。</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nltest /DCLIST:org.gm7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nltest /DSGETDC:org.gm7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nltest /DNSGETDC:org.gm7</span><br></span></code></pre></div></div>
<ol start="2">
<li>使用 <code>nslookup</code> 命令查询 SRV 记录的语法，其目的是查找与 LDAP 服务相关的 SRV 记录。</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">nslookup</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">SRV _ldap._tcp</span><br></span></code></pre></div></div>
<ol start="3">
<li>查询域控的时间</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net </span><span class="token function" style="color:#d73a49">time</span><span class="token plain"> /domain</span><br></span></code></pre></div></div>
<ol start="4">
<li>一般情况下DNS服务会搭建在DC上，所以DNS服务器就是DC</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ipconfig /all </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr /R </span><span class="token string" style="color:#e3116c">&quot;DNS Servers&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipconfig /all </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr /R </span><span class="token string" style="color:#e3116c">&quot;DNS 服务器&quot;</span><br></span></code></pre></div></div>
<ol start="5">
<li>域内用户组<code>Domain Controllers</code>中的对象就是DC</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net group </span><span class="token string" style="color:#e3116c">&quot;Domain Controllers&quot;</span><span class="token plain"> /domain</span><br></span></code></pre></div></div>
<ol start="6">
<li>通过SPN定位到开放了特定服务的机器，一般就会是DC</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;DNS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;ldap&quot;</span><br></span></code></pre></div></div>
<ol start="7">
<li>如果上述的都定位不到DC，那么可以尝试寻找开放了88（Kerberos）,389（LDAP）,53（DNS）端口的服务器。</li>
</ol>
<p>定位到DC后，如果拿到的是机器名，可以使用ping获取到具体的IP地址。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> PDC</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="定位域管">定位域管<a href="#定位域管" class="hash-link" aria-label="定位域管的直接链接" title="定位域管的直接链接">​</a></h4>
<p>域管理员可以上域内的任意机器，包括域控，换句话说，拿到了域管账号就相当于拿下了整个域。</p>
<p>有的域成员机器上登录过域管账号，当拿下这一台机器后 ，就可以尝试从内存中读取明文密码或者hash，这个时候既有域控的地址，也有域管身份凭证，就可以内网漫游了。</p>
<p>所以我们要定位域管在哪些机器上登陆过。<strong>常用来定位域内管理员的渠道有两个，一是日志，二是会话：</strong></p>
<ul>
<li>日志是指本地机器的管理员日志，可以使用脚本或<code>wevtutil</code>导出查看。</li>
<li>会话是指域内每个机器的登录会话，可以匿名查询， 无须权限，可以使用 <code>netsess.exe</code> 或 <code>PowerView</code> 等工具查询。</li>
</ul>
<ol>
<li>
<p>使用<a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon" target="_blank" rel="noopener noreferrer">powerview</a>的<code>Find-DomainUserLocation</code>模块（<code>Invoke-UserHunter</code>平替），枚举域内每台机器来寻找域管。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">d4m1ts</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Recon</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Import-Module .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">PowerView.ps1                                                     PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">d4m1ts</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Recon</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Find-DomainUserLocation                                                               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserDomain      </span><span class="token builtin class-name">:</span><span class="token plain"> ORG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserName        </span><span class="token builtin class-name">:</span><span class="token plain"> Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ComputerName    </span><span class="token builtin class-name">:</span><span class="token plain"> DESKTOP-9CAT508.org.gm7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPAddress       </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SessionFrom     </span><span class="token builtin class-name">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SessionFromName </span><span class="token builtin class-name">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalAdmin      </span><span class="token builtin class-name">:</span><br></span></code></pre></div></div>
</li>
<li>
<p>使用<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon" target="_blank" rel="noopener noreferrer">psloggedon</a>来枚举当前机器或指定机器登陆了哪些用户。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">d4m1ts</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">PsLoggedon64.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PsLoggedon v1.35 - See </span><span class="token function" style="color:#d73a49">who</span><span class="token string" style="color:#e3116c">&#x27;s logged on</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Copyright (C) 2000-2016 Mark Russinovich</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Sysinternals - www.sysinternals.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Users logged on locally:</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     2024/4/9 10:01:01          ORG\d4m1ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     &lt;unknown time&gt;             ORG\Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">No one is logged on via resource shares.</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">C:\Users\d4m1ts\Desktop&gt;PsLoggedon64.exe \\PDC</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">PsLoggedon v1.35 - See who&#x27;</span><span class="token plain">s logged on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain">-2016 Mark Russinovich</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sysinternals - www.sysinternals.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Users logged on locally:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">unknown time</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">             ORG</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to query resource logons</span><br></span></code></pre></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="spn扫描">SPN扫描<a href="#spn扫描" class="hash-link" aria-label="SPN扫描的直接链接" title="SPN扫描的直接链接">​</a></h4>
<p>之前介绍过，SPN（Service Principal Name）是Kerberos身份验证中用于标识特定服务实例（如HTTP、SMB、MySQL）的唯一名称。Kerberos身份验证使用SPN将服务实例与服务登录帐户相关联。</p>
<p>因此可通过SPN发现一些敏感的服务，但需要注意的是，SPN结果的服务不一定是存活的。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */*				</span><span class="token comment" style="color:#999988;font-style:italic"># 查看当前域内所有的SPN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */*	</span><span class="token comment" style="color:#999988;font-style:italic"># 指定域查询SPN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-L</span><span class="token plain"> d4m1ts			</span><span class="token comment" style="color:#999988;font-style:italic"># 查找指定用户的SPN</span><br></span></code></pre></div></div>
<p>一些常用的定位敏感服务。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 定位数据库相关服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;MSSQLSvc&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;oracle&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定位LDAP服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;ldap&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定位邮件服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;exchangeMDB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;SMTPSVC&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;IMAP&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;POP3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定位WEB服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;HTTP&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;HTTPS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定位DNS服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;DNS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定位文件服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;ftp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;nfs&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定位开启远程连接服务服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;TERMSRV&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> PerfLogs rdp .txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;WSMAN&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> C: PerfLogs winrm .txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;vnc&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> C: PerfLogs vnc .txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;vpn&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> C: PerfLogs vpn .txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setspn </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> org.gm7 </span><span class="token parameter variable" style="color:#36acaa">-Q</span><span class="token plain"> */* </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;tnetdgines&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> C: PerfLogs tnetdgines .txt</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="域信任关系">域信任关系<a href="#域信任关系" class="hash-link" aria-label="域信任关系的直接链接" title="域信任关系的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nltest /domain_trusts</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dsquery">dsquery<a href="#dsquery" class="hash-link" aria-label="dsquery的直接链接" title="dsquery的直接链接">​</a></h4>
<p><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732952(v=ws.11)" target="_blank" rel="noopener noreferrer">dsquery</a>是一个内置在Windows Server 2008中的命令行工具，在安装了活动目录域服务（AD DS）服务器（域控）上可用，可以用来查询AD中各种对象。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dsquery computer       ----- 寻找AD中的计算机</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery server         ----- 寻找AD中的域控制器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery user           ----- 寻找AD中的用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery contact        ----- 在AD中查找与指定的搜索条件相匹配的联系人</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery subnet         ----- 寻找AD中的子网</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery group          ----- 寻找AD中的群组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery ou             ----- 寻找AD中的组织单位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery site           ----- 寻找AD中的站点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery quota          ----- 寻找AD中的配额规格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery partition      ----- 寻找AD中的磁盘分区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery *              ----- 使用标准的LDAP查询在AD中寻找任何对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery server –domain Yahoo.com | dsget server–dnsname –site   ---搜索域内域控制器的DNS主机名和站点名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery computer domainroot –name *-xp –limit 10                ----- 搜索域内以-xp结尾的机器10台</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsquery user domainroot –name admin* -limit 10                  ---- 搜索域内以admin开头的用户10个</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="其他-1">其他<a href="#其他-1" class="hash-link" aria-label="其他的直接链接" title="其他的直接链接">​</a></h4>
<p>一般拿到域控权限后，需要统计主机数量来证明数据量，可在DC中使用如下命令统计：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dsquery computer </span><span class="token parameter variable" style="color:#36acaa">-limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> /c /v </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">powershell.exe </span><span class="token parameter variable" style="color:#36acaa">-Command</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;(Get-ADComputer -Filter *).Count&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="内网探测">内网探测<a href="#内网探测" class="hash-link" aria-label="内网探测的直接链接" title="内网探测的直接链接">​</a></h3>
<p>内网探测是内网渗透中不可或缺的一个环节，在扫描的时候，应<strong>尽量避免使用Namp等工具</strong>进行暴力扫描，也不要在目标机器上使用图形化的工具， 而要<strong>尽量使用目标系统自带的各种工具，推荐使用PowerShell脚本</strong>。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="特定服务探测">特定服务探测<a href="#特定服务探测" class="hash-link" aria-label="特定服务探测的直接链接" title="特定服务探测的直接链接">​</a></h4>
<ol>
<li>
<p>使用 <a href="https://github.com/byt3bl33d3r/CrackMapExec" target="_blank" rel="noopener noreferrer">CrackMapExec</a> 探测常用的服务。【推荐】</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cme smb </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.2/24   </span><span class="token comment" style="color:#999988;font-style:italic"># 根据 SMB 探测服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cme </span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.2/24   </span><span class="token comment" style="color:#999988;font-style:italic"># 根据 SSH 探测服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cme ldap </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.2/24  </span><span class="token comment" style="color:#999988;font-style:italic"># 根据 LDAP 探测服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cme mssql </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.2/24 </span><span class="token comment" style="color:#999988;font-style:italic"># 根据 MSSQL 探测服务器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cme winrm </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.2/24  </span><span class="token comment" style="color:#999988;font-style:italic"># 根据 WINRM 探测服务器</span><br></span></code></pre></div></div>
</li>
<li>
<p>使用MSF探测常用的服务，也可以通过端口探测。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># module列表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/http/http_version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/smb/smb_version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/ftp/ftp_version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/ssh/ssh_version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/telnet/telnet_version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/mysql/mysql_version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/db2/db2_version</span><br></span></code></pre></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="多网卡机器探测">多网卡机器探测<a href="#多网卡机器探测" class="hash-link" aria-label="多网卡机器探测的直接链接" title="多网卡机器探测的直接链接">​</a></h4>
<p>在内网渗透过程中，目标网络中一般是划分不同区域使用防火墙进行隔离的。在日常运维过程中，运维人员为了方便操作，会将特定主机配置多网卡以访问不同网络区域的机器。</p>
<p>假如机器A通10.1.0.1/24段，但是不通10.1.1.1/24段，而机器B可以同时通10.1.0.1/24段和10.1.1.1/24段，那么寻找并拿下机器B就可以实现跨网段，也就可以发现更多的攻击目标，或者说更敏感的数据。（如从DMZ进入到内网）</p>
<p>可使用工具 <a href="https://github.com/uknowsec/SharpOXID-Find/blob/master/bin/Release/SharpOXID-Find.exe" target="_blank" rel="noopener noreferrer">SharpOXID-Find</a> 进行探测。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">d4m1ts</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">SharpOXID-Find.exe </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.1/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">+</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> range </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.1 - </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.254</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Retrieving network interfaces of  </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Address:DESKTOP-9CAT508</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Address:172.16.93.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Address:fd15:4ba5:5a2b:1008:4446:59a:f9a4:2af8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Address:fd15:4ba5:5a2b:1008:44a4:e53c:8e4:d1dd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Retrieving network interfaces of  </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Address:PDC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Address:172.16.93.15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Address:fd15:4ba5:5a2b:1008:dcd:73da:d2f0:3ba1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Finish</span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="netbios探测">NetBIOS探测<a href="#netbios探测" class="hash-link" aria-label="NetBIOS探测的直接链接" title="NetBIOS探测的直接链接">​</a></h4>
<p>通过NetBIOS协议，可以获取内网中的主机名、IP地址以及其他相关信息。</p>
<p>可使用命令行工具 <strong><a href="http://www.unixwiz.net/tools/nbtscan.html" target="_blank" rel="noopener noreferrer">nbtscan</a></strong> 进行探测。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">d4m1ts</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">nbtscan.exe </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.1/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Doing NBT name scan </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> addresses from </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.1/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IP address       NetBIOS Name     Server    User             MAC address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.15     PDC              </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">server</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">unknown</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        00-0c-29-f1-fc-2a</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arp探测">ARP探测<a href="#arp探测" class="hash-link" aria-label="ARP探测的直接链接" title="ARP探测的直接链接">​</a></h4>
<p>使用MSF的arp_sweep模块。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/discovery/arp_sweep</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="icmp探测">ICMP探测<a href="#icmp探测" class="hash-link" aria-label="ICMP探测的直接链接" title="ICMP探测的直接链接">​</a></h4>
<p>依次对内网中的每个IP地址执行 ping命令，可以快速有效地找出内网中所有存活的主机。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># windows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> /L %I </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1,1</span><span class="token plain">,254</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> DO @ping </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.174.%I </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr </span><span class="token string" style="color:#e3116c">&quot;TTL=&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> /l %i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1,1</span><span class="token plain">,255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> @ping </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.100.%i </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> /i </span><span class="token string" style="color:#e3116c">&quot;ttl&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># linux</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:#36acaa">i</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.28</span><span class="token plain">.98.</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">..</span><span class="token number" style="color:#36acaa">254</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$i</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&gt;</span><span class="token plain">/dev/null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"> </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$i</span><span class="token plain"> is alived</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fi</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">done</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="端口探测">端口探测<a href="#端口探测" class="hash-link" aria-label="端口探测的直接链接" title="端口探测的直接链接">​</a></h4>
<p>上面的NetBIOS、ARP、ICMP探测大多数情况下只能探测主机的存活，并无法探测到主机上有哪些服务，而我们知道要进行横向肯定是对特定服务进行攻击，如NTLM认证、SMB、SqlServer、WEB等，因此要想全面的获取到攻击面就需要进行端口扫描。</p>
<ol>
<li>
<p>使用MSF</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">search portscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/portscan/ack                                     normal  No     TCP ACK Firewall Scanner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/portscan/tcp                                     normal  No     TCP Port Scanner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auxiliary/scanner/portscan/syn                                     normal  No     TCP SYN Port Scanner</span><br></span></code></pre></div></div>
</li>
<li>
<p>使用PowerSploit中的<a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/Invoke-Portscan.ps1" target="_blank" rel="noopener noreferrer"><code>Invoke-Portscan.ps1</code></a>脚本</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Import-Module .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Invoke-Portscan.ps1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-Portscan </span><span class="token parameter variable" style="color:#36acaa">-Hosts</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.1/24 </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-TopPorts</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-oA</span><span class="token plain"> c:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">res.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-Portscan </span><span class="token parameter variable" style="color:#36acaa">-Hosts</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.93.1/24 </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-ports</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;445,1433,8080,3389,80,22&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-oA</span><span class="token plain"> c:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">res.txt</span><br></span></code></pre></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="综合工具">综合工具<a href="#综合工具" class="hash-link" aria-label="综合工具的直接链接" title="综合工具的直接链接">​</a></h4>
<p>如果内网环境中没有防护，或者在客户授权加白的情况下进行测试，那么可以使用一些现成的工具进行大范围扫描。</p>
<ul>
<li><a href="https://github.com/shadow1ng/fscan" target="_blank" rel="noopener noreferrer">fscan</a></li>
<li><a href="https://github.com/k8gege/Ladon" target="_blank" rel="noopener noreferrer">ladon</a></li>
<li>...</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->由 <b>d4m1ts</b> <!-- -->于 <b><time datetime="2025-06-01T13:27:30.000Z" itemprop="dateModified">2025年6月1日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/信息收集"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">信息收集</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/内网穿透"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">内网穿透</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#信息收集" class="table-of-contents__link toc-highlight">信息收集</a><ul><li><a href="#主机信息" class="table-of-contents__link toc-highlight">主机信息</a><ul><li><a href="#是否出网" class="table-of-contents__link toc-highlight">是否出网</a></li><li><a href="#是否有域" class="table-of-contents__link toc-highlight">是否有域</a></li><li><a href="#网段信息" class="table-of-contents__link toc-highlight">网段信息</a></li><li><a href="#各种密码" class="table-of-contents__link toc-highlight">各种密码</a></li><li><a href="#敏感文件" class="table-of-contents__link toc-highlight">敏感文件</a></li><li><a href="#进程列表" class="table-of-contents__link toc-highlight">进程列表</a></li><li><a href="#其他" class="table-of-contents__link toc-highlight">其他</a><ul><li><a href="#当前sid" class="table-of-contents__link toc-highlight">当前SID</a></li><li><a href="#当前用户组和权限" class="table-of-contents__link toc-highlight">当前用户/组和权限</a></li><li><a href="#安装软件列表" class="table-of-contents__link toc-highlight">安装软件列表</a></li><li><a href="#开机启动项" class="table-of-contents__link toc-highlight">开机启动项</a></li><li><a href="#计划任务" class="table-of-contents__link toc-highlight">计划任务</a></li><li><a href="#服务列表" class="table-of-contents__link toc-highlight">服务列表</a></li><li><a href="#rdp" class="table-of-contents__link toc-highlight">RDP</a></li><li><a href="#环境变量" class="table-of-contents__link toc-highlight">环境变量</a></li><li><a href="#在线用户" class="table-of-contents__link toc-highlight">在线用户</a></li><li><a href="#操作系统版本" class="table-of-contents__link toc-highlight">操作系统版本</a></li><li><a href="#是否为虚拟机" class="table-of-contents__link toc-highlight">是否为虚拟机</a></li><li><a href="#补丁信息" class="table-of-contents__link toc-highlight">补丁信息</a></li><li><a href="#共享信息" class="table-of-contents__link toc-highlight">共享信息</a></li><li><a href="#dns缓存记录" class="table-of-contents__link toc-highlight">DNS缓存记录</a></li><li><a href="#防火墙配置" class="table-of-contents__link toc-highlight">防火墙配置</a></li><li><a href="#代理信息" class="table-of-contents__link toc-highlight">代理信息</a></li></ul></li></ul></li><li><a href="#域内信息" class="table-of-contents__link toc-highlight">域内信息</a><ul><li><a href="#域内组" class="table-of-contents__link toc-highlight">域内组</a></li><li><a href="#定位域控" class="table-of-contents__link toc-highlight">定位域控</a></li><li><a href="#定位域管" class="table-of-contents__link toc-highlight">定位域管</a></li><li><a href="#spn扫描" class="table-of-contents__link toc-highlight">SPN扫描</a></li><li><a href="#域信任关系" class="table-of-contents__link toc-highlight">域信任关系</a></li><li><a href="#dsquery" class="table-of-contents__link toc-highlight">dsquery</a></li><li><a href="#其他-1" class="table-of-contents__link toc-highlight">其他</a></li></ul></li><li><a href="#内网探测" class="table-of-contents__link toc-highlight">内网探测</a><ul><li><a href="#特定服务探测" class="table-of-contents__link toc-highlight">特定服务探测</a></li><li><a href="#多网卡机器探测" class="table-of-contents__link toc-highlight">多网卡机器探测</a></li><li><a href="#netbios探测" class="table-of-contents__link toc-highlight">NetBIOS探测</a></li><li><a href="#arp探测" class="table-of-contents__link toc-highlight">ARP探测</a></li><li><a href="#icmp探测" class="table-of-contents__link toc-highlight">ICMP探测</a></li><li><a href="#端口探测" class="table-of-contents__link toc-highlight">端口探测</a></li><li><a href="#综合工具" class="table-of-contents__link toc-highlight">综合工具</a></li></ul></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">内容导航</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/friends">友情链接</a></li><li class="footer__item"><a class="footer__link-item" href="/promotions">我的推广</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">实用工具</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://markdown.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">在线Markdown<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://rshell.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reverse Shell Generator<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://gtfobins.gm7.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GTFOBins<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">关注我</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/damit5/damit5.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:admin@gm7.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">联系我<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 d4m1ts 知识库</div></div></div></footer></div>
</body>
</html>