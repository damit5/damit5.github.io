"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[6198],{28453:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>d});var a=o(96540);const s={},c=a.createContext(s);function r(e){const n=a.useContext(c);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(c.Provider,{value:n},e.children)}},72746:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>i,contentTitle:()=>d,default:()=>l,frontMatter:()=>r,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/README","title":"hook\u5b9e\u6218","description":"\u524d\u8a00","source":"@site/docs/04.\u79fb\u52a8\u5b89\u5168/03.frida-hook/05.hook \u5b9e\u6218/README.md","sourceDirName":"04.\u79fb\u52a8\u5b89\u5168/03.frida-hook/05.hook \u5b9e\u6218","slug":"/\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"Brida","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/brida/"},"next":{"title":"\u3010\u5b9e\u4f8b\u4e00\u3011\u52a0\u5bc6+\u7b7e\u540d\u5206\u6790","permalink":"/docs/\u79fb\u52a8\u5b89\u5168/frida-hook/hook \u5b9e\u6218/\u3010\u5b9e\u4f8b\u4e00\u3011\u52a0\u5bc6+\u7b7e\u540d\u5206\u6790"}}');var s=o(74848),c=o(28453);const r={},d="hook\u5b9e\u6218",i={},t=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"\u52a0\u5bc6\u65b9\u5f0f\u5206\u6790",id:"\u52a0\u5bc6\u65b9\u5f0f\u5206\u6790",level:3},{value:"\u7b7e\u540d\u65b9\u5f0f\u5206\u6790",id:"\u7b7e\u540d\u65b9\u5f0f\u5206\u6790",level:3},{value:"\u542f\u52a8",id:"\u542f\u52a8",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"hook\u5b9e\u6218",children:"hook\u5b9e\u6218"})}),"\n",(0,s.jsx)(n.h2,{id:"\u524d\u8a00",children:"\u524d\u8a00"}),"\n",(0,s.jsx)(n.h3,{id:"\u52a0\u5bc6\u65b9\u5f0f\u5206\u6790",children:"\u52a0\u5bc6\u65b9\u5f0f\u5206\u6790"}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u6ca1\u6709\u660e\u663e\u7684\u52a0\u5bc6\u6216\u8005\u7f16\u7801\u7279\u5f81\uff0c\u6839\u636e\u7ecf\u9a8c\uff0c\u5927\u591aAPP\u6570\u636e\u5305\u52a0\u5bc6\u4f1a\u91c7\u7528",(0,s.jsx)(n.code,{children:"AES"}),"\u6216\u8005",(0,s.jsx)(n.code,{children:"DES"}),"\uff0c\u53ef\u4ee5\u5148Hook\u4e00\u4e0b\u5bf9\u5e94\u7684\u57fa\u7840\u7c7b\u6216\u65b9\u6cd5\uff08\u4f7f\u7528objection\uff09"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// hook\u57fa\u7840\u7c7b\nandroid hooking watch class javax.crypto.spec.IvParameterSpec\nandroid hooking watch class javax.crypto.Cipher\n// \u6838\u5fc3\u5173\u6ce8 doFinal getInstance update\u65b9\u6cd5\nandroid hooking watch class_method javax.crypto.Cipher.getInstance --dump-args\nandroid hooking watch class_method javax.crypto.Cipher.update --dump-args --dump-return\nandroid hooking watch class_method javax.crypto.Cipher.doFinal --dump-args --dump-return --dump-backtrace\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u4e0d\u884c\uff0c\u90a3\u53ef\u4ee5\u76f4\u63a5\u641c\u7c7b\u7684\u5173\u952e\u8bcd\u7136\u540e\u76d1\u542c\uff08\u4f7f\u7528objection\uff09"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"android hooking search classes AES\nandroid hooking search classes DES\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u90fd\u627e\u4e0d\u5230\uff0c\u90a3\u5c31\u5c1d\u8bd5\u8131\u58f3\u53cd\u7f16\u8bd1\uff0c\u6839\u636e\u4e00\u4e9b\u7279\u5f81\u5b57\u7b26\u4e32\uff08URL\u3001\u53c2\u6570\uff09\uff0c\u5b9a\u4f4d\u5230\u52a0\u5bc6\u7684\u7c7b\uff0c\u518d\u53bbhook\uff1b\u6216\u8005\u76d1\u63a7\u64cd\u4f5c\u65f6\u5b9e\u65f6\u7684\u65b9\u6cd5\u51fd\u6570\uff0c\u4ece\u4e2d\u5b9a\u4f4d\u5230\u52a0\u5bc6\u7684\u65b9\u6cd5\uff0c\u518d\u53bbhook\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u7b7e\u540d\u65b9\u5f0f\u5206\u6790",children:"\u7b7e\u540d\u65b9\u5f0f\u5206\u6790"}),"\n",(0,s.jsx)(n.p,{children:"\u6839\u636e\u7ecf\u9a8c\uff0c\u7b7e\u540d\u4e00\u822c\u4f1a\u91c7\u7528\u54c8\u5e0c\u7b97\u6cd5"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"MD5"}),"\uff1aMD5\u7b97\u6cd5\u662f\u4e00\u79cd\u5e38\u7528\u7684\u54c8\u5e0c\u7b97\u6cd5\uff0c\u751f\u6210\u7684\u6458\u8981\u957f\u5ea6\u4e3a32\u4e2a\u5b57\u7b26\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"SHA-1"}),"\uff1aSHA-1\u662f\u4e00\u79cd\u5b89\u5168\u6563\u5217\u7b97\u6cd5\uff0c\u751f\u6210\u7684\u6458\u8981\u957f\u5ea6\u4e3a40\u4e2a\u5b57\u7b26\uff0c\u4f46\u53ef\u4ee5\u622a\u53d6\u524d32\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u7b7e\u540d\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"SHA-256"}),"\uff1aSHA-256\u662f\u4e00\u79cd\u6bd4SHA-1\u66f4\u5b89\u5168\u7684\u54c8\u5e0c\u7b97\u6cd5\uff0c\u751f\u6210\u7684\u6458\u8981\u957f\u5ea6\u4e3a64\u4e2a\u5b57\u7b26\uff0c\u4f46\u53ef\u4ee5\u622a\u53d6\u524d32\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u7b7e\u540d\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"HMAC"}),"\uff1aHMAC\u7b97\u6cd5\u662f\u4e00\u79cd\u4f7f\u7528\u5bc6\u94a5\u8fdb\u884c\u54c8\u5e0c\u7684\u6d88\u606f\u8ba4\u8bc1\u7801\u7b97\u6cd5\uff0c\u5e38\u7528\u7684\u54c8\u5e0c\u7b97\u6cd5\u5305\u62ecMD5\u548cSHA-256\uff0c\u751f\u6210\u7684\u7b7e\u540d\u957f\u5ea6\u4e3a32\u4e2a\u5b57\u7b26\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RIPEMD-160"}),"\uff1aRIPEMD-160\u662f\u4e00\u79cd\u6b27\u6d32\u5b89\u5168\u6807\u51c6\u7ec4\u7ec7\uff08ECBS\uff09\u63a8\u8350\u7684\u54c8\u5e0c\u7b97\u6cd5\uff0c\u751f\u6210\u7684\u6458\u8981\u957f\u5ea6\u4e3a40\u4e2a\u5b57\u7b26\uff0c\u4f46\u53ef\u4ee5\u622a\u53d6\u524d32\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u7b7e\u540d\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u5148\u5c1d\u8bd5hook\u4e00\u4e0b\u5bf9\u5e94\u7684\u7c7b\uff0c\u770b\u770b\u6709\u6ca1\u6709\u7528\u5230\u8fd9\u4e9b\u65b9\u6cd5\uff08\u4f7f\u7528objection\uff09"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// md5\u7c7b\nandroid hooking watch class java.security.MessageDigest\n// md5\u65b9\u6cd5\nandroid hooking watch class_method java.security.MessageDigest.getInstance --dump-args\nandroid hooking watch class_method java.security.MessageDigest.update --dump-args --dump-return --dump-backtrace\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// HMAC\u7c7b\nandroid hooking watch class javax.crypto.spec.SecretKeySpec\nandroid hooking watch class javax.crypto.Mac\n// HMAC\u65b9\u6cd5\nandroid hooking watch class_method javax.crypto.spec.SecretKeySpec.$init --dump-args --dump-backtrace\nandroid hooking watch class_method javax.crypto.Mac.getInstance --dump-args\nandroid hooking watch class_method javax.crypto.Mac.doFinal --dump-args --dump-return --dump-backtrace\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u4e0d\u884c\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u641c\u7d22\u4e00\u4e9b\u65b9\u6cd5\uff0c\u5982"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"android hooking search methods getSign\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd8\u662f\u627e\u4e0d\u5230\uff0c\u90a3\u5c31\u5c1d\u8bd5\u8131\u58f3\u53cd\u7f16\u8bd1\uff0c\u6839\u636e\u4e00\u4e9b\u7279\u5f81\u5b57\u7b26\u4e32\uff08URL\u3001\u53c2\u6570\uff09\uff0c\u5b9a\u4f4d\u5230\u7b7e\u540d\u7684\u7c7b\uff0c\u518d\u53bbhook\uff1b\u6216\u8005\u76d1\u63a7\u64cd\u4f5c\u65f6\u5b9e\u65f6\u7684\u65b9\u6cd5\u51fd\u6570\uff0c\u4ece\u4e2d\u5b9a\u4f4d\u5230\u7b7e\u540d\u7684\u65b9\u6cd5\uff0c\u518d\u53bbhook\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u542f\u52a8",children:"\u542f\u52a8"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"frida -U -l emulator_detection_bypass.js -l root_detection_bypass.js -l intercept_crypto.js -l ssl_pinning_multiple_bypass.js -l system_exit_bypass.js -f com.xxx.xxx\n"})})]})}function l(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);